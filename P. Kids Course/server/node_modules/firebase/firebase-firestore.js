!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(Ed){"use strict";try{(function(){Ed=Ed&&Object.prototype.hasOwnProperty.call(Ed,"default")?Ed.default:Ed;var t,p,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,t,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function d(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},u=p.INFO,a=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},c);function c(t){this.name=t,this._logLevel=u,this._logHandler=i,this._userLogHandler=null}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var f,m=(n(l,f=Error),l);function l(t,e){var n=f.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,l.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,w.prototype.create),n}var w=(b.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new m(o,a),c=0,f=Object.keys(i);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=i[l])}return h},b);function b(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g;function E(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var _,T="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},N=N||{},A=T||self;function x(){}function S(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function D(t){var e=S(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var R="closure_uid_"+(1e9*Math.random()>>>0),O=0;function k(t,e,n){return t.call.apply(t.bind,arguments)}function L(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?k:L).apply(null,arguments)}function V(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var U=Date.now||function(){return+new Date};function j(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function M(){this.j=this.j,this.i=this.i}M.prototype.j=!1,M.prototype.da=function(){if(!this.j&&(this.j=!0,this.C(),0))t=this,Object.prototype.hasOwnProperty.call(t,R)&&t[R]||(t[R]=++O);var t},M.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(t){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var H,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var K=A.navigator;if(K){var Q=K.userAgent;if(Q){H=Q;break t}}H=""}function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e={};for(var n in t)e[n]=t[n];return e}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Z.length;o++)n=Z[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function et(t){return et[" "](t),t}et[" "]=x;var nt,rt,it=Y(H,"Opera"),ot=Y(H,"Trident")||Y(H,"MSIE"),st=Y(H,"Edge"),ut=st||ot,at=Y(H,"Gecko")&&!(Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge"))&&!(Y(H,"Trident")||Y(H,"MSIE"))&&!Y(H,"Edge"),ht=Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge");function ct(){var t=A.document;return t?t.documentMode:void 0}t:{var ft="",lt=(rt=H,at?/rv:([^\);]+)(\)|;)/.exec(rt):st?/Edge\/([\d\.]+)/.exec(rt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(rt):ht?/WebKit\/(\S+)/.exec(rt):it?/(?:Version)[ \/]?(\S+)/.exec(rt):void 0);if(lt&&(ft=lt?lt[1]:""),ot){var pt=ct();if(null!=pt&&pt>parseFloat(ft)){nt=String(pt);break t}}nt=ft}var dt,yt={};function vt(u){return t=u,e=function(){for(var t=0,e=W(String(nt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=yt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}if(A.document&&ot){var gt=ct();dt=gt||(parseInt(nt,10)||void 0)}else dt=void 0;var mt=dt,wt=!ot||9<=Number(mt),bt=ot&&!vt("9"),It=function(){if(!A.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{A.addEventListener("test",x,e),A.removeEventListener("test",x,e)}catch(t){}return t}();function Et(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function _t(t,e){if(Et.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Tt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Et.prototype.b=function(){this.defaultPrevented=!0},j(_t,Et);var Tt={2:"touch",3:"pen",4:"mouse"};_t.prototype.b=function(){_t.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,bt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Nt="closure_listenable_"+(1e6*Math.random()|0),At=0;function xt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.aa=i,this.key=++At,this.V=this.X=!1}function St(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function Dt(t){this.src=t,this.a={},this.b=0}function Pt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=F(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(St(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Rt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==r)return i}return-1}Dt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Rt(t,e,r,i);return-1<s?(e=t[s],n||(e.X=!1)):((e=new xt(e,this.src,o,!!r,i)).X=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),kt={};function Lt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Bt(r);return e&&e[Nt]?e.sa(n,r,P(i)?!!i.capture:!!i,o):Ct(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,r,i);return null}return n=Bt(n),t&&t[Nt]?t.ra(e,n,P(r)?!!r.capture:!!r,i):Ct(t,e,n,!1,r,i)}function Ct(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!wt)return null;var u,a,h=Ft(t);if(h||(t[Ot]=h=new Dt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Mt,r=a=wt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)It||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ut(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Vt(t){if("number"!=typeof t&&t&&!t.V){var e=t.src;if(e&&e[Nt])Pt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ut(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ft(e))?(Pt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):St(t)}}}function Ut(t){return t in kt?kt[t]:kt[t]="on"+t}function jt(t,e){var n=t.listener,r=t.aa||t.src;return t.X&&Vt(t),n.call(r,e)}function Mt(t,e){if(t.V)return!0;if(wt)return jt(t,new _t(e,this));if(!e)t:{e=["window","event"];for(var n=A,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return jt(t,e=new _t(e,this))}function Ft(t){return(t=t[Ot])instanceof Dt?t:null}var qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(e){return"function"==S(e)?e:(e[qt]||(e[qt]=function(t){return e.handleEvent(t)}),e[qt])}function Gt(){M.call(this),this.c=new Dt(this),(this.J=this).A=null}function zt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.V&&s.capture==n){var u=s.listener,a=s.aa||s.src;s.X&&Pt(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}j(Gt,M),Gt.prototype[Nt]=!0,(_=Gt.prototype).addEventListener=function(t,e,n,r){Lt(this,t,e,n,r)},_.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=Bt(r),e&&e[Nt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Rt(s=e.a[n],r,i,o))&&(St(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ft(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Rt(n,r,i,o)),(r=-1<e?n[e]:null)&&Vt(r))}(this,t,e,n,r)},_.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t)t=new Et(t,n);else if(t instanceof Et)t.target=t.target||n;else{var i=t;tt(t=new Et(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=zt(s,r,!0,t)&&i}if(i=zt(s=t.a=n,r,!0,t)&&i,i=zt(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=zt(s=t.a=e[o],r,!1,t)&&i;return i},_.C=function(){if(Gt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)St(n[r]);delete e.a[t],e.b--}}this.A=null},_.ra=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},_.sa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ht=A.JSON.stringify;function Wt(){this.b=this.a=null}var Yt,Xt=(Kt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Kt(function(){return new Qt},function(t){t.reset()},100));function Kt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Qt(){this.next=this.b=this.a=null}function Jt(t){A.setTimeout(function(){throw t},0)}function $t(t,e){var n;Yt||(n=A.Promise.resolve(void 0),Yt=function(){n.then(ee)}),Zt||(Yt(),Zt=!0),te.add(t,e)}Wt.prototype.add=function(t,e){var n=Xt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Qt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Zt=!(Qt.prototype.reset=function(){this.next=this.b=this.a=null}),te=new Wt;function ee(){for(var t;r=n=void 0,r=null,(n=te).a&&(r=n.a,n.a=n.a.next,n.a||(n.b=null),r.next=null),t=r;){try{t.a.call(t.b)}catch(t){Jt(t)}var e=Xt;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}var n,r;Zt=!1}function ne(t,e){Gt.call(this),this.b=t||1,this.a=e||A,this.f=C(this.Ua,this),this.g=U()}function re(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ie(t,e,n){if("function"==S(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:A.setTimeout(t,e||0)}function oe(t,e,n){M.call(this),this.f=null!=n?C(t,n):t,this.c=e,this.b=C(this.Pa,this),this.a=[]}function se(t){t.T=ie(t.b,t.c),t.f.apply(null,t.a)}function ue(t){M.call(this),this.b=t,this.a={}}j(ne,Gt),(_=ne.prototype).Z=!1,_.L=null,_.Ua=function(){if(this.Z){var t=U()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(re(this),this.start()))}},_.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=U())},_.C=function(){ne.M.C.call(this),re(this),delete this.a},j(oe,M),(_=oe.prototype).ba=!1,_.T=null,_.Ia=function(t){this.a=arguments,this.T?this.ba=!0:se(this)},_.C=function(){oe.M.C.call(this),this.T&&(A.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},_.Pa=function(){this.T=null,this.ba&&(this.ba=!1,se(this))},j(ue,M);var ae=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Lt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Vt(t)},t),t.a={}}function fe(){}ue.prototype.C=function(){ue.M.C.call(this),ce(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var le=null;function pe(){return le=le||new Gt}function de(t){Et.call(this,"serverreachability",t)}function ye(t){var e=pe();e.dispatchEvent(new de(e))}function ve(t){Et.call(this,"statevent",t)}function ge(t){var e=pe();e.dispatchEvent(new ve(e))}function me(t){Et.call(this,"timingevent",t)}function we(t,e){if("function"!=S(t))throw Error("Fn must not be null and must be a function");return A.setTimeout(function(){t()},e)}j(de,Et),j(ve,Et),j(me,Et);var be={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},Ie={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function Ee(){}function _e(t){var e;return(e=t.a)||(e=t.a={}),e}function Te(){}Ee.prototype.a=null;var Ne,Ae={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function xe(){Et.call(this,"d")}function Se(){Et.call(this,"c")}function De(){}function Pe(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new ue(this),this.N=Re,t=ut?125:void 0,this.O=new ne(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}j(xe,Et),j(Se,Et),j(De,Ee),Ne=new De;var Re=45e3,Oe={},ke={};function Le(t,e,n){t.B=1,t.f=nn(Qe(e)),t.j=n,t.F=!0,Ce(t,null)}function Ce(t,e){t.s=U(),je(t),t.A=Qe(t.f);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.w=0,t.a=ur(t.g,t.g.w?e:null),0<t.J&&(t.D=new oe(C(t.ya,t,t.a),t.J)),he(t.G,t.a,"readystatechange",t.Sa),e=t.m?$(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),ye(1)}function Ve(t,e,n){for(var r=!0;!t.l&&t.w<n.length;){var i=Ue(t,n);if(i==ke){4==e&&(t.c=4,ge(14),r=!1);break}if(i==Oe){t.c=4,ge(15),r=!1;break}Ge(t,i)}4==e&&0==n.length&&(t.c=1,ge(16),r=!1),t.b=t.b&&r,r||(Be(t),qe(t))}function Ue(t,e){var n=t.w,r=e.indexOf("\n",n);return-1==r?ke:(n=Number(e.substring(n,r)),isNaN(n)?Oe:(r+=1)+n>e.length?ke:(e=e.substr(r,n),t.w=r+n,e))}function je(t){t.P=U()+t.N,Me(t,t.N)}function Me(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=we(C(t.Qa,t),e)}function Fe(t){t.h&&(A.clearTimeout(t.h),t.h=null)}function qe(t){0==t.g.u||t.l||nr(t.g,t)}function Be(t){Fe(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,re(t.O),ce(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function Ge(t,e){try{var n=t.g;if(0!=n.u&&(n.a==t||_n(n.b,t)))if(n.A=t.H,!t.o&&_n(n.b,t)&&3==n.u){try{var r=n.ja.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.i){if(n.a){if(!(n.a.s+3e3<t.s))break t;er(n),n.a.cancel(),n.a=null}tr(n),ge(18)}}else n.ia=i[1],0<n.ia-n.G&&i[2]<37500&&n.U&&0==n.m&&!n.l&&(n.l=we(C(n.Na,n),6e3));if(En(n.b)<=1&&n.O){try{n.O()}catch(t){}n.O=void 0}}else ir(n,11)}else if(!t.o&&n.a!=t||er(n),!z(e))for(e=r=n.ja.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.G=i[0],i=i[1],2==n.u)if("c"==i[0]){n.B=i[1],n.R=i[2];var o=i[3];null!=o&&(n.oa=o);var s=i[5];null!=s&&"number"==typeof s&&0<s&&(n.D=1.5*s);var u=n,a=t.a;if(a){var h=a.a?a.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var c=u.b;!c.a&&(Y(h,"spdy")||Y(h,"quic")||Y(h,"h2"))&&(c.f=c.g,c.a=new Set,c.b&&(Tn(c,c.b),c.b=null))}if(u.s){var f=a.a?a.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.ha=f,en(u.v,u.s,f))}}n.u=3,n.c&&n.c.na();var l=t;if((u=n).ea=sr(u,u.w?u.R:null,u.P),l.o){Nn(u.b,l);var p=l,d=u.D;d&&p.setTimeout(d),p.h&&(Fe(p),je(p)),u.a=l}else Zn(u);0<n.f.length&&Kn(n)}else"stop"!=i[0]&&"close"!=i[0]||ir(n,7);else 3==n.u&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?ir(n,7):Wn(n):"noop"!=i[0]&&n.c&&n.c.ma(i),n.m=0);ye(4)}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)q(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof He)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ye(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Ye(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(_=Pe.prototype).setTimeout=function(t){this.N=t},_.Sa=function(t){t=t.target;var e=this.D;e&&3==Bn(t)?e.Ia():this.ya(t)},_.ya=function(t){try{if(t==this.a)t:{var e=Bn(this.a),n=this.a.qa(),r=this.a.S();if(!(e<3||3==e&&!ut&&!this.a.Y())){this.l||4!=e||7==n||ye(8==n||r<=0?3:2),Fe(this);var i=this.a.S();this.H=i;var o=this.a.Y();if(this.b=200==i){if(this.R&&!this.o){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.c=3,ge(12),Be(this),qe(this);break t}this.o=!0,Ge(this,a)}this.F?(Ve(this,e,o),ut&&this.b&&3==e&&(he(this.G,this.O,"tick",this.Ra),this.O.start())):Ge(this,o),4==e&&Be(this),this.b&&!this.l&&(4==e?nr(this.g,this):(this.b=!1,je(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,ge(12)):(this.c=0,ge(13)),Be(this),qe(this)}}}catch(t){}},_.Ra=function(){if(this.a){var t=Bn(this.a),e=this.a.Y();this.w<e.length&&(Fe(this),Ve(this,t,e),this.b&&4!=t&&je(this))}},_.cancel=function(){this.l=!0,Be(this)},_.Qa=function(){this.h=null;var t=U();0<=t-this.P?(2!=this.B&&(ye(3),ge(17)),Be(this),this.c=2,qe(this)):Me(this,this.P-t)},(_=He.prototype).I=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},_.K=function(){return We(this),this.a.concat()},_.get=function(t,e){return Ye(this.b,t)?this.b[t]:e},_.set=function(t,e){Ye(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},_.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Xe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ke){this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,$e(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b;var n=new ln;n.c=e.c,e.a&&(n.a=new He(e.a),n.b=e.b),tn(this,n),this.i=t.i}else t&&(n=String(t).match(Xe))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=rn(n[2]||""),$e(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Qe(t){return new Ke(t)}function Je(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,cn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?hn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,hn=/[#\?]/g,cn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new He,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),Ye(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ye((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function yn(t,e){return pn(t),e=gn(t,e),Ye(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),G(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function mn(t,e){this.b=t,this.a=e}function wn(t){this.g=t||bn,t=A.PerformanceNavigationTiming?0<(t=A.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(A.ca&&A.ca.ua&&A.ca.ua()&&A.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(_=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},_.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},_.K=function(){pn(this);for(var t=this.a.I(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},_.I=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=B(e,this.a.get(gn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},_.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},_.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},_.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.I(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var bn=10;function In(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function _n(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return G(t.c);var r=t.c;try{for(var i=E(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.i)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function xn(){}function Sn(){this.a=new xn}function Dn(t,r,e){var i=e||"";try{ze(t,function(t,e){var n=t;P(t)&&(n=Ht(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}function Pn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=E(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},xn.prototype.stringify=function(t){return A.JSON.stringify(t,void 0)},xn.prototype.parse=function(t){return A.JSON.parse(t,void 0)};var Rn=A.JSON.parse;function On(t){Gt.call(this),this.headers=new He,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=kn,this.B=this.F=!1}j(On,Gt);var kn="",Ln=/^https?$/i,Cn=["POST","PUT"];function Vn(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,jn(t),Fn(t)}function jn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Mn(t){if(t.b&&void 0!==N&&(!t.s[1]||4!=Bn(t)||2!=t.S()))if(t.l&&4==Bn(t))ie(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==Bn(t)){t.b=!1;try{var e,n=t.S();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.D).match(Xe)[1]||null;if(!o&&A.self&&A.self.location){var s=A.self.location.protocol;o=s.substr(0,s.length-1)}i=!Ln.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Bn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.S()+"]",jn(t)}}finally{Fn(t)}}}function Fn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?x:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(A.clearTimeout(t.m),t.m=null)}function Bn(t){return t.a?t.a.readyState:0}function Gn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function zn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Hn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=zn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=zn("baseRetryDelayMs",5e3,t),this.Ga=zn("retryDelaySeedMs",1e4,t),this.Da=zn("forwardChannelMaxRetries",2,t),this.ga=zn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new wn(t&&t.concurrentRequestLimit),this.ja=new Sn,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function Wn(t){if(Yn(t),3==t.u){var e=t.H++,n=Qe(t.v);en(n,"SID",t.B),en(n,"RID",e),en(n,"TYPE","terminate"),Jn(t,n),(e=new Pe(t,e,void 0)).B=2,e.f=nn(Qe(n)),n=!1,A.navigator&&A.navigator.sendBeacon&&(n=A.navigator.sendBeacon(e.f.toString(),"")),!n&&A.Image&&((new Image).src=e.f,n=!0),n||(e.a=ur(e.g,null),e.a.$(e.f)),e.s=U(),je(e)}or(t)}function Yn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(A.clearTimeout(t.i),t.i=null),er(t),t.b.cancel(),t.g&&("number"==typeof t.g&&A.clearTimeout(t.g),t.g=null)}function Xn(t,e){t.f.push(new mn(t.Fa++,e)),3==t.u&&Kn(t)}function Kn(t){In(t.b)||t.g||(t.g=!0,$t(t.xa,t),t.o=0)}function Qn(t,e){var n;n=e?e.W:t.H++;var r=Qe(t.v);en(r,"SID",t.B),en(r,"RID",n),en(r,"AID",t.G),Jn(t,r),t.h&&t.j&&Gn(r,t.h,t.j),n=new Pe(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),Tn(t.b,n),Le(n,r,e)}function Jn(t,n){t.c&&ze({},function(t,e){en(n,e,t)})}function $n(t,e,n){n=Math.min(t.f.length,n);var r=t.c?C(t.c.Ha,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{Dn(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,r}function Zn(t){t.a||t.i||(t.J=1,$t(t.wa,t),t.m=0)}function tr(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=we(C(t.wa,t),rr(t,t.m)),t.m++,1)}function er(t){null!=t.l&&(A.clearTimeout(t.l),t.l=null)}function nr(t,e){var n=null;if(t.a==e){er(t),t.a=null;var r=2}else{if(!_n(t.b,e))return;n=e.i,Nn(t.b,e),r=1}if(t.A=e.H,0!=t.u)if(e.b)if(1==r){n=e.j?e.j.length:0,e=U()-e.s;var i=t.o;(r=pe()).dispatchEvent(new me(r)),Kn(t)}else Zn(t);else if(3==(i=e.c)||0==i&&0<t.A||!(1==r&&function(t,e){if(!(En(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=we(C(t.xa,t,e),rr(t,t.o)),t.o++,1}}(t,e)||2==r&&tr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function ir(t,e){if(2==e){var n=null;t.c&&(n=null);var r=C(t.Ta,t);n||(n=new Ke("//www.google.com/images/cleardot.gif"),A.location&&"http"==A.location.protocol||Je(n,"https"),nn(n)),function(t,e){var n=new fe;if(A.Image){var r=new Image;r.onload=V(Pn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=V(Pn,n,r,"TestLoadImage: error",!1,e),r.onabort=V(Pn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=V(Pn,n,r,"TestLoadImage: timeout",!1,e),A.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else ge(2);t.u=0,t.c&&t.c.la(e),or(t),Yn(t)}function or(t){t.u=0,t.A=-1,t.c&&(0==An(t.b).length&&0==t.f.length||(t.b.c.length=0,G(t.f),t.f.length=0),t.c.ka())}function sr(t,e,n){var r,i,o,s,u,a,h=(r=n)instanceof Ke?Qe(r):new Ke(r,void 0);if(""!=h.c)e&&$e(h,e+"."+h.c),Ze(h,h.h);else{var c=A.location;i=c.protocol,o=e?e+"."+c.hostname:c.hostname,s=+c.port,u=n,a=new Ke(null,void 0),i&&Je(a,i),o&&$e(a,o),s&&Ze(a,s),u&&(a.g=u),h=a}return t.N&&J(t.N,function(t,e){en(h,e,t)}),e=t.s,n=t.ha,e&&n&&en(h,e,n),en(h,"VER",t.oa),Jn(t,h),h}function ur(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.Ea)).F=t.w,e}function ar(){}function hr(){if(ot&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function cr(t,e){Gt.call(this),this.a=new Hn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new pr(this)}function fr(t){xe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function lr(){Se.call(this),this.status=1}function pr(t){this.a=t}(_=On.prototype).$=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?_e(this.G):_e(Ne),this.a.onreadystatechange=C(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Un(this,t)}t=n||"";var i,o=new He(this.headers);r&&ze(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Vn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=A.FormData&&t instanceof A.FormData,0<=F(Cn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.B=(i=this.a,ot&&vt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.ta,this)):this.m=ie(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Un(this,t)}},_.ta=function(){void 0!==N&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},_.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Fn(this))},_.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Fn(this,!0)),On.M.C.call(this)},_.va=function(){this.j||(this.w||this.l||this.g?Mn(this):this.Oa())},_.Oa=function(){Mn(this)},_.S=function(){try{return 2<Bn(this)?this.a.status:-1}catch(t){return-1}},_.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},_.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Rn(e)}},_.qa=function(){return this.h},_.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(_=Hn.prototype).oa=8,_.u=1,_.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new Pe(this,t,void 0),r=this.j;if(this.F&&(r?tt(r=$(r),this.F):r=this.F),null===this.h&&(n.m=r),this.fa)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),en(i=Qe(this.v),"RID",t),en(i,"CVER",22),this.s&&en(i,"X-HTTP-Session-Id",this.s),Jn(this,i),this.h&&r&&Gn(i,this.h,r),Tn(this.b,n),this.fa?(en(i,"$req",e),en(i,"SID","null"),n.R=!0,Le(n,i,null)):Le(n,i,e),this.u=2}}else 3==this.u&&(t?Qn(this,t):0==this.f.length||In(this.b)||Qn(this))},_.wa=function(){this.i=null,this.a=new Pe(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Qe(this.ea);en(t,"RID","rpc"),en(t,"SID",this.B),en(t,"CI",this.U?"0":"1"),en(t,"AID",this.G),Jn(this,t),en(t,"TYPE","xmlhttp"),this.h&&this.j&&Gn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=nn(Qe(t)),e.j=null,e.F=!0,Ce(e,n)},_.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,tr(this),ge(19))},_.Ta=function(t){ge(t?2:1)},(_=ar.prototype).na=function(){},_.ma=function(){},_.la=function(){},_.ka=function(){},_.Ha=function(){},hr.prototype.a=function(t,e){return new cr(t,e)},j(cr,Gt),(_=cr.prototype).addEventListener=function(t,e,n,r){cr.M.addEventListener.call(this,t,e,n,r)},_.removeEventListener=function(t,e,n,r){cr.M.removeEventListener.call(this,t,e,n,r)},_.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(0),t.P=e,t.N=n||{},t.U=t.W,t.v=sr(t,null,t.P),Kn(t)},_.close=function(){Wn(this.a)},_.La=function(t){if("string"==typeof t){var e={};e.__data__=t,Xn(this.a,e)}else this.g?((e={}).__data__=Ht(t),Xn(this.a,e)):Xn(this.a,t)},_.C=function(){this.a.c=null,delete this.f,Wn(this.a),delete this.a,cr.M.C.call(this)},j(fr,xe),j(lr,Se),j(pr,ar),pr.prototype.na=function(){this.a.dispatchEvent("a")},pr.prototype.ma=function(t){this.a.dispatchEvent(new fr(t))},pr.prototype.la=function(t){this.a.dispatchEvent(new lr)},pr.prototype.ka=function(){this.a.dispatchEvent("b")},hr.prototype.createWebChannel=hr.prototype.a,cr.prototype.send=cr.prototype.La,cr.prototype.open=cr.prototype.Ka,cr.prototype.close=cr.prototype.close,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ie.COMPLETE="complete",(Te.EventType=Ae).OPEN="a",Ae.CLOSE="b",Ae.ERROR="c",Ae.MESSAGE="d",Gt.prototype.listen=Gt.prototype.ra,On.prototype.listenOnce=On.prototype.sa,On.prototype.getLastError=On.prototype.Ma,On.prototype.getLastErrorCode=On.prototype.qa,On.prototype.getStatus=On.prototype.S,On.prototype.getResponseJson=On.prototype.Ja,On.prototype.getResponseText=On.prototype.Y,On.prototype.send=On.prototype.$;var dr={createWebChannelTransport:function(){return new hr},ErrorCode:be,EventType:Ie,WebChannel:Te,XhrIo:On},yr=dr.createWebChannelTransport,vr=dr.ErrorCode,gr=dr.EventType,mr=dr.WebChannel,wr=dr.XhrIo,br=(Ir.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ir.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ir.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Ir);function Ir(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Er=Ed.SDK_VERSION,_r=new h("@firebase/firestore");function Tr(){return _r.logLevel}function Nr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(_r.logLevel<=p.DEBUG){var r=e.map(xr);_r.debug.apply(_r,d(["Firestore ("+Er+"): "+t],r))}}function Ar(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(_r.logLevel<=p.ERROR){var r=e.map(xr);_r.error.apply(_r,d(["Firestore ("+Er+"): "+t],r))}}function xr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Sr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Er+") INTERNAL ASSERTION FAILED: "+t;throw Ar(e),new Error(e)}function Dr(t){t||Sr()}function Pr(t){return t}function Rr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Or=(kr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Rr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},kr);function kr(){}function Lr(t,e){return t<e?-1:e<t?1:0}function Cr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Vr(t){return t+"\0"}function Ur(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var jr=(Object.defineProperty(Mr.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Mr.prototype.isEqual=function(t){return t instanceof Mr&&t.projectId===this.projectId&&t.database===this.database},Mr.prototype.o=function(t){return Lr(this.projectId,t.projectId)||Lr(this.database,t.database)},Mr);function Mr(t,e){this.projectId=t,this.database=e||"(default)"}function Fr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function qr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Br(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Gr,zr,Hr,Wr=(hi.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},hi.prototype.has=function(t){return void 0!==this.get(t)},hi.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},hi.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},hi.prototype.forEach=function(u){qr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},hi.prototype._=function(){return Br(this.l)},hi),Yr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Xr=(n(ai,Hr=Error),ai),Kr=(ui.now=function(){return ui.fromMillis(Date.now())},ui.fromDate=function(t){return ui.fromMillis(t.getTime())},ui.fromMillis=function(t){var e=Math.floor(t/1e3);return new ui(e,1e6*(t-1e3*e))},ui.prototype.toDate=function(){return new Date(this.toMillis())},ui.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ui.prototype.T=function(t){return this.seconds===t.seconds?Lr(this.nanoseconds,t.nanoseconds):Lr(this.seconds,t.seconds)},ui.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ui.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ui.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ui),Qr=(si.I=function(t){return new si(t)},si.min=function(){return new si(new Kr(0,0))},si.prototype.o=function(t){return this.timestamp.T(t.timestamp)},si.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},si.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},si.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},si.prototype.A=function(){return this.timestamp},si),Jr=(Object.defineProperty(oi.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),oi.prototype.isEqual=function(t){return 0===oi.P(this,t)},oi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof oi?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},oi.prototype.limit=function(){return this.offset+this.length},oi.prototype.g=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},oi.prototype.p=function(){return this.V(this.segments,this.offset,this.length-1)},oi.prototype.v=function(){return this.segments[this.offset]},oi.prototype.S=function(){return this.get(this.length-1)},oi.prototype.get=function(t){return this.segments[this.offset+t]},oi.prototype._=function(){return 0===this.length},oi.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},oi.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},oi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},oi.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},oi.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},oi),$r=(n(ii,zr=Jr),ii.prototype.V=function(t,e,n){return new ii(t,e,n)},ii.prototype.N=function(){return this.F().join("/")},ii.prototype.toString=function(){return this.N()},ii.$=function(t){if(0<=t.indexOf("//"))throw new Xr(Yr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ii(t.split("/").filter(function(t){return 0<t.length}))},ii.k=function(){return new ii([])},ii),Zr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ti=(n(ri,Gr=Jr),ri.prototype.V=function(t,e,n){return new ri(t,e,n)},ri.M=function(t){return Zr.test(t)},ri.prototype.N=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ri.M(t)||(t="`"+t+"`"),t}).join(".")},ri.prototype.toString=function(){return this.N()},ri.prototype.O=function(){return 1===this.length&&"__name__"===this.get(0)},ri.L=function(){return new ri(["__name__"])},ri.B=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Xr(Yr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Xr(Yr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Xr(Yr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ri(e)},ri.k=function(){return new ri([])},ri),ei=(ni.q=function(t){return new ni($r.$(t).g(5))},ni.prototype.U=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ni.prototype.isEqual=function(t){return null!==t&&0===$r.P(this.path,t.path)},ni.prototype.toString=function(){return this.path.toString()},ni.P=function(t,e){return $r.P(t.path,e.path)},ni.W=function(t){return t.length%2==0},ni.j=function(t){return new ni(new $r(t.slice()))},ni);function ni(t){this.path=t}function ri(){return null!==Gr&&Gr.apply(this,arguments)||this}function ii(){return null!==zr&&zr.apply(this,arguments)||this}function oi(t,e,n){void 0===e?e=0:e>t.length&&Sr(),void 0===n?n=t.length-e:n>t.length-e&&Sr(),this.segments=t,this.offset=e,this.R=n}function si(t){this.timestamp=t}function ui(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Xr(Yr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Xr(Yr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Xr(Yr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Xr(Yr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ai(t,e){var n=this;return(n=Hr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function hi(t,e){this.h=t,this.u=e,this.l={}}function ci(t){return null==t}function fi(t){return-0===t&&1/t==-1/0}function li(t){return"number"==typeof t&&Number.isInteger(t)&&!fi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function pi(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.K=null}function di(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new pi(t,e,n,r,i,o,s)}function yi(t){var e=Pr(t);if(null===e.K){var n=e.path.N();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return(e=t).field.N()+e.op.toString()+Eo(e.value);var e}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return(e=t).field.N()+e.dir;var e}).join(","),ci(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Fu(e.startAt)),e.endAt&&(n+="|ub:",n+=Fu(e.endAt)),e.K=n}return e.K}function vi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(r=t.orderBy[n],i=e.orderBy[n],r.dir!==i.dir||!r.field.isEqual(i.field))return!1;var r,i,o,s;if(t.filters.length!==e.filters.length)return!1;for(var u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],!(o instanceof Eu&&s instanceof Eu&&o.op===s.op&&o.field.isEqual(s.field)&&mo(o.value,s.value)))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Bu(t.startAt,e.startAt)&&Bu(t.endAt,e.endAt)}function gi(t){return ei.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var mi=(wi.fromBase64String=function(t){return new wi(atob(t))},wi.fromUint8Array=function(t){return new wi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},wi.prototype.toBase64=function(){return t=this.G,btoa(t);var t},wi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.G)},wi.prototype.H=function(){return 2*this.G.length},wi.prototype.o=function(t){return Lr(this.G,t.G)},wi.prototype.isEqual=function(t){return this.G===t.G},wi);function wi(t){this.G=t}mi.Y=new mi("");function bi(t){this.count=t}var Ii,Ei,_i=(Ti.prototype.Z=function(t){return new Ti(this.target,this.targetId,this.J,t,this.X,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ti.prototype.tt=function(t,e){return new Ti(this.target,this.targetId,this.J,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ti.prototype.et=function(t){return new Ti(this.target,this.targetId,this.J,this.sequenceNumber,this.X,t,this.resumeToken)},Ti);function Ti(t,e,n,r,i,o,s){void 0===i&&(i=Qr.min()),void 0===o&&(o=Qr.min()),void 0===s&&(s=mi.Y),this.target=t,this.targetId=e,this.J=n,this.sequenceNumber=r,this.X=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ni(t){switch(t){case Yr.OK:return Sr();case Yr.CANCELLED:case Yr.UNKNOWN:case Yr.DEADLINE_EXCEEDED:case Yr.RESOURCE_EXHAUSTED:case Yr.INTERNAL:case Yr.UNAVAILABLE:case Yr.UNAUTHENTICATED:return;case Yr.INVALID_ARGUMENT:case Yr.NOT_FOUND:case Yr.ALREADY_EXISTS:case Yr.PERMISSION_DENIED:case Yr.FAILED_PRECONDITION:case Yr.ABORTED:case Yr.OUT_OF_RANGE:case Yr.UNIMPLEMENTED:case Yr.DATA_LOSS:return 1;default:return Sr()}}function Ai(t){if(void 0===t)return Ar("GRPC error has no .code"),Yr.UNKNOWN;switch(t){case Ii.OK:return Yr.OK;case Ii.CANCELLED:return Yr.CANCELLED;case Ii.UNKNOWN:return Yr.UNKNOWN;case Ii.DEADLINE_EXCEEDED:return Yr.DEADLINE_EXCEEDED;case Ii.RESOURCE_EXHAUSTED:return Yr.RESOURCE_EXHAUSTED;case Ii.INTERNAL:return Yr.INTERNAL;case Ii.UNAVAILABLE:return Yr.UNAVAILABLE;case Ii.UNAUTHENTICATED:return Yr.UNAUTHENTICATED;case Ii.INVALID_ARGUMENT:return Yr.INVALID_ARGUMENT;case Ii.NOT_FOUND:return Yr.NOT_FOUND;case Ii.ALREADY_EXISTS:return Yr.ALREADY_EXISTS;case Ii.PERMISSION_DENIED:return Yr.PERMISSION_DENIED;case Ii.FAILED_PRECONDITION:return Yr.FAILED_PRECONDITION;case Ii.ABORTED:return Yr.ABORTED;case Ii.OUT_OF_RANGE:return Yr.OUT_OF_RANGE;case Ii.UNIMPLEMENTED:return Yr.UNIMPLEMENTED;case Ii.DATA_LOSS:return Yr.DATA_LOSS;default:return Sr()}}(Ei=Ii=Ii||{})[Ei.OK=0]="OK",Ei[Ei.CANCELLED=1]="CANCELLED",Ei[Ei.UNKNOWN=2]="UNKNOWN",Ei[Ei.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ei[Ei.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ei[Ei.NOT_FOUND=5]="NOT_FOUND",Ei[Ei.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ei[Ei.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ei[Ei.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ei[Ei.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ei[Ei.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ei[Ei.ABORTED=10]="ABORTED",Ei[Ei.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ei[Ei.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ei[Ei.INTERNAL=13]="INTERNAL",Ei[Ei.UNAVAILABLE=14]="UNAVAILABLE",Ei[Ei.DATA_LOSS=15]="DATA_LOSS";var xi=(Oi.prototype.nt=function(t,e){return new Oi(this.P,this.root.nt(t,e,this.P).copy(null,null,Di.st,null,null))},Oi.prototype.remove=function(t){return new Oi(this.P,this.root.remove(t,this.P).copy(null,null,Di.st,null,null))},Oi.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Oi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Oi.prototype._=function(){return this.root._()},Object.defineProperty(Oi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Oi.prototype.it=function(){return this.root.it()},Oi.prototype.rt=function(){return this.root.rt()},Oi.prototype.ot=function(t){return this.root.ot(t)},Oi.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Oi.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Oi.prototype.ht=function(t){return this.root.ht(t)},Oi.prototype.at=function(){return new Si(this.root,null,this.P,!1)},Oi.prototype.ut=function(t){return new Si(this.root,t,this.P,!1)},Oi.prototype.ct=function(){return new Si(this.root,null,this.P,!0)},Oi.prototype.lt=function(t){return new Si(this.root,t,this.P,!0)},Oi),Si=(Ri.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Ri.prototype.wt=function(){return 0<this.ft.length},Ri.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Ri),Di=(Pi.prototype.copy=function(t,e,n,r,i){return new Pi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Pi.prototype._=function(){return!1},Pi.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Pi.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Pi.prototype.min=function(){return this.left._()?this:this.left.min()},Pi.prototype.it=function(){return this.min().key},Pi.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Pi.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},Pi.prototype.It=function(){if(this.left._())return Pi.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Rt()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Pi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.At()||r.left.left.At()||(r=r.Rt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.At()&&(r=r.Pt()),r.right._()||r.right.At()||r.right.left.At()||(r=r.Vt()),0===e(t,r.key)){if(r.right._())return Pi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.It())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Et()},Pi.prototype.At=function(){return this.color},Pi.prototype.Et=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.gt()),t.left.At()&&t.left.left.At()&&(t=t.Pt()),t.left.At()&&t.right.At()&&(t=t.yt()),t},Pi.prototype.Rt=function(){var t=this.yt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).gt()).yt()),t},Pi.prototype.Vt=function(){var t=this.yt();return t.left.left.At()&&(t=(t=t.Pt()).yt()),t},Pi.prototype.gt=function(){var t=this.copy(null,null,Pi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Pi.prototype.Pt=function(){var t=this.copy(null,null,Pi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Pi.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Pi.prototype.pt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},Pi.prototype.bt=function(){if(this.At()&&this.left.At())throw Sr();if(this.right.At())throw Sr();var t=this.left.bt();if(t!==this.right.bt())throw Sr();return t+(this.At()?0:1)},Pi);function Pi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Pi.RED,this.left=null!=r?r:Pi.EMPTY,this.right=null!=i?i:Pi.EMPTY,this.size=this.left.size+1+this.right.size}function Ri(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Oi(t,e){this.P=t,this.root=e||Di.EMPTY}function ki(){this.size=0}Di.EMPTY=null,Di.RED=!0,Di.st=!1,Di.EMPTY=(Object.defineProperty(ki.prototype,"key",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"value",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"color",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"left",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"right",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),ki.prototype.copy=function(t,e,n,r,i){return this},ki.prototype.nt=function(t,e,n){return new Di(t,e)},ki.prototype.remove=function(t,e){return this},ki.prototype._=function(){return!0},ki.prototype.ot=function(t){return!1},ki.prototype.ht=function(t){return!1},ki.prototype.it=function(){return null},ki.prototype.rt=function(){return null},ki.prototype.At=function(){return!1},ki.prototype.pt=function(){return!0},ki.prototype.bt=function(){return 0},new ki);var Li=(ji.prototype.has=function(t){return null!==this.data.get(t)},ji.prototype.first=function(){return this.data.it()},ji.prototype.last=function(){return this.data.rt()},Object.defineProperty(ji.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),ji.prototype.indexOf=function(t){return this.data.indexOf(t)},ji.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},ji.prototype.vt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},ji.prototype.St=function(t,e){var n;for(n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},ji.prototype.Dt=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},ji.prototype.at=function(){return new Ci(this.data.at())},ji.prototype.ut=function(t){return new Ci(this.data.ut(t))},ji.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},ji.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},ji.prototype._=function(){return this.data._()},ji.prototype.Ct=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},ji.prototype.isEqual=function(t){if(!(t instanceof ji))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},ji.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},ji.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},ji.prototype.copy=function(t){var e=new ji(this.P);return e.data=t,e},ji),Ci=(Ui.prototype.dt=function(){return this.Ft.dt().key},Ui.prototype.wt=function(){return this.Ft.wt()},Ui),Vi=new xi(ei.P);function Ui(t){this.Ft=t}function ji(t){this.P=t,this.data=new xi(this.P)}function Mi(){return Vi}function Fi(){return Mi()}var qi=new xi(ei.P);function Bi(){return qi}var Gi=new xi(ei.P),zi=new Li(ei.P);function Hi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=zi,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Wi=new Li(Lr);function Yi(){return Wi}function Xi(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function Ki(t,e){this.targetId=t,this.ee=e}function Qi(t,e,n,r){void 0===n&&(n=mi.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Ji=(co.kt=function(t){return new co(t.P)},co.prototype.has=function(t){return null!=this.Nt.get(t)},co.prototype.get=function(t){return this.Nt.get(t)},co.prototype.first=function(){return this.$t.it()},co.prototype.last=function(){return this.$t.rt()},co.prototype._=function(){return this.$t._()},co.prototype.indexOf=function(t){var e=this.Nt.get(t);return e?this.$t.indexOf(e):-1},Object.defineProperty(co.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),co.prototype.forEach=function(n){this.$t.ot(function(t,e){return n(t),!1})},co.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Nt.nt(t.key,t),e.$t.nt(t,null))},co.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Nt.remove(t),this.$t.remove(e)):this},co.prototype.isEqual=function(t){if(!(t instanceof co))return!1;if(this.size!==t.size)return!1;for(var e=this.$t.at(),n=t.$t.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},co.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},co.prototype.copy=function(t,e){var n=new co;return n.P=this.P,n.Nt=t,n.$t=e,n},co),$i=(ho.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):Sr()},ho.prototype.Mt=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},ho),Zi=(ao.Ut=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new ao(t,e,Ji.kt(e),i,n,r,!0,!1)},Object.defineProperty(ao.prototype,"hasPendingWrites",{get:function(){return!this.Lt._()},enumerable:!1,configurable:!0}),ao.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Bt===t.Bt&&this.Lt.isEqual(t.Lt)&&vu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ot.isEqual(t.Ot)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},ao),to=(uo.Gt=function(t,e){var n=new Map;return n.set(t,eo.zt(t,e)),new uo(Qr.min(),n,Yi(),Mi(),Hi())},uo),eo=(so.zt=function(t,e){return new so(mi.Y,e,Hi(),Hi(),Hi())},so),no=(Object.defineProperty(oo.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),oo.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},oo.prototype.ce=function(){var n=Hi(),r=Hi(),i=Hi();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Sr()}}),new eo(this.ie,this.re,n,r,i)},oo.prototype.le=function(){this.oe=!1,this.se=lo()},oo.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},oo.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},oo.prototype.de=function(){this.ne+=1},oo.prototype.we=function(){--this.ne},oo.prototype.Te=function(){this.oe=!0,this.re=!0},oo),ro=(io.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof au?this.Ve(r,t.te):t.te instanceof hu&&this.ge(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ge(s,t.key,t.te)}},io.prototype.ye=function(n){var r=this;this.pe(n,function(t){var e=r.be(t);switch(n.state){case 0:r.ve(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.ve(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.ve(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:Sr()}})},io.prototype.pe=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){r.ve(e)&&n(e)})},io.prototype.De=function(t){var e=t.targetId,n=t.ee.count,r=this.Ce(e);if(r){var i=r.target;if(gi(i))if(0===n){var o=new ei(i.path);this.ge(e,o,new hu(o,Qr.min()))}else Dr(1===n);else this.Fe(e)!==n&&(this.Se(e),this.Re=this.Re.add(e))}},io.prototype.Ne=function(i){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n=o.Ce(e);if(n){if(t.Ht&&gi(n.target)){var r=new ei(n.target.path);null!==o.me.get(r)||o.$e(e,r)||o.ge(e,r,new hu(r,i))}t.ae&&(s.set(e,t.ce()),t.le())}});var r=Hi();this.Ae.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.Ce(t);return!e||2===e.J||(n=!1)}),n&&(r=r.add(t))});var t=new to(i,s,this.Re,this.me,r);return this.me=Mi(),this.Ae=fo(),this.Re=new Li(Lr),t},io.prototype.Ve=function(t,e){if(this.ve(t)){var n=this.$e(t,e.key)?2:0;this.be(t)._e(e.key,n),this.me=this.me.nt(e.key,e),this.Ae=this.Ae.nt(e.key,this.ke(e.key).add(t))}},io.prototype.ge=function(t,e,n){if(this.ve(t)){var r=this.be(t);this.$e(t,e)?r._e(e,1):r.fe(e),this.Ae=this.Ae.nt(e,this.ke(e).delete(t)),n&&(this.me=this.me.nt(e,n))}},io.prototype.removeTarget=function(t){this.Ie.delete(t)},io.prototype.Fe=function(t){var e=this.be(t).ce();return this.Ee.xe(t).size+e.Yt.size-e.Xt.size},io.prototype.de=function(t){this.be(t).de()},io.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new no,this.Ie.set(t,e)),e},io.prototype.ke=function(t){var e=this.Ae.get(t);return e||(e=new Li(Lr),this.Ae=this.Ae.nt(t,e)),e},io.prototype.ve=function(t){var e=null!==this.Ce(t);return e||Nr("WatchChangeAggregator","Detected inactive target",t),e},io.prototype.Ce=function(t){var e=this.Ie.get(t);return e&&e.he?null:this.Ee.Me(t)},io.prototype.Se=function(e){var n=this;this.Ie.set(e,new no),this.Ee.xe(e).forEach(function(t){n.ge(e,t,null)})},io.prototype.$e=function(t,e){return this.Ee.xe(t).has(e)},io);function io(t){this.Ee=t,this.Ie=new Map,this.me=Mi(),this.Ae=fo(),this.Re=new Li(Lr)}function oo(){this.ne=0,this.se=lo(),this.ie=mi.Y,this.re=!1,this.oe=!0}function so(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Jt=r,this.Xt=i}function uo(t,e,n,r,i){this.X=t,this.Qt=e,this.Wt=n,this.jt=r,this.Kt=i}function ao(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ot=n,this.docChanges=r,this.Lt=i,this.fromCache=o,this.Bt=s,this.qt=u}function ho(){this.xt=new xi(ei.P)}function co(n){this.P=n?function(t,e){return n(t,e)||ei.P(t.key,e.key)}:function(t,e){return ei.P(t.key,e.key)},this.Nt=Bi(),this.$t=new xi(this.P)}function fo(){return new xi(ei.P)}function lo(){return new xi(ei.P)}function po(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function yo(t){var e=_o(t.mapValue.fields.__local_write_time__.timestampValue);return new Kr(e.seconds,e.nanos)}var vo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function go(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?po(t)?4:10:Sr()}function mo(i,t){var e,n,r,o=go(i);if(o!==go(t))return!1;switch(o){case 0:return!0;case 1:return i.booleanValue===t.booleanValue;case 4:return yo(i).isEqual(yo(t));case 3:return function(t){if("string"==typeof i.timestampValue&&"string"==typeof t.timestampValue&&i.timestampValue.length===t.timestampValue.length)return i.timestampValue===t.timestampValue;var e=_o(i.timestampValue),n=_o(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(t);case 5:return i.stringValue===t.stringValue;case 6:return r=t,No(i.bytesValue).isEqual(No(r.bytesValue));case 7:return i.referenceValue===t.referenceValue;case 8:return n=t,To((e=i).geoPointValue.latitude)===To(n.geoPointValue.latitude)&&To(e.geoPointValue.longitude)===To(n.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return To(t.integerValue)===To(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=To(t.doubleValue),r=To(e.doubleValue);return n===r?fi(n)===fi(r):isNaN(n)&&isNaN(r)}return!1}(i,t);case 9:return Cr(i.arrayValue.values||[],t.arrayValue.values||[],mo);case 10:return function(t){var e=i.mapValue.fields||{},n=t.mapValue.fields||{};if(Fr(e)!==Fr(n))return!1;for(var r in e)if(e.hasOwnProperty(r)&&(void 0===n[r]||!mo(e[r],n[r])))return!1;return!0}(t);default:return Sr()}}function wo(t,e){return void 0!==(t.values||[]).find(function(t){return mo(t,e)})}function bo(t,e){var n,r,i,o,s,u,a,h,c,f,l=go(t),p=go(e);if(l!==p)return Lr(l,p);switch(l){case 0:return 0;case 1:return Lr(t.booleanValue,e.booleanValue);case 2:return h=e,c=To(t.integerValue||t.doubleValue),f=To(h.integerValue||h.doubleValue),c<f?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return Io(t.timestampValue,e.timestampValue);case 4:return Io(yo(t),yo(e));case 5:return Lr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=No(o),a=No(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Lr(n[i],r[i]);if(0!==o)return o}return Lr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Lr(To(n.latitude),To(r.latitude)))?i:Lr(To(n.longitude),To(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=bo(n[i],r[i]);if(o)return o}return Lr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Lr(r[s],o[s]);if(0!==u)return u;var a=bo(n[r[s]],i[o[s]]);if(0!==a)return a}return Lr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Sr()}}function Io(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Lr(t,e);var n=_o(t),r=_o(e),i=Lr(n.seconds,r.seconds);return 0!==i?i:Lr(n.nanos,r.nanos)}function Eo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=_o(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?No(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,ei.q(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++){e?e=!1:t+=",",t+=s(r[n])}return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Sr();var t,e,n}(t)}function _o(t){if(Dr(!!t),"string"!=typeof t)return{seconds:To(t.seconds),nanos:To(t.nanos)};var e=0,n=vo.exec(t);if(Dr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}function To(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function No(t){return"string"==typeof t?mi.fromBase64String(t):mi.fromUint8Array(t)}function Ao(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.N()}}function xo(t){return t&&"integerValue"in t}function So(t){return!!t&&"arrayValue"in t}function Do(t){return t&&"nullValue"in t}function Po(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ro(t){return t&&"mapValue"in t}var Oo={asc:"ASCENDING",desc:"DESCENDING"},ko={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Lo=function(t,e){this.s=t,this.Oe=e};function Co(t){return{integerValue:""+t}}function Vo(t,e){if(t.Oe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fi(e)?"-0":e}}function Uo(t,e){return li(e)?Co(e):Vo(t,e)}function jo(t,e){return t.Oe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mo(t,e){return t.Oe?e.toBase64():e.toUint8Array()}function Fo(t){return Dr(!!t),Qr.I((e=_o(t),new Kr(e.seconds,e.nanos)));var e}function qo(t,e){return new $r(["projects",t.projectId,"databases",t.database]).child("documents").child(e).N()}function Bo(t){var e=$r.$(t);return Dr(is(e)),e}function Go(t,e){return qo(t.s,e.path)}function zo(t,e){var n=Bo(e);return Dr(n.get(1)===t.s.projectId),Dr(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new ei(Xo(n))}function Ho(t,e){return qo(t.s,e)}function Wo(t){var e=Bo(t);return 4===e.length?$r.k():Xo(e)}function Yo(t){return new $r(["projects",t.s.projectId,"databases",t.s.database]).N()}function Xo(t){return Dr(4<t.length&&"documents"===t.get(4)),t.g(5)}function Ko(t,e,n){return{name:Go(t,e),fields:n.proto.mapValue.fields}}function Qo(t,e){var n,r,i,o,s,u,a;if(e instanceof Us)n={update:Ko(t,e.key,e.value)};else if(e instanceof Ks)n={delete:Go(t,e.key)};else if(e instanceof js)n={update:Ko(t,e.key,e.data),updateMask:(r=e.Le,i=[],r.fields.forEach(function(t){return i.push(t.N())}),{fieldPaths:i})};else if(e instanceof Gs)n={transform:{document:Go(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){return function(t){var e=t.transform;if(e instanceof hs)return{fieldPath:t.field.N(),setToServerValue:"REQUEST_TIME"};if(e instanceof cs)return{fieldPath:t.field.N(),appendMissingElements:{values:e.elements}};if(e instanceof ys)return{fieldPath:t.field.N(),removeAllFromArray:{values:e.elements}};if(e instanceof ws)return{fieldPath:t.field.N(),increment:e.Be};throw Sr()}(t)})}};else{if(!(e instanceof Qs))return Sr();n={verify:Go(t,e.key)}}return e.Ue.qe||(n.currentDocument=(o=t,void 0!==(s=e.Ue).updateTime?{updateTime:(u=o,a=s.updateTime,jo(u,a.A()))}:void 0!==s.exists?{exists:s.exists}:Sr())),n}function Jo(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?xs.updateTime(Fo(n.updateTime)):void 0!==n.exists?xs.exists(n.exists):xs.Qe():xs.Qe();if(t.update){t.update.name;var o=zo(e,t.update.name),s=new Js({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new _s(r.map(function(t){return ti.B(t)})));return new js(o,s,u,i)}return new Us(o,s,i)}if(t.delete){var a=zo(e,t.delete);return new Ks(a,i)}if(t.transform){var h=zo(e,t.transform.document),c=t.transform.fieldTransforms.map(function(t){return function(t,e){var n=null;if("setToServerValue"in e)Dr("REQUEST_TIME"===e.setToServerValue),n=new hs;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new cs(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new ys(i)}else"increment"in e?n=new ws(t,e.increment):Sr();var o=ti.B(e.fieldPath);return new Ts(o,n)}(e,t)});return Dr(!0===i.exists),new Gs(h,c)}if(t.verify){var f=zo(e,t.verify);return new Qs(f,i)}return Sr()}function $o(t,e){return{documents:[Ho(t,e.path)]}}function Zo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ho(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ho(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return t instanceof Eu?function(t){if("=="===t.op){if(Po(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NAN"}};if(Do(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:ns(t.field),op:(e=t.op,ko[e]),value:t.value}};var e}(t):Sr()});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:ns((e=t).field),direction:(n=e.dir,Oo[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u,a=(s=t,u=e.limit,s.Oe||ci(u)?u:{value:u});return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=ts(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ts(e.endAt)),n}function ts(t){return{before:t.before,values:t.position}}function es(t){var e=!!t.before,n=t.values||[];return new Lu(n,e)}function ns(t){return{fieldPath:t.N()}}function rs(t){return ti.B(t.fieldPath)}function is(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function os(){this.je=void 0}function ss(t,e){return t instanceof ws?xo(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var us,as,hs=(n(ls,as=os),ls),cs=(n(fs,us=os),fs);function fs(t){var e=this;return(e=us.call(this)||this).elements=t,e}function ls(){return null!==as&&as.apply(this,arguments)||this}function ps(t,e){for(var n=Es(e),r=function(e){n.some(function(t){return mo(t,e)})||n.push(e)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ds,ys=(n(vs,ds=os),vs);function vs(t){var e=this;return(e=ds.call(this)||this).elements=t,e}function gs(t,e){for(var n=Es(e),r=function(e){n=n.filter(function(t){return!mo(t,e)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ms,ws=(n(bs,ms=os),bs);function bs(t,e){var n=this;return(n=ms.call(this)||this).serializer=t,n.Be=e,n}function Is(t){return To(t.integerValue||t.doubleValue)}function Es(t){return So(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var _s=(Ns.prototype.Ke=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},Ns.prototype.isEqual=function(t){return Cr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ns),Ts=function(t,e){this.field=t,this.transform=e};function Ns(t){(this.fields=t).sort(ti.P)}function As(t,e){this.version=t,this.transformResults=e}var xs=(Ss.Qe=function(){return new Ss},Ss.exists=function(t){return new Ss(void 0,t)},Ss.updateTime=function(t){return new Ss(t)},Object.defineProperty(Ss.prototype,"qe",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ss.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ss);function Ss(t,e){this.updateTime=t,this.exists=e}function Ds(t,e){return void 0!==t.updateTime?e instanceof au&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof au}function Ps(){}function Rs(t,e,n){return t instanceof Us?(i=n,new au(t.key,i.version,t.value,{hasCommittedMutations:!0})):t instanceof js?function(t,e,n){if(!Ds(t.Ue,e))return new cu(t.key,n.version);var r=qs(t,e);return new au(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Gs?function(t,e,n){if(Dr(null!=n.transformResults),!Ds(t.Ue,e))return new cu(t.key,n.version);var r=Hs(0,e),i=function(t,e,n){var r,i,o,s=[];Dr(t.length===n.length);for(var u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof au&&(c=e.field(a.field)),s.push((r=h,i=c,o=n[u],r instanceof cs?ps(r,i):r instanceof ys?gs(r,i):o))}return s}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Ws(t,r.data(),i);return new au(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):(r=n,new hu(t.key,r.version,{hasCommittedMutations:!0}));var r,i}function Os(t,e,n,r){return t instanceof Us?function(t,e){if(!Ds(t.Ue,e))return e;var n=Ls(e);return new au(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof js?function(t,e){if(!Ds(t.Ue,e))return e;var n=Ls(e),r=qs(t,e);return new au(t.key,n,r,{Ge:!0})}(t,e):t instanceof Gs?function(t,e,n,r){if(!Ds(t.Ue,e))return e;var i=Hs(0,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,h=null;n instanceof au&&(h=n.field(u.field)),null===h&&r instanceof au&&(h=r.field(u.field)),i.push((f=h,l=e,v=y=d=p=void 0,(c=a)instanceof hs?(v={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}},f&&(v.fields.__previous_value__=f),{mapValue:v}):c instanceof cs?ps(c,f):c instanceof ys?gs(c,f):(d=ss(p=c,f),y=Is(d)+Is(p.Be),xo(d)&&xo(p.Be)?Co(y):Vo(p.serializer,y))))}var c,f,l,p,d,y,v;return i}(t.fieldTransforms,n,e,r),s=Ws(t,i.data(),o);return new au(t.key,i.version,s,{Ge:!0})}(t,e,r,n):(o=e,Ds((i=t).Ue,o)?new hu(i.key,Qr.min()):o);var i,o}function ks(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ue.isEqual(e.Ue)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Le.isEqual(e.Le):2!==t.type||Cr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof cs&&o instanceof cs||i instanceof ys&&o instanceof ys?Cr(i.elements,o.elements,mo):i instanceof ws&&o instanceof ws?mo(i.Be,o.Be):i instanceof hs&&o instanceof hs);var n,r,i,o}))}function Ls(t){return t instanceof au?t.version:Qr.min()}var Cs,Vs,Us=(n(Fs,Vs=Ps),Fs),js=(n(Ms,Cs=Ps),Ms);function Ms(t,e,n,r){var i=this;return(i=Cs.call(this)||this).key=t,i.data=e,i.Le=n,i.Ue=r,i.type=1,i}function Fs(t,e,n){var r=this;return(r=Vs.call(this)||this).key=t,r.value=e,r.Ue=n,r.type=0,r}function qs(t,e){return n=t,r=e instanceof au?e.data():Js.empty(),i=new $s(r),n.Le.fields.forEach(function(t){if(!t._()){var e=n.data.field(t);null!==e?i.set(t,e):i.delete(t)}}),i.ze();var n,r,i}var Bs,Gs=(n(zs,Bs=Ps),zs);function zs(t,e){var n=this;return(n=Bs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ue=xs.exists(!0),n}function Hs(t,e){return e}function Ws(t,e,n){for(var r=new $s(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.ze()}var Ys,Xs,Ks=(n(nu,Xs=Ps),nu),Qs=(n(eu,Ys=Ps),eu),Js=(tu.empty=function(){return new tu({mapValue:{}})},tu.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ro(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},tu.prototype.isEqual=function(t){return mo(this.proto,t.proto)},tu),$s=(Zs.prototype.set=function(t,e){return this.Je(t,e),this},Zs.prototype.delete=function(t){return this.Je(t,null),this},Zs.prototype.Je=function(t,e){for(var n=this.Ye,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map||(o=o&&10===go(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),n=o}n.set(t.S(),e)},Zs.prototype.ze=function(){var t=this.Xe(ti.k(),this.Ye);return null!=t?new Js(t):this.He},Zs.prototype.Xe=function(r,t){var i=this,o=!1,e=this.He.field(r),s=Ro(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){if(t instanceof Map){var n=i.Xe(r.child(e),t);null!=n&&(s[e]=n,o=!0)}else null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Zs);function Zs(t){void 0===t&&(t=Js.empty()),this.He=t,this.Ye=new Map}function tu(t){this.proto=t}function eu(t,e){var n=this;return(n=Ys.call(this)||this).key=t,n.Ue=e,n.type=4,n}function nu(t,e){var n=this;return(n=Xs.call(this)||this).key=t,n.Ue=e,n.type=3,n}function ru(t){var u=[];return qr(t.fields||{},function(t,e){var n=new ti([t]);if(Ro(e)){var r=ru(e.mapValue).fields;if(0===r.length)u.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];u.push(n.child(s))}}else u.push(n)}),new _s(u)}function iu(t,e){this.key=t,this.version=e}var ou,su,uu,au=(n(yu,uu=iu),yu.prototype.field=function(t){return this.Ze.field(t)},yu.prototype.data=function(){return this.Ze},yu.prototype.tn=function(){return this.Ze.proto},yu.prototype.isEqual=function(t){return t instanceof yu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ze.isEqual(t.Ze)},yu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ze.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(yu.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),yu),hu=(n(du,su=iu),du.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(du.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),du.prototype.isEqual=function(t){return t instanceof du&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},du),cu=(n(pu,ou=iu),pu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(pu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),pu.prototype.isEqual=function(t){return t instanceof pu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},pu),fu=(lu.hn=function(t){return new lu(t)},Object.defineProperty(lu.prototype,"orderBy",{get:function(){if(null===this.sn){this.sn=[];var t=this.an(),e=this.un();if(null!==t&&null===e)t.O()||this.sn.push(new Gu(t)),this.sn.push(new Gu(ti.L(),"asc"));else{for(var n=!1,r=0,i=this.en;r<i.length;r++){var o=i[r];this.sn.push(o),o.field.O()&&(n=!0)}if(!n){var s=0<this.en.length?this.en[this.en.length-1].dir:"asc";this.sn.push(new Gu(ti.L(),s))}}}return this.sn},enumerable:!1,configurable:!0}),lu.prototype.cn=function(t){var e=this.filters.concat([t]);return new lu(this.path,this.collectionGroup,this.en.slice(),e,this.limit,this.nn,this.startAt,this.endAt)},lu.prototype.ln=function(t){var e=this.en.concat([t]);return new lu(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.nn,this.startAt,this.endAt)},lu.prototype._n=function(t){return new lu(this.path,this.collectionGroup,this.en.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},lu.prototype.fn=function(t){return new lu(this.path,this.collectionGroup,this.en.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},lu.prototype.dn=function(t){return new lu(this.path,this.collectionGroup,this.en.slice(),this.filters.slice(),this.limit,this.nn,t,this.endAt)},lu.prototype.wn=function(t){return new lu(this.path,this.collectionGroup,this.en.slice(),this.filters.slice(),this.limit,this.nn,this.startAt,t)},lu.prototype.Tn=function(t){return new lu(t,null,this.en.slice(),this.filters.slice(),this.limit,this.nn,this.startAt,this.endAt)},lu.prototype.En=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.en.length||1===this.en.length&&this.en[0].field.O())},lu.prototype.In=function(){return!ci(this.limit)&&"F"===this.nn},lu.prototype.mn=function(){return!ci(this.limit)&&"L"===this.nn},lu.prototype.un=function(){return 0<this.en.length?this.en[0].field:null},lu.prototype.an=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Eu&&n.An())return n.field}return null},lu.prototype.Rn=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof Eu&&0<=t.indexOf(r.op))return r.op}return null},lu.prototype.Pn=function(){return gi(this.We())},lu.prototype.Vn=function(){return null!==this.collectionGroup},lu.prototype.We=function(){if(!this.rn)if("F"===this.nn)this.rn=di(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i="desc"===r.dir?"asc":"desc";t.push(new Gu(r.field,i))}var o=this.endAt?new Lu(this.endAt.position,!this.endAt.before):null,s=this.startAt?new Lu(this.startAt.position,!this.startAt.before):null;this.rn=di(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.rn},lu.prototype.on=function(t){},lu);function lu(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.en=n,this.filters=r,this.limit=i,this.nn=o,this.startAt=s,this.endAt=u,this.sn=null,this.rn=null,this.startAt&&this.on(this.startAt),this.endAt&&this.on(this.endAt)}function pu(){return null!==ou&&ou.apply(this,arguments)||this}function du(t,e,n){var r=this;return(r=su.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function yu(t,e,n,r){var i=this;return(i=uu.call(this,t,e)||this).Ze=n,i.Ge=!!r.Ge,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function vu(t,e){return vi(t.We(),e.We())&&t.nn===e.nn}function gu(t){return yi(t.We())+"|lt:"+t.nn}function mu(t){return"Query(target="+(e=t.We(),n=e.path.N(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.N()+" "+e.op+" "+Eo(e.value);var e}).join(", ")+"]"),ci(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.N()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Fu(e.startAt)),e.endAt&&(n+=", endAt: "+Fu(e.endAt)),"Target("+n+")")+"; limitType="+t.nn+")";var e,n}function wu(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.U(r.collectionGroup)&&r.path.D(o):ei.W(r.path)?r.path.isEqual(o):r.path.C(o))&&function(t){for(var e=0,n=i.en;e<n.length;e++){var r=n[e];if(!r.field.O()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||qu(e.startAt,e.orderBy,n))&&(!e.endAt||!qu(e.endAt,e.orderBy,n)));var e,n,r,o}function bu(u){return function(t,e){for(var n=!1,r=0,i=u.orderBy;r<i.length;r++){var o=i[r],s=zu(o,t,e);if(0!==s)return s;n=n||o.field.O()}return 0}}var Iu,Eu=(n(_u,Iu=function(){}),_u.create=function(t,e,n){if(t.O())return"in"===e?new Pu(t,n):new Du(t,e,n);if(Do(n)){if("=="!==e)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new _u(t,e,n)}if(Po(n)){if("=="!==e)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new _u(t,e,n)}return"array-contains"===e?new Ru(t,n):"in"===e?new Ou(t,n):"array-contains-any"===e?new ku(t,n):new _u(t,e,n)},_u.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&go(this.value)===go(e)&&this.gn(bo(e,this.value))},_u.prototype.gn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Sr()}},_u.prototype.An=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},_u);function _u(t,e,n){var r=this;return(r=Iu.call(this)||this).field=t,r.op=e,r.value=n,r}var Tu,Nu,Au,xu,Su,Du=(n(Mu,Su=Eu),Mu.prototype.matches=function(t){var e=ei.P(t.key,this.key);return this.gn(e)},Mu),Pu=(n(ju,xu=Eu),ju.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},ju),Ru=(n(Uu,Au=Eu),Uu.prototype.matches=function(t){var e=t.field(this.field);return So(e)&&wo(e.arrayValue,this.value)},Uu),Ou=(n(Vu,Nu=Eu),Vu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&wo(this.value.arrayValue,e)},Vu),ku=(n(Cu,Tu=Eu),Cu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!So(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return wo(e.value.arrayValue,t)})},Cu),Lu=function(t,e){this.position=t,this.before=e};function Cu(t,e){return Tu.call(this,t,"array-contains-any",e)||this}function Vu(t,e){return Nu.call(this,t,"in",e)||this}function Uu(t,e){return Au.call(this,t,"array-contains",e)||this}function ju(t,e){var n=this;return(n=xu.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return ei.q(t.referenceValue)}),n}function Mu(t,e,n){var r=this;return(r=Su.call(this,t,e,n)||this).key=ei.q(n.referenceValue),r}function Fu(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return Eo(t)}).join(",")}function qu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.O()?ei.P(ei.q(s.referenceValue),n.key):bo(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Bu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!mo(t.position[n],e.position[n]))return!1;return!0}var Gu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function zu(t,e,n){var r,i,o,s,u=t.field.O()?ei.P(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?bo(o,s):Sr());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return Sr()}}var Hu=(ua.prototype.pn=function(t,e,n){for(var r=n.bn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Rs(o,e,r[i]))}return e},ua.prototype.vn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Os(i,e,e,this.yn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Os(a,e,o,this.yn))}return e},ua.prototype.Sn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.vn(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},ua.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Hi())},ua.prototype.isEqual=function(t){return this.batchId===t.batchId&&Cr(this.mutations,t.mutations,function(t,e){return ks(t,e)})&&Cr(this.baseMutations,t.baseMutations,function(t,e){return ks(t,e)})},ua),Wu=(sa.from=function(t,e,n){Dr(t.mutations.length===n.length);for(var r=Gi,i=t.mutations,o=0;o<i.length;o++)r=r.nt(i[o].key,n[o].version);return new sa(t,e,n,r)},sa),Yu=(oa.prototype.catch=function(t){return this.next(void 0,t)},oa.prototype.next=function(r,i){var o=this;return this.kn&&Sr(),this.kn=!0,this.$n?this.error?this.xn(i,this.error):this.Mn(r,this.result):new oa(function(e,n){o.Fn=function(t){o.Mn(r,t).next(e,n)},o.Nn=function(t){o.xn(i,t).next(e,n)}})},oa.prototype.On=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},oa.prototype.Ln=function(t){try{var e=t();return e instanceof oa?e:oa.resolve(e)}catch(t){return oa.reject(t)}},oa.prototype.Mn=function(t,e){return t?this.Ln(function(){return t(e)}):oa.resolve(e)},oa.prototype.xn=function(t,e){return t?this.Ln(function(){return t(e)}):oa.reject(e)},oa.resolve=function(n){return new oa(function(t,e){t(n)})},oa.reject=function(n){return new oa(function(t,e){e(n)})},oa.Bn=function(t){return new oa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},oa.qn=function(t){for(var n=oa.resolve(!1),e=function(e){n=n.next(function(t){return t?oa.resolve(t):e()})},r=0,i=t;r<i.length;r++)e(i[r]);return n},oa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Bn(i)},oa),Xu=(Object.defineProperty(ia.prototype,"readTime",{get:function(){return this.Wn},set:function(t){this.Wn=t},enumerable:!1,configurable:!0}),ia.prototype.jn=function(t,e){this.Kn(),this.readTime=e,this.Un.set(t.key,t)},ia.prototype.Gn=function(t,e){this.Kn(),e&&(this.readTime=e),this.Un.set(t,null)},ia.prototype.zn=function(t,e){this.Kn();var n=this.Un.get(e);return void 0!==n?Yu.resolve(n):this.Hn(t,e)},ia.prototype.getEntries=function(t,e){return this.Yn(t,e)},ia.prototype.apply=function(t){return this.Kn(),this.Qn=!0,this.Jn(t)},ia.prototype.Kn=function(){},ia),Ku="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Qu=(ra.prototype.Zn=function(t){this.Xn.push(t)},ra.prototype.ts=function(){this.Xn.forEach(function(t){return t()})},ra),Ju=(na.prototype.rs=function(e,n){var r=this;return this.ns.os(e,n).next(function(t){return r.hs(e,n,t)})},na.prototype.hs=function(t,r,i){return this.es.zn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].vn(r,t);return t})},na.prototype.as=function(t,e,i){var o=Fi();return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].vn(t,e);o=o.nt(t,e)}),o},na.prototype.us=function(e,t){var n=this;return this.es.getEntries(e,t).next(function(t){return n.cs(e,t)})},na.prototype.cs=function(r,i){var o=this;return this.ns.ls(r,i).next(function(t){var e=o.as(r,i,t),n=Mi();return e.forEach(function(t,e){e=e||new hu(t,Qr.min()),n=n.nt(t,e)}),n})},na.prototype._s=function(t,e,n){return e.Pn()?this.fs(t,e.path):e.Vn()?this.ds(t,e,n):this.ws(t,e,n)},na.prototype.fs=function(t,e){return this.rs(t,new ei(e)).next(function(t){var e=Bi();return t instanceof au&&(e=e.nt(t.key,t)),e})},na.prototype.ds=function(n,r,i){var o=this,s=r.collectionGroup,u=Bi();return this.ss.Ts(n,s).next(function(t){return Yu.forEach(t,function(t){var e=r.Tn(t.child(s));return o.ws(n,e,i).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},na.prototype.ws=function(e,n,t){var c,f,r=this;return this.es._s(e,n,t).next(function(t){return c=t,r.ns.Es(e,n)}).next(function(t){return f=t,r.Is(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=Os(s,a,a,r.yn);c=h instanceof au?c.nt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){wu(n,e)||(c=c.remove(t))}),c})},na.prototype.Is=function(t,e,n){for(var r=Hi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof js&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.es.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof au&&(h=h.nt(t,e))}),h})},na),$u=(ea.Rs=function(t,e){for(var n=Hi(),r=Hi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ea(t,e.fromCache,n,r)},ea),Zu=(ta.prototype.Vs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ta.prototype.next=function(){var t=++this.previousValue;return this.gs&&this.gs(t),t},ta);function ta(t,e){var n=this;this.previousValue=t,e&&(e.Ps=function(t){return n.Vs(t)},this.gs=function(t){return e.ys(t)})}function ea(t,e,n,r){this.targetId=t,this.fromCache=e,this.ms=n,this.As=r}function na(t,e,n){this.es=t,this.ns=e,this.ss=n}function ra(){this.Xn=[]}function ia(){this.Un=new Wr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Qn=!1}function oa(t){var e=this;this.Fn=null,this.Nn=null,this.result=void 0,this.error=void 0,this.$n=!1,this.kn=!1,t(function(t){e.$n=!0,e.result=t,e.Fn&&e.Fn(t)},function(t){e.$n=!0,e.error=t,e.Nn&&e.Nn(t)})}function sa(t,e,n,r){this.batch=t,this.Dn=e,this.bn=n,this.Cn=r}function ua(t,e,n,r){this.batchId=t,this.yn=e,this.baseMutations=n,this.mutations=r}Zu.ps=-1;function aa(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var ha=(ca.prototype.reset=function(){this.Fs=0},ca.prototype.ks=function(){this.Fs=this.Cs},ca.prototype.xs=function(t){var e=this;this.cancel();var n=Math.floor(this.Fs+this.Ms()),r=Math.max(0,Date.now()-this.$s),i=Math.max(0,n-r);0<i&&Nr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Fs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ns=this.bs.Os(this.vs,i,function(){return e.$s=Date.now(),t()}),this.Fs*=this.Ds,this.Fs<this.Ss&&(this.Fs=this.Ss),this.Fs>this.Cs&&(this.Fs=this.Cs)},ca.prototype.Ls=function(){null!==this.Ns&&(this.Ns.Bs(),this.Ns=null)},ca.prototype.cancel=function(){null!==this.Ns&&(this.Ns.cancel(),this.Ns=null)},ca.prototype.Ms=function(){return(Math.random()-.5)*this.Fs},ca);function ca(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.bs=t,this.vs=e,this.Ss=n,this.Ds=r,this.Cs=i,this.Fs=0,this.Ns=null,this.$s=Date.now(),this.reset()}function fa(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=pa(e)),e=la(t.get(n),e);return pa(e)}function la(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function pa(t){return t+""}function da(t){var e=t.length;if(Dr(2<=e),2===e)return Dr(""===t.charAt(0)&&""===t.charAt(1)),$r.k();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Sr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Sr()}o=s+2}return new $r(r)}var ya=(ba.prototype.Us=function(t,e){return this.qs.add(e),Yu.resolve()},ba.prototype.Ts=function(t,e){return Yu.resolve(this.qs.getEntries(e))},ba),va=(wa.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new Li($r.P),i=!r.has(n);return this.index[e]=r.add(n),i},wa.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},wa.prototype.getEntries=function(t){return(this.index[t]||new Li($r.P)).F()},wa),ga=(ma.prototype.Us=function(t,e){var n=this;if(this.Qs.has(e))return Yu.resolve();var r=e.S(),i=e.p();t.Zn(function(){n.Qs.add(e)});var o={collectionId:r,parent:fa(i)};return Ia(t).put(o)},ma.prototype.Ts=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Vr(i),""],!1,!0);return Ia(t).Ws(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(da(r.parent))}return o})},ma);function ma(){this.Qs=new va}function wa(){this.index={}}function ba(){this.qs=new va}function Ia(t){return Qa.js(t,xh.store)}function Ea(t){this.Ks=t}function _a(t,e){if(e.document)return n=t.Ks,r=e.document,i=!!e.hasCommittedMutations,o=zo(n,r.name),s=Fo(r.updateTime),u=new Js({mapValue:{fields:r.fields}}),new au(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=ei.j(e.noDocument.path),h=Sa(e.noDocument.readTime);return new hu(a,h,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var c=ei.j(e.unknownDocument.path),f=Sa(e.unknownDocument.version);return new cu(c,f)}return Sr()}function Ta(t,e,n){var r,i,o=Na(n),s=e.key.path.p().F();if(e instanceof au){var u={name:Go(r=t.Ks,(i=e).key),fields:i.tn().mapValue.fields,updateTime:jo(r,i.version.A())},a=e.hasCommittedMutations;return new Eh(null,null,u,a,o,s)}if(e instanceof hu){var h=e.key.path.F(),c=xa(e.version),f=e.hasCommittedMutations;return new Eh(null,new bh(h,c),null,f,o,s)}if(e instanceof cu){var l=e.key.path.F(),p=xa(e.version);return new Eh(new Ih(l,p),null,null,!0,o,s)}return Sr()}function Na(t){var e=t.A();return[e.seconds,e.nanoseconds]}function Aa(t){var e=new Kr(t[0],t[1]);return Qr.I(e)}function xa(t){var e=t.A();return new ph(e.seconds,e.nanoseconds)}function Sa(t){var e=new Kr(t.seconds,t.nanoseconds);return Qr.I(e)}function Da(e,t){var n=(t.baseMutations||[]).map(function(t){return Jo(e.Ks,t)}),r=t.mutations.map(function(t){return Jo(e.Ks,t)}),i=Kr.fromMillis(t.localWriteTimeMs);return new Hu(t.batchId,i,n,r)}function Pa(t){var e,n=Sa(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?Sa(t.lastLimboFreeSnapshotVersion):Qr.min();return e=(void 0!==t.query.documents?function(t){Dr(1===t.documents.length);var e=t.documents[0];return fu.hn(Wo(e)).We()}:function(t){var e=Wo(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(0<r){Dr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=function e(t){return t?void 0!==t.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=rs(t.unaryFilter.field);return Eu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=rs(t.unaryFilter.field);return Eu.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Sr()}}(t)]:void 0!==t.fieldFilter?[(n=t,Eu.create(rs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Sr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Sr():[];var n}(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(t){return new Gu(rs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,h,c=null;n.limit&&(a=n.limit,c=ci(h="object"==typeof a?a.value:a)?null:h);var f=null;n.startAt&&(f=es(n.startAt));var l=null;return n.endAt&&(l=es(n.endAt)),new fu(e,i,u,s,c,"F",f,l).We()})(t.query),new _i(e,t.targetId,0,t.lastListenSequenceNumber,n,r,mi.fromBase64String(t.resumeToken))}function Ra(t,e){var n,r=xa(e.X),i=xa(e.lastLimboFreeSnapshotVersion);n=(gi(e.target)?$o:Zo)(t.Ks,e.target);var o=e.resumeToken.toBase64();return new Th(e.targetId,yi(e.target),r,o,e.sequenceNumber,i,n)}var Oa,ka=(La.prototype.jn=function(t,e,n){return Va(t).put(Ua(e),n)},La.prototype.Gn=function(t,e){var n=Va(t),r=Ua(e);return n.delete(r)},La.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Gs(e,t)})},La.prototype.zn=function(t,e){var n=this;return Va(t).get(Ua(e)).next(function(t){return n.zs(t)})},La.prototype.Hs=function(t,e){var n=this;return Va(t).get(Ua(e)).next(function(t){var e=n.zs(t);return e?{Ys:e,size:ja(t)}:null})},La.prototype.getEntries=function(t,e){var r=this,i=Fi();return this.Js(t,e,function(t,e){var n=r.zs(e);i=i.nt(t,n)}).next(function(){return i})},La.prototype.Xs=function(t,e){var r=this,i=Fi(),o=new xi(ei.P);return this.Js(t,e,function(t,e){var n=r.zs(e);o=n?(i=i.nt(t,n),o.nt(t,ja(e))):(i=i.nt(t,null),o.nt(t,0))}).next(function(){return{Zs:i,ti:o}})},La.prototype.Js=function(t,e,i){if(e._())return Yu.resolve();var n=IDBKeyRange.bound(e.first().path.F(),e.last().path.F()),o=e.at(),s=o.dt();return Va(t).ei({range:n},function(t,e,n){for(var r=ei.j(t);s&&ei.P(s,r)<0;)i(s,null),s=o.dt();s&&s.isEqual(r)&&(i(s,e),s=o.wt()?o.dt():null),s?n.ni(s.path.F()):n.done()}).next(function(){for(;s;)i(s,null),s=o.wt()?o.dt():null})},La.prototype._s=function(t,i,e){var o=this,s=Bi(),u=i.path.length+1,n={};if(e.isEqual(Qr.min())){var r=i.path.F();n.range=IDBKeyRange.lowerBound(r)}else{var a=i.path.F(),h=Na(e);n.range=IDBKeyRange.lowerBound([a,h],!0),n.index=Eh.collectionReadTimeIndex}return Va(t).ei(n,function(t,e,n){if(t.length===u){var r=_a(o.serializer,e);i.path.D(r.key.path)?r instanceof au&&wu(i,r)&&(s=s.nt(r.key,r)):n.done()}}).next(function(){return s})},La.prototype.si=function(t,e){var r=this,i=Mi(),o=Na(e),n=Va(t),s=IDBKeyRange.lowerBound(o,!0);return n.ei({index:Eh.readTimeIndex,range:s},function(t,e){var n=_a(r.serializer,e);i=i.nt(n.key,n),o=e.readTime}).next(function(){return{ii:i,readTime:Aa(o)}})},La.prototype.ri=function(t){var e=Va(t),r=Qr.min();return e.ei({index:Eh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=Aa(e.readTime)),n.done()}).next(function(){return r})},La.prototype.oi=function(t){return new La.hi(this,!!t&&t.ai)},La.prototype.ui=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},La.prototype.getMetadata=function(t){return Ca(t).get(_h.key).next(function(t){return Dr(!!t),t})},La.prototype.Gs=function(t,e){return Ca(t).put(_h.key,e)},La.prototype.zs=function(t){if(t){var e=_a(this.serializer,t);return e instanceof hu&&e.version.isEqual(Qr.min())?null:e}return null},La);function La(t,e){this.serializer=t,this.ss=e}function Ca(t){return Qa.js(t,_h.store)}function Va(t){return Qa.js(t,Eh.store)}function Ua(t){return t.path.F()}function ja(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Sr();e=t.noDocument}return JSON.stringify(e).length}function Ma(t,e){var n=this;return(n=Oa.call(this)||this).ci=t,n.ai=e,n.li=new Wr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}ka.hi=(n(Ma,Oa=Xu),Ma.prototype.Jn=function(s){var u=this,a=[],h=0,c=new Li(function(t,e){return Lr(t.N(),e.N())});return this.Un.forEach(function(t,e){var n=u.li.get(t);if(e){var r=Ta(u.ci.serializer,e,u.readTime);c=c.add(t.path.p());var i=ja(r);h+=i-n,a.push(u.ci.jn(s,t,r))}else if(h-=n,u.ai){var o=Ta(u.ci.serializer,new hu(t,Qr.min()),u.readTime);a.push(u.ci.jn(s,t,o))}else a.push(u.ci.Gn(s,t))}),c.forEach(function(t){a.push(u.ci.ss.Us(s,t))}),a.push(this.ci.updateMetadata(s,h)),Yu.Bn(a)},Ma.prototype.Hn=function(t,e){var n=this;return this.ci.Hs(t,e).next(function(t){return null===t?(n.li.set(e,0),null):(n.li.set(e,t.size),t.Ys)})},Ma.prototype.Yn=function(t,e){var n=this;return this.ci.Xs(t,e).next(function(t){var e=t.Zs;return t.ti.forEach(function(t,e){n.li.set(t,e)}),e})},Ma);var Fa=(Ga.prototype.next=function(){return this._i+=2,this._i},Ga.fi=function(){return new Ga(0)},Ga.di=function(){return new Ga(-1)},Ga),qa=(Ba.prototype.Ti=function(n){var r=this;return this.Ei(n).next(function(t){var e=new Fa(t.highestTargetId);return t.highestTargetId=e.next(),r.Ii(n,t).next(function(){return t.highestTargetId})})},Ba.prototype.mi=function(t){return this.Ei(t).next(function(t){return Qr.I(new Kr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Ba.prototype.Ai=function(t){return this.Ei(t).next(function(t){return t.highestListenSequenceNumber})},Ba.prototype.Ri=function(e,n,r){var i=this;return this.Ei(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.A()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Ii(e,t)})},Ba.prototype.Pi=function(e,n){var r=this;return this.Vi(e,n).next(function(){return r.Ei(e).next(function(t){return t.targetCount+=1,r.gi(n,t),r.Ii(e,t)})})},Ba.prototype.yi=function(t,e){return this.Vi(t,e)},Ba.prototype.pi=function(e,t){var n=this;return this.bi(e,t.targetId).next(function(){return za(e).delete(t.targetId)}).next(function(){return n.Ei(e)}).next(function(t){return Dr(0<t.targetCount),--t.targetCount,n.Ii(e,t)})},Ba.prototype.vi=function(r,i,o){var s=this,u=0,a=[];return za(r).ei(function(t,e){var n=Pa(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s.pi(r,n)))}).next(function(){return Yu.Bn(a)}).next(function(){return u})},Ba.prototype.pe=function(t,r){return za(t).ei(function(t,e){var n=Pa(e);r(n)})},Ba.prototype.Ei=function(t){return Ha(t).get(Ah.key).next(function(t){return Dr(null!==t),t})},Ba.prototype.Ii=function(t,e){return Ha(t).put(Ah.key,e)},Ba.prototype.Vi=function(t,e){return za(t).put(Ra(this.serializer,e))},Ba.prototype.gi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Ba.prototype.Si=function(t){return this.Ei(t).next(function(t){return t.targetCount})},Ba.prototype.Di=function(t,i){var e=yi(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return za(t).ei({range:n,index:Th.queryTargetsIndexName},function(t,e,n){var r=Pa(e);vi(i,r.target)&&(o=r,n.done())}).next(function(){return o})},Ba.prototype.Ci=function(n,t,r){var i=this,o=[],s=Wa(n);return t.forEach(function(t){var e=fa(t.path);o.push(s.put(new Nh(r,e))),o.push(i.wi.Fi(n,r,t))}),Yu.Bn(o)},Ba.prototype.Ni=function(n,t,r){var i=this,o=Wa(n);return Yu.forEach(t,function(t){var e=fa(t.path);return Yu.Bn([o.delete([r,e]),i.wi.$i(n,r,t)])})},Ba.prototype.bi=function(t,e){var n=Wa(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},Ba.prototype.ki=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Wa(t),o=Hi();return r.ei({range:n,xi:!0},function(t,e,n){var r=da(t[1]),i=new ei(r);o=o.add(i)}).next(function(){return o})},Ba.prototype.Mi=function(t,e){var n=fa(e.path),r=IDBKeyRange.bound([n],[Vr(n)],!1,!0),i=0;return Wa(t).ei({index:Nh.documentTargetsIndex,xi:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Ba.prototype.Me=function(t,e){return za(t).get(e).next(function(t){return t?Pa(t):null})},Ba);function Ba(t,e){this.wi=t,this.serializer=e}function Ga(t){this._i=t}function za(t){return Qa.js(t,Th.store)}function Ha(t){return Qa.js(t,Ah.store)}function Wa(t){return Qa.js(t,Nh.store)}var Ya,Xa="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ka=(n($a,Ya=Qu),$a),Qa=(Ja.js=function(t,e){if(t instanceof Ka)return Oh.js(t.Oi,e);throw Sr()},Ja.prototype.start=function(){var e=this;return Oh.tr(this.Yi,fh,new lh(this.serializer)).then(function(t){return e.er=t,e.nr()}).then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Xr(Yr.FAILED_PRECONDITION,Xa);return e.sr(),e.ir(),e.rr(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Xi.Ai(t)})}).then(function(t){e.Ui=new Zu(t,e.Bi)}).then(function(){e.Qi=!0}).catch(function(t){return e.er&&e.er.close(),Promise.reject(t)})},Ja.prototype.or=function(n){var t=this;return this.zi=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.hr?[2,n(e)]:[2]})})},n(this.isPrimary)},Ja.prototype.ar=function(n){var t=this;this.er.ur(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Ja.prototype.cr=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.bs.lr(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.hr?[4,this.nr()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Ja.prototype.nr=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return th(e).put(new Dh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n._r(e).next(function(t){t||(n.isPrimary=!1,n.bs.dr(function(){return n.zi(!1)}))})}).next(function(){return n.wr(e)}).next(function(t){return n.isPrimary&&!t?n.Tr(e).next(function(){return!1}):!!t&&n.Er(e).next(function(){return!0})})}).catch(function(t){if(jh(t))return Nr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Nr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.bs.dr(function(){return n.zi(t)}),n.isPrimary=t})},Ja.prototype._r=function(t){var e=this;return Za(t).get(dh.key).next(function(t){return Yu.resolve(e.Ir(t))})},Ja.prototype.mr=function(t){return th(t).delete(this.clientId)},Ja.prototype.Ar=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Rr(this.Gi,18e5)?[3,2]:(this.Gi=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Ja.js(t,Dh.store);return r.Ws().next(function(t){var e=o.Pr(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Yu.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Zi)for(n=0,r=e;n<r.length;n++)i=r[n],this.Zi.removeItem(this.Vr(i.clientId));t.label=2;case 2:return[2]}})})},Ja.prototype.rr=function(){var t=this;this.Ki=this.bs.Os("client_metadata_refresh",4e3,function(){return t.nr().then(function(){return t.Ar()}).then(function(){return t.rr()})})},Ja.prototype.Ir=function(t){return!!t&&t.ownerId===this.clientId},Ja.prototype.wr=function(e){var i=this;return this.qi?Yu.resolve(!0):Za(e).get(dh.key).next(function(t){if(null!==t&&i.Rr(t.leaseTimestampMs,5e3)&&!i.gr(t.ownerId)){if(i.Ir(t)&&i.networkEnabled)return!0;if(!i.Ir(t)){if(!t.allowTabSynchronization)throw new Xr(Yr.FAILED_PRECONDITION,Xa);return!1}}return!(!i.networkEnabled||!i.inForeground)||th(e).Ws().next(function(t){return void 0===i.Pr(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&Nr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Ja.prototype.yr=function(){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Qi=!1,this.pr(),this.Ki&&(this.Ki.cancel(),this.Ki=null),this.br(),this.vr(),[4,this.runTransaction("shutdown","readwrite",function(t){return e.Tr(t).next(function(){return e.mr(t)})}).catch(function(t){Nr("IndexedDbPersistence","Proceeding with shutdown despite failure: ",t)})];case 1:return t.sent(),this.er.close(),this.Sr(),[2]}})})},Ja.prototype.Pr=function(t,e){var n=this;return t.filter(function(t){return n.Rr(t.updateTimeMs,e)&&!n.gr(t.clientId)})},Ja.prototype.Dr=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return th(t).Ws().next(function(t){return e.Pr(t,18e5).map(function(t){return t.clientId})})})},Ja.clearPersistence=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return Ja.Hi()?(e=n+Ja.Ji,[4,Oh.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})},Object.defineProperty(Ja.prototype,"hr",{get:function(){return this.Qi},enumerable:!1,configurable:!0}),Ja.prototype.Cr=function(t){return ih.Fr(t,this.serializer,this.ss,this.wi)},Ja.prototype.Nr=function(){return this.Xi},Ja.prototype.$r=function(){return this.es},Ja.prototype.kr=function(){return this.ss},Ja.prototype.runTransaction=function(e,n,r){var i=this;Nr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.er.runTransaction(t,Rh,function(t){return o=new Ka(t,i.Ui?i.Ui.next():Zu.ps),"readwrite-primary"===n?i._r(o).next(function(t){return!!t||i.wr(o)}).next(function(t){if(!t)throw Ar("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.bs.dr(function(){return i.zi(!1)}),new Xr(Yr.FAILED_PRECONDITION,Ku);return r(o)}).next(function(t){return i.Er(o).next(function(){return t})}):i.xr(o).next(function(){return r(o)})}).then(function(t){return o.ts(),t})},Ja.prototype.xr=function(t){var e=this;return Za(t).get(dh.key).next(function(t){if(null!==t&&e.Rr(t.leaseTimestampMs,5e3)&&!e.gr(t.ownerId)&&!e.Ir(t)&&!(e.qi||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Xr(Yr.FAILED_PRECONDITION,Xa)})},Ja.prototype.Er=function(t){var e=new dh(this.clientId,this.allowTabSynchronization,Date.now());return Za(t).put(dh.key,e)},Ja.Hi=function(){return Oh.Hi()},Ja.Mr=function(t){var e=t.s.projectId;return t.s.i||(e+="."+t.s.database),"firestore/"+t.persistenceKey+"/"+e+"/"},Ja.prototype.Tr=function(t){var e=this,n=Za(t);return n.get(dh.key).next(function(t){return e.Ir(t)?(Nr("IndexedDbPersistence","Releasing primary lease."),n.delete(dh.key)):Yu.resolve()})},Ja.prototype.Rr=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Ar("Detected an update time that is in the future: "+t+" > "+n),1))},Ja.prototype.sr=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ji=function(){t.bs.lr(function(){return t.inForeground="visible"===t.document.visibilityState,t.nr()})},this.document.addEventListener("visibilitychange",this.ji),this.inForeground="visible"===this.document.visibilityState)},Ja.prototype.br=function(){this.ji&&(this.document.removeEventListener("visibilitychange",this.ji),this.ji=null)},Ja.prototype.ir=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Wi=function(){e.pr(),e.bs.lr(function(){return e.yr()})},this.window.addEventListener("unload",this.Wi))},Ja.prototype.vr=function(){this.Wi&&(this.window.removeEventListener("unload",this.Wi),this.Wi=null)},Ja.prototype.gr=function(t){var e;try{var n=null!==(null===(e=this.Zi)||void 0===e?void 0:e.getItem(this.Vr(t)));return Nr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Ar("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Ja.prototype.pr=function(){if(this.Zi)try{this.Zi.setItem(this.Vr(this.clientId),String(Date.now()))}catch(t){Ar("Failed to set zombie client id.",t)}},Ja.prototype.Sr=function(){if(this.Zi)try{this.Zi.removeItem(this.Vr(this.clientId))}catch(t){}},Ja.prototype.Vr=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Ja);function Ja(t,e,n,r,i,o,s,u,a,h){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.bs=i,this.window=o,this.document=s,this.Bi=a,this.qi=h,this.Ui=null,this.Qi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Wi=null,this.inForeground=!1,this.ji=null,this.Ki=null,this.Gi=Number.NEGATIVE_INFINITY,this.zi=function(t){return Promise.resolve()},!Ja.Hi())throw new Xr(Yr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.wi=new eh(this,r),this.Yi=e+Ja.Ji,this.serializer=new Ea(u),this.Xi=new qa(this.wi,this.serializer),this.ss=new ga,this.es=new ka(this.serializer,this.ss),this.window&&this.window.localStorage?this.Zi=this.window.localStorage:(this.Zi=null,!1===h&&Ar("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function $a(t,e){var n=this;return(n=Ya.call(this)||this).Oi=t,n.Li=e,n}function Za(t){return Qa.js(t,dh.store)}function th(t){return Qa.js(t,Dh.store)}Qa.Ji="main";var eh=(nh.prototype.Lr=function(t){var n=this.Br(t);return this.db.Nr().Si(t).next(function(e){return n.next(function(t){return e+t})})},nh.prototype.Br=function(t){var e=0;return this.qr(t,function(t){e++}).next(function(){return e})},nh.prototype.pe=function(t,e){return this.db.Nr().pe(t,e)},nh.prototype.qr=function(t,n){return this.Ur(t,function(t,e){return n(e)})},nh.prototype.Fi=function(t,e,n){return rh(t,n)},nh.prototype.$i=function(t,e,n){return rh(t,n)},nh.prototype.vi=function(t,e,n){return this.db.Nr().vi(t,e,n)},nh.prototype.Qr=function(t,e){return rh(t,e)},nh.prototype.Wr=function(t,e){return r=e,i=!1,ch(n=t).jr(function(t){return sh(n,t,r).next(function(t){return t&&(i=!0),Yu.resolve(!t)})}).next(function(){return i});var n,r,i},nh.prototype.Kr=function(r,i){var o=this,s=this.db.$r().oi(),u=[],a=0;return this.Ur(r,function(e,t){if(t<=i){var n=o.Wr(r,e).next(function(t){if(!t)return a++,s.zn(r,e).next(function(){return s.Gn(e),Wa(r).delete([0,fa(e.path)])})});u.push(n)}}).next(function(){return Yu.Bn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},nh.prototype.removeTarget=function(t,e){var n=e.Z(t.Li);return this.db.Nr().yi(t,n)},nh.prototype.Gr=function(t,e){return rh(t,e)},nh.prototype.Ur=function(t,o){var s,e=Wa(t),u=Zu.ps;return e.ei({index:Nh.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==Zu.ps&&o(new ei(da(s)),u),u=i,s=r):u=Zu.ps}).next(function(){u!==Zu.ps&&o(new ei(da(s)),u)})},nh.prototype.zr=function(t){return this.db.$r().ui(t)},nh);function nh(t,e){this.db=t,this.Or=new oc(this,e)}function rh(t,e){return Wa(t).put((n=e,r=t.Li,new Nh(0,fa(n.path),r)));var n,r}var ih=(oh.Fr=function(t,e,n,r){return Dr(""!==t.uid),new oh(t.Yr()?t.uid:"",e,n,r)},oh.prototype.Jr=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ah(t).ei({index:gh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},oh.prototype.Xr=function(h,c,f,l){var p=this,d=hh(h),y=ah(h);return y.add({}).next(function(t){Dr("number"==typeof t);for(var e=new Hu(t,c,f,l),n=function(e,t,n){var r=n.baseMutations.map(function(t){return Qo(e.Ks,t)}),i=n.mutations.map(function(t){return Qo(e.Ks,t)});return new gh(t,n.batchId,n.yn.toMillis(),r,i)}(p.serializer,p.userId,e),r=[],i=new Li(function(t,e){return Lr(t.N(),e.N())}),o=0,s=l;o<s.length;o++){var u=s[o],a=mh.key(p.userId,u.key.path,t);i=i.add(u.key.path.p()),r.push(y.put(n)),r.push(d.put(a,mh.PLACEHOLDER))}return i.forEach(function(t){r.push(p.ss.Us(h,t))}),h.Zn(function(){p.Hr[t]=e.keys()}),Yu.Bn(r).next(function(){return e})})},oh.prototype.Zr=function(t,e){var n=this;return ah(t).get(e).next(function(t){return t?(Dr(t.userId===n.userId),Da(n.serializer,t)):null})},oh.prototype.to=function(t,n){var r=this;return this.Hr[n]?Yu.resolve(this.Hr[n]):this.Zr(t,n).next(function(t){if(t){var e=t.keys();return r.Hr[n]=e}return null})},oh.prototype.eo=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return ah(t).ei({index:gh.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Dr(e.batchId>=i),o=Da(r.serializer,e)),n.done()}).next(function(){return o})},oh.prototype.no=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return ah(t).ei({index:gh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},oh.prototype.so=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ah(t).Ws(gh.userMutationsIndex,n).next(function(t){return t.map(function(t){return Da(e.serializer,t)})})},oh.prototype.os=function(u,a){var h=this,t=mh.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),c=[];return hh(u).ei({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=da(i);if(r===h.userId&&a.path.isEqual(s))return ah(u).get(o).next(function(t){if(!t)throw Sr();Dr(t.userId===h.userId),c.push(Da(h.serializer,t))});n.done()}).next(function(){return c})},oh.prototype.ls=function(r,t){var a=this,h=new Li(Lr),i=[];return t.forEach(function(u){var t=mh.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=hh(r).ei({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=da(i);r===a.userId&&u.path.isEqual(s)?h=h.add(o):n.done()});i.push(n)}),Yu.Bn(i).next(function(){return a.io(r,h)})},oh.prototype.Es=function(t,e){var u=this,a=e.path,h=a.length+1,n=mh.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),c=new Li(Lr);return hh(t).ei({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=da(i);r===u.userId&&a.D(s)?s.length===h&&(c=c.add(o)):n.done()}).next(function(){return u.io(t,c)})},oh.prototype.io=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(ah(e).get(t).next(function(t){if(null===t)throw Sr();Dr(t.userId===n.userId),r.push(Da(n.serializer,t))}))}),Yu.Bn(i).next(function(){return r})},oh.prototype.ro=function(e,n){var r=this;return uh(e.Oi,this.userId,n).next(function(t){return e.Zn(function(){r.oo(n.batchId)}),Yu.forEach(t,function(t){return r.wi.Qr(e,t)})})},oh.prototype.oo=function(t){delete this.Hr[t]},oh.prototype.ho=function(n){var o=this;return this.Jr(n).next(function(t){if(!t)return Yu.resolve();var e=IDBKeyRange.lowerBound(mh.prefixForUser(o.userId)),i=[];return hh(n).ei({range:e},function(t,e,n){if(t[0]===o.userId){var r=da(t[1]);i.push(r)}else n.done()}).next(function(){Dr(0===i.length)})})},oh.prototype.Mi=function(t,e){return sh(t,this.userId,e)},oh.prototype.ao=function(t){var e=this;return ch(t).get(this.userId).next(function(t){return t||new vh(e.userId,-1,"")})},oh);function oh(t,e,n,r){this.userId=t,this.serializer=e,this.ss=n,this.wi=r,this.Hr={}}function sh(t,o,e){var n=mh.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return hh(t).ei({range:r,xi:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function uh(t,e,n){var r=t.store(gh.store),i=t.store(mh.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.ei({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Dr(1===u)}));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=mh.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return Yu.Bn(o).next(function(){return h})}function ah(t){return Qa.js(t,gh.store)}function hh(t){return Qa.js(t,mh.store)}function ch(t){return Qa.js(t,vh.store)}var fh=10,lh=(yh.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Dr(t<e&&0<=t&&e<=fh);var o,s=new Mh(r);t<1&&1<=e&&(n.createObjectStore(dh.store),(o=n).createObjectStore(vh.store,{keyPath:vh.keyPath}),o.createObjectStore(gh.store,{keyPath:gh.keyPath,autoIncrement:!0}).createIndex(gh.userMutationsIndex,gh.userMutationsKeyPath,{unique:!0}),o.createObjectStore(mh.store),Sh(n),n.createObjectStore(Eh.store));var u,a=Yu.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(Nh.store),u.deleteObjectStore(Th.store),u.deleteObjectStore(Ah.store),Sh(n)),a=a.next(function(){return t=s.store(Ah.store),e=new Ah(0,0,Qr.min().A(),0),t.put(Ah.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(gh.store).Ws().next(function(t){r.deleteObjectStore(gh.store),r.createObjectStore(gh.store,{keyPath:gh.keyPath,autoIncrement:!0}).createIndex(gh.userMutationsIndex,gh.userMutationsKeyPath,{unique:!0});var e=i.store(gh.store),n=t.map(function(t){return e.put(t)});return Yu.Bn(n)});var r,i})),a=a.next(function(){n.createObjectStore(Dh.store,{keyPath:Dh.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(_h.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(Eh.store)).createIndex(Eh.readTimeIndex,Eh.readTimeIndexPath,{unique:!1}),t.createIndex(Eh.collectionReadTimeIndex,Eh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},yh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Eh.store).ei(function(t,e){n+=ja(e)}).next(function(){var t=new _h(n);return e.store(_h.store).put(_h.key,t)})},yh.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(vh.store),e=r.store(gh.store);return t.Ws().next(function(t){return Yu.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.Ws(gh.userMutationsIndex,t).next(function(t){return Yu.forEach(t,function(t){Dr(t.userId===n.userId);var e=Da(i.serializer,t);return uh(r,n.userId,e).next(function(){})})})})})},yh.prototype.ensureSequenceNumbers=function(t){var s=t.store(Nh.store),e=t.store(Eh.store);return t.store(Ah.store).get(Ah.key).next(function(i){var o=[];return e.ei(function(t,e){var n=new $r(t),r=[0,fa(n)];o.push(s.get(r).next(function(t){return t?Yu.resolve():(e=n,s.put(new Nh(0,fa(e),i.highestListenSequenceNumber)));var e}))}).next(function(){return Yu.Bn(o)})})},yh.prototype.createCollectionParentIndex=function(t,e){function i(t){if(o.add(t)){var e=t.S(),n=t.p();return r.put({collectionId:e,parent:fa(n)})}}t.createObjectStore(xh.store,{keyPath:xh.keyPath});var r=e.store(xh.store),o=new va;return e.store(Eh.store).ei({xi:!0},function(t,e){var n=new $r(t);return i(n.p())}).next(function(){return e.store(mh.store).ei({xi:!0},function(t,e){t[0];var n=t[1],r=(t[2],da(n));return i(r.p())})})},yh.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Th.store);return o.ei(function(t,e){var n=Pa(e),r=Ra(i.serializer,n);return o.put(r)})},yh),ph=function(t,e){this.seconds=t,this.nanoseconds=e},dh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function yh(t){this.serializer=t}dh.store="owner",dh.key="owner";var vh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};vh.store="mutationQueues",vh.keyPath="userId";var gh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};gh.store="mutations",gh.keyPath="batchId",gh.userMutationsIndex="userMutationsIndex",gh.userMutationsKeyPath=["userId","batchId"];var mh=(wh.prefixForUser=function(t){return[t]},wh.prefixForPath=function(t,e){return[t,fa(e)]},wh.key=function(t,e,n){return[t,fa(e),n]},wh);function wh(){}mh.store="documentMutations",mh.PLACEHOLDER=new mh;var bh=function(t,e){this.path=t,this.readTime=e},Ih=function(t,e){this.path=t,this.version=e},Eh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Eh.store="remoteDocuments",Eh.readTimeIndex="readTimeIndex",Eh.readTimeIndexPath="readTime",Eh.collectionReadTimeIndex="collectionReadTimeIndex",Eh.collectionReadTimeIndexPath=["parentPath","readTime"];var _h=function(t){this.byteSize=t};_h.store="remoteDocumentGlobal",_h.key="remoteDocumentGlobalKey";var Th=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Th.store="targets",Th.keyPath="targetId",Th.queryTargetsIndexName="queryTargetsIndex",Th.queryTargetsKeyPath=["canonicalId","targetId"];var Nh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Nh.store="targetDocuments",Nh.keyPath=["targetId","path"],Nh.documentTargetsIndex="documentTargetsIndex",Nh.documentTargetsKeyPath=["path","targetId"];var Ah=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Ah.key="targetGlobalKey",Ah.store="targetGlobal";var xh=function(t,e){this.collectionId=t,this.parent=e};function Sh(t){t.createObjectStore(Nh.store,{keyPath:Nh.keyPath}).createIndex(Nh.documentTargetsIndex,Nh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Th.store,{keyPath:Th.keyPath}).createIndex(Th.queryTargetsIndexName,Th.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ah.store)}xh.store="collectionParents",xh.keyPath=["collectionId","parent"];var Dh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Dh.store="clientMetadata",Dh.keyPath="clientId";var Ph,Rh=d(d(d([vh.store,gh.store,mh.store,Eh.store,Th.store,dh.store,Ah.store,Nh.store],[Dh.store]),[_h.store]),[xh.store]),Oh=(Uh.tr=function(o,t,s){return Nr("SimpleDb","Opening database:",o),new Yu(function(n,r){var i=indexedDB.open(o,t);i.onsuccess=function(t){var e=t.target.result;n(new Uh(e))},i.onblocked=function(){r(new Xr(Yr.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new Xr(Yr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(e)},i.onupgradeneeded=function(t){Nr("SimpleDb",'Database "'+o+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;s.createOrUpgrade(e,i.transaction,t.oldVersion,fh).next(function(){Nr("SimpleDb","Database upgrade to version "+fh+" complete")})}}).On()},Uh.delete=function(t){return Nr("SimpleDb","Removing database:",t),Gh(window.indexedDB.deleteDatabase(t)).On()},Uh.Hi=function(){if("undefined"==typeof indexedDB)return!1;if(Uh.co())return!0;var t=g(),e=Uh.uo(t),n=0<e&&e<10,r=Uh.lo(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},Uh.co=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t._o)},Uh.js=function(t,e){return t.store(e)},Uh.uo=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},Uh.lo=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},Uh.prototype.ur=function(e){this.db.onversionchange=function(t){return e(t)}},Uh.prototype.runTransaction=function(r,h,c){return y(this,void 0,void 0,function(){var s,u,e,a,n;return v(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:++u,e=Mh.open(a.db,s?"readonly":"readwrite",h),t.label=1;case 1:return t.trys.push([1,3,,4]),n=c(e).catch(function(t){return e.abort(t),Yu.reject(t)}).On(),r={},n.catch(function(){}),[4,e.fo];case 2:return[2,(r.value=(t.sent(),n),r)];case 3:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,Nr("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),o?[3,4]:[2,{value:Promise.reject(i)}];case 4:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Uh.prototype.close=function(){this.db.close()},Uh),kh=(Object.defineProperty(Vh.prototype,"$n",{get:function(){return this.wo},enumerable:!1,configurable:!0}),Object.defineProperty(Vh.prototype,"Eo",{get:function(){return this.To},enumerable:!1,configurable:!0}),Object.defineProperty(Vh.prototype,"cursor",{set:function(t){this.do=t},enumerable:!1,configurable:!0}),Vh.prototype.done=function(){this.wo=!0},Vh.prototype.ni=function(t){this.To=t},Vh.prototype.delete=function(){return Gh(this.do.delete())},Vh),Lh=(n(Ch,Ph=Xr),Ch);function Ch(t){var e=this;return(e=Ph.call(this,Yr.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function Vh(t){this.do=t,this.wo=!1,this.To=null}function Uh(t){this.db=t,12.2===Uh.uo(g())&&Ar("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function jh(t){return"IndexedDbTransactionError"===t.name}var Mh=(Bh.open=function(t,e,n){return new Bh(t.transaction(n,e))},Object.defineProperty(Bh.prototype,"fo",{get:function(){return this.Io.promise},enumerable:!1,configurable:!0}),Bh.prototype.abort=function(t){t&&this.Io.reject(t),this.aborted||(Nr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Bh.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Fh(e)},Bh),Fh=(qh.prototype.put=function(t,e){return Gh(void 0!==e?(Nr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Nr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},qh.prototype.add=function(t){return Nr("SimpleDb","ADD",this.store.name,t,t),Gh(this.store.add(t))},qh.prototype.get=function(e){var n=this;return Gh(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Nr("SimpleDb","GET",n.store.name,e,t),t})},qh.prototype.delete=function(t){return Nr("SimpleDb","DELETE",this.store.name,t),Gh(this.store.delete(t))},qh.prototype.count=function(){return Nr("SimpleDb","COUNT",this.store.name),Gh(this.store.count())},qh.prototype.Ws=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.mo(n,function(t,e){r.push(e)}).next(function(){return r})},qh.prototype.Ao=function(t,e){Nr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.xi=!1;var r=this.cursor(n);return this.mo(r,function(t,e,n){return n.delete()})},qh.prototype.ei=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.mo(r,e)},qh.prototype.jr=function(i){var t=this.cursor({});return new Yu(function(n,r){t.onerror=function(t){var e=Hh(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},qh.prototype.mo=function(t,s){var u=[];return new Yu(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e=t.target.result;if(e){var n=new kh(e),r=s(e.primaryKey,e.value,n);if(r instanceof Yu){var i=r.catch(function(t){return n.done(),Yu.reject(t)});u.push(i)}n.$n?o():null===n.Eo?e.continue():e.continue(n.Eo)}else o()}}).next(function(){return Yu.Bn(u)})},qh.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},qh.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.xi?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},qh);function qh(t){this.store=t}function Bh(t){var n=this;this.transaction=t,this.aborted=!1,this.Io=new aa,this.transaction.oncomplete=function(){n.Io.resolve()},this.transaction.onabort=function(){t.error?n.Io.reject(new Lh(t.error)):n.Io.resolve()},this.transaction.onerror=function(t){var e=Hh(t.target.error);n.Io.reject(new Lh(e))}}function Gh(t){return new Yu(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=Hh(t.target.error);r(e)}})}var zh=!1;function Hh(t){var e=Oh.uo(g());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new Xr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return zh||(zh=!0,setTimeout(function(){throw r},0)),r}}return t}function Wh(){return"undefined"!=typeof window?window:null}var Yh=(Qh.po=function(t,e,n,r,i){var o=new Qh(t,e,Date.now()+n,r,i);return o.start(n),o},Qh.prototype.start=function(t){var e=this;this.bo=setTimeout(function(){return e.vo()},t)},Qh.prototype.Bs=function(){return this.vo()},Qh.prototype.cancel=function(t){null!==this.bo&&(this.clearTimeout(),this.yo.reject(new Xr(Yr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Qh.prototype.vo=function(){var e=this;this.Ro.lr(function(){return null!==e.bo?(e.clearTimeout(),e.op().then(function(t){return e.yo.resolve(t)})):Promise.resolve()})},Qh.prototype.clearTimeout=function(){null!==this.bo&&(this.Vo(this),clearTimeout(this.bo),this.bo=null)},Qh),Xh=(Object.defineProperty(Kh.prototype,"Oo",{get:function(){return this.Co},enumerable:!1,configurable:!0}),Kh.prototype.lr=function(t){this.enqueue(t)},Kh.prototype.Lo=function(t){this.Bo(),this.qo(t)},Kh.prototype.Uo=function(t){return this.Bo(),this.qo(t)},Kh.prototype.Qo=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.Bo(),this.Co?[3,2]:(this.Co=!0,(e=Wh())&&e.removeEventListener("visibilitychange",this.Mo),[4,this.Uo(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Kh.prototype.enqueue=function(t){return this.Bo(),this.Co?new Promise(function(t){}):this.qo(t)},Kh.prototype.dr=function(t){var e=this;this.Do.push(t),this.lr(function(){return e.Wo()})},Kh.prototype.Wo=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Do.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Do[0]()];case 2:return t.sent(),this.Do.shift(),this.xo.reset(),[3,4];case 3:if(!jh(e=t.sent()))throw e;return Nr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Do.length&&this.xo.xs(function(){return n.Wo()}),t.label=5;case 5:return[2]}})})},Kh.prototype.qo=function(t){var r=this,e=this.So.then(function(){return r.$o=!0,t().catch(function(t){throw r.No=t,r.$o=!1,Ar("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.$o=!1,t})});return this.So=e},Kh.prototype.Os=function(t,e,n){var r=this;this.Bo(),-1<this.ko.indexOf(t)&&(e=0);var i=Yh.po(this,t,e,n,function(t){return r.jo(t)});return this.Fo.push(i),i},Kh.prototype.Bo=function(){this.No&&Sr()},Kh.prototype.Ko=function(){},Kh.prototype.Go=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.So];case 1:t.sent(),t.label=2;case 2:if(e!==this.So)return[3,0];t.label=3;case 3:return[2]}})})},Kh.prototype.zo=function(t){for(var e=0,n=this.Fo;e<n.length;e++)if(n[e].vs===t)return!0;return!1},Kh.prototype.Ho=function(r){var i=this;return this.Go().then(function(){i.Fo.sort(function(t,e){return t.Po-e.Po});for(var t=0,e=i.Fo;t<e.length;t++){var n=e[t];if(n.Bs(),"all"!==r&&n.vs===r)break}return i.Go()})},Kh.prototype.Yo=function(t){this.ko.push(t)},Kh.prototype.jo=function(t){var e=this.Fo.indexOf(t);this.Fo.splice(e,1)},Kh);function Kh(){var t=this;this.So=Promise.resolve(),this.Do=[],this.Co=!1,this.Fo=[],this.No=null,this.$o=!1,this.ko=[],this.xo=new ha(this,"async_queue_retry"),this.Mo=function(){return t.xo.Ls()};var e=Wh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Mo)}function Qh(t,e,n,r,i){this.Ro=t,this.vs=e,this.Po=n,this.op=r,this.Vo=i,this.yo=new aa,this.then=this.yo.promise.then.bind(this.yo.promise),this.yo.promise.catch(function(t){})}function Jh(t,e){if(Ar("AsyncQueue",e+": "+t),jh(t))return new Xr(Yr.UNAVAILABLE,e+": "+t);throw t}function $h(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Lr(n,i);return 0===s?Lr(r,o):s}var Zh=(rc.prototype.Zo=function(){return++this.Xo},rc.prototype.th=function(t){var e=[t,this.Zo()];if(this.buffer.size<this.Jo)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();$h(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(rc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),rc),tc={eh:!1,nh:0,sh:0,ih:0},ec=(nc.ah=function(t){return new nc(t,nc.uh,nc.lh)},nc);function nc(t,e,n){this.rh=t,this.oh=e,this.hh=n}function rc(t){this.Jo=t,this.buffer=new Li($h),this.Xo=0}ec._h=-1,ec.fh=1048576,ec.dh=41943040,ec.uh=10,ec.lh=1e3,ec.wh=new ec(ec.dh,ec.uh,ec.lh),ec.Th=new ec(ec._h,0,0);var ic=(hc.prototype.start=function(t){this.Or.params.rh!==ec._h&&this.mh(t)},hc.prototype.stop=function(){this.Ih&&(this.Ih.cancel(),this.Ih=null)},Object.defineProperty(hc.prototype,"hr",{get:function(){return null!==this.Ih},enumerable:!1,configurable:!0}),hc.prototype.mh=function(n){var t=this,e=this.Eh?3e5:6e4;Nr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Ih=this.Ro.Os("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.Ih=null,this.Eh=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Ah(this.Or)];case 2:return t.sent(),[3,7];case 3:return jh(e=t.sent())?(Nr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,pc(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.mh(n)];case 8:return t.sent(),[2]}})})})},hc),oc=(ac.prototype.Ph=function(t,e){return this.Rh.Lr(t).next(function(t){return Math.floor(e/100*t)})},ac.prototype.Vh=function(t,e){var n=this;if(0===e)return Yu.resolve(Zu.ps);var r=new Zh(e);return this.Rh.pe(t,function(t){return r.th(t.sequenceNumber)}).next(function(){return n.Rh.qr(t,function(t){return r.th(t)})}).next(function(){return r.maxValue})},ac.prototype.vi=function(t,e,n){return this.Rh.vi(t,e,n)},ac.prototype.Kr=function(t,e){return this.Rh.Kr(t,e)},ac.prototype.gh=function(e,n){var r=this;return this.params.rh===ec._h?(Nr("LruGarbageCollector","Garbage collection skipped; disabled"),Yu.resolve(tc)):this.zr(e).next(function(t){return t<r.params.rh?(Nr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.rh),tc):r.yh(e,n)})},ac.prototype.zr=function(t){return this.Rh.zr(t)},ac.prototype.yh=function(e,n){var r,i,o,s,u,a,h,c=this,f=Date.now();return this.Ph(e,this.params.oh).next(function(t){return i=t>c.params.hh?(Nr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.hh+" from "+t),c.params.hh):t,s=Date.now(),c.Vh(e,i)}).next(function(t){return r=t,u=Date.now(),c.vi(e,r,n)}).next(function(t){return o=t,a=Date.now(),c.Kr(e,r)}).next(function(t){return h=Date.now(),Tr()<=p.DEBUG&&Nr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-f)+"ms"),Yu.resolve({eh:!0,nh:i,sh:o,ih:t})})},ac),sc=(uc.prototype.start=function(){return Promise.resolve()},uc.prototype.Nh=function(i){return y(this,void 0,void 0,function(){var e,m,n,r=this;return v(this,function(t){switch(t.label){case 0:return e=this.ns,m=this.Ch,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.ns.so(v).next(function(t){return g=t,e=r.persistence.Cr(i),m=new Ju(r.Dh,e,r.persistence.kr()),e.so(v)}).next(function(t){for(var e=[],n=[],r=Hi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++){var h=a[u];r=r.add(h.key)}}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.us(v,r).next(function(t){return{$h:t,kh:e,xh:n}})})})];case 1:return n=t.sent(),[2,(this.ns=e,this.Ch=m,this.ph.Fh(this.Ch),n)]}})})},uc.prototype.Mh=function(h){var c,f=this,l=Kr.now(),t=h.reduce(function(t,e){return t.add(e.key)},Hi());return this.persistence.runTransaction("Locally write mutations","readwrite",function(a){return f.Ch.us(a,t).next(function(t){c=t;for(var e=[],n=0,r=h;n<r.length;n++){var i=r[n],o=(u=i,s=c.get(i.key),u instanceof Gs?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof au?t.field(i.field):void 0,s=ss(i.transform,o||null);null!=s&&(e=null==e?(new $s).set(i.field,s):e.set(i.field,s))}return e?e.ze():null}(s):null);null!=o&&e.push(new js(i.key,o,ru(o.proto.mapValue),xs.exists(!0)))}var u,s;return f.ns.Xr(a,l,e,h)})}).then(function(t){var e=t.Sn(c);return{batchId:t.batchId,Un:e}})},uc.prototype.Oh=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.Dh.oi({ai:!0});return i.Lh(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.ns.ho(t)}).next(function(){return i.Ch.us(t,e)})})},uc.prototype.Bh=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.ns.Zr(e,t).next(function(t){return Dr(null!==t),n=t.keys(),r.ns.ro(e,t)}).next(function(){return r.ns.ho(e)}).next(function(){return r.Ch.us(e,n)})})},uc.prototype.no=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.ns.no(t)})},uc.prototype.mi=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Xi.mi(t)})},uc.prototype.qh=function(a){var h=this,c=a.X,f=this.bh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.Dh.oi({ai:!0});f=h.bh;var s=[];a.Qt.forEach(function(t,e){var n=f.get(e);if(n){s.push(h.Xi.Ni(o,t.Xt,e).next(function(){return h.Xi.Ci(o,t.Yt,e)}));var r=t.resumeToken;if(0<r.H()){var i=n.tt(r,c).Z(o.Li);f=f.nt(e,i),uc.Uh(n,i,t)&&s.push(h.Xi.yi(o,i))}}});var u=Mi(),n=Hi();if(a.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.jt.forEach(function(t,e){var n=r.get(t);e instanceof hu&&e.version.isEqual(Qr.min())?(i.Gn(t,c),u=u.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.jn(e,c),u=u.nt(t,e)):Nr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Kt.has(t)&&s.push(h.persistence.wi.Gr(o,t))})})),!c.isEqual(Qr.min())){var t=h.Xi.mi(o).next(function(t){return h.Xi.Ri(o,o.Li,c)});s.push(t)}return Yu.Bn(s).next(function(){return i.apply(o)}).next(function(){return h.Ch.cs(o,u)})}).then(function(t){return h.bh=f,t})},uc.Uh=function(t,e,n){return Dr(0<e.resumeToken.H()),0===t.resumeToken.H()||e.X.m()-t.X.m()>=this.Qh||0<n.Yt.size+n.Jt.size+n.Xt.size},uc.prototype.Wh=function(c){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Yu.forEach(c,function(e){return Yu.forEach(e.ms,function(t){return h.persistence.wi.Fi(n,e.targetId,t)}).next(function(){return Yu.forEach(e.As,function(t){return h.persistence.wi.$i(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!jh(e=t.sent()))throw e;return Nr("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.bh.get(o),u=s.X,a=s.et(u),this.bh=this.bh.nt(o,a));return[2]}})})},uc.prototype.jh=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.ns.eo(t,e)})},uc.prototype.Kh=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Ch.rs(t,e)})},uc.prototype.Gh=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Xi.Di(e,r).next(function(t){return t?(n=t,Yu.resolve(n)):i.Xi.Ti(e).next(function(t){return n=new _i(r,t,0,e.Li),i.Xi.Pi(e,n).next(function(){return n})})})}).then(function(t){var e=i.bh.get(t.targetId);return(null===e||0<t.X.o(e.X))&&(i.bh=i.bh.nt(t.targetId,t),i.vh.set(r,t.targetId)),t})},uc.prototype.Di=function(t,e){var n=this.vh.get(e);return void 0!==n?Yu.resolve(this.bh.get(n)):this.Xi.Di(t,e)},uc.prototype.zh=function(t,e){var n=this,r=this.bh.get(t),i=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",i,function(t){return e?Yu.resolve():n.persistence.wi.removeTarget(t,r)}).then(function(){n.bh=n.bh.remove(t),n.vh.delete(r.target)})},uc.prototype.Hh=function(t,n){var r=this,i=Qr.min(),o=Hi();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.Di(e,t.We()).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Xi.ki(e,t.targetId).next(function(t){o=t})}).next(function(){return r.ph._s(e,t,n?i:Qr.min(),n?o:Hi())}).next(function(t){return{documents:t,Yh:o}})})},uc.prototype.Lh=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=Yu.resolve();return n.forEach(function(r){u=u.next(function(){return o.zn(t,r)}).next(function(t){var e=t,n=i.Cn.get(r);Dr(null!==n),(!e||e.version.o(n)<0)&&(e=s.pn(r,e,i))&&o.jn(e,i.Dn)})}),u.next(function(){return e.ns.ro(t,s)})},uc.prototype.Ah=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.gh(t,n.bh)})},uc);function uc(t,e,n){this.persistence=t,this.ph=e,this.bh=new xi(Lr),this.vh=new Wr(function(t){return yi(t)},vi),this.Sh=Qr.min(),this.ns=t.Cr(n),this.Dh=t.$r(),this.Xi=t.Nr(),this.Ch=new Ju(this.Dh,this.ns,this.persistence.kr()),this.ph.Fh(this.Ch)}function ac(t,e){this.Rh=t,this.params=e}function hc(t,e){this.Or=t,this.Ro=e,this.Eh=!1,this.Ih=null}sc.Qh=3e8;var cc,fc=(n(lc,cc=sc),lc.prototype.start=function(){return this.Jh()},lc.prototype.Xh=function(t){var n=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return n.ns.to(e,t).next(function(t){return t?n.Ch.us(e,t):Yu.resolve(null)})})},lc.prototype.Zh=function(t){this.ns.oo(t)},lc.prototype.cr=function(t){this.persistence.cr(t)},lc.prototype.Dr=function(){return this.persistence.Dr()},lc.prototype.ta=function(e){var n=this,t=this.bh.get(e);return t?Promise.resolve(t.target):this.persistence.runTransaction("Get target data","readonly",function(t){return n.Xi.Me(t,e).next(function(t){return t?t.target:null})})},lc.prototype.si=function(){var r=this;return this.persistence.runTransaction("Get new document changes","readonly",function(t){return r.Dh.si(t,r.Sh)}).then(function(t){var e=t.ii,n=t.readTime;return r.Sh=n,e})},lc.prototype.Jh=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,(e=this).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.Dh.ri(t)})];case 1:return e.Sh=t.sent(),[2]}})})},lc);function lc(t,e,n){var r=this;return(r=cc.call(this,t,e,n)||this).persistence=t,r.ns=t.Cr(n),r.Dh=t.$r(),r.Xi=t.Nr(),r}function pc(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Yr.FAILED_PRECONDITION||e.message!==Ku)throw e;return Nr("LocalStore","Unexpectedly lost primary lease"),[2]})})}var dc=(gc.prototype._=function(){return this.ea._()},gc.prototype.Fi=function(t,e){var n=new yc(t,e);this.ea=this.ea.add(n),this.sa=this.sa.add(n)},gc.prototype.ra=function(t,e){var n=this;t.forEach(function(t){return n.Fi(t,e)})},gc.prototype.$i=function(t,e){this.oa(new yc(t,e))},gc.prototype.ha=function(t,e){var n=this;t.forEach(function(t){return n.$i(t,e)})},gc.prototype.aa=function(t){var e=this,n=new ei(new $r([])),r=new yc(n,t),i=new yc(n,t+1),o=[];return this.sa.vt([r,i],function(t){e.oa(t),o.push(t.key)}),o},gc.prototype.ua=function(){var e=this;this.ea.forEach(function(t){return e.oa(t)})},gc.prototype.oa=function(t){this.ea=this.ea.delete(t),this.sa=this.sa.delete(t)},gc.prototype.ca=function(t){var e=new ei(new $r([])),n=new yc(e,t),r=new yc(e,t+1),i=Hi();return this.sa.vt([n,r],function(t){i=i.add(t.key)}),i},gc.prototype.Mi=function(t){var e=new yc(t,0),n=this.ea.Dt(e);return null!==n&&t.isEqual(n.key)},gc),yc=(vc.na=function(t,e){return ei.P(t.key,e.key)||Lr(t.la,e.la)},vc.ia=function(t,e){return Lr(t.la,e.la)||ei.P(t.key,e.key)},vc);function vc(t,e){this.key=t,this.la=e}function gc(){this.ea=new Li(yc.na),this.sa=new Li(yc.ia)}function mc(t,e){if(0!==e.length)throw new Xr(Yr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Vc(e.length,"argument")+".")}function wc(t,e,n){if(e.length!==n)throw new Xr(Yr.INVALID_ARGUMENT,"Function "+t+"() requires "+Vc(n,"argument")+", but was called with "+Vc(e.length,"argument")+".")}function bc(t,e,n){if(e.length<n)throw new Xr(Yr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Vc(n,"argument")+", but was called with "+Vc(e.length,"argument")+".")}function Ic(t,e,n,r){if(e.length<n||e.length>r)throw new Xr(Yr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Vc(e.length,"argument")+".")}function Ec(t,e,n,r){Sc(t,e,Cc(n)+" argument",r)}function _c(t,e,n,r){void 0!==r&&Ec(t,e,n,r)}function Tc(t,e,n,r){Sc(t,e,n+" option",r)}function Nc(t,e,n,r){void 0!==r&&Tc(t,e,n,r)}function Ac(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Pc(s))}var u=Pc(n);throw new Xr(Yr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function xc(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Xr(Yr.INVALID_ARGUMENT,"Invalid value "+Pc(r)+" provided to function "+t+"() for its "+Cc(n)+" argument. Acceptable values: "+e.join(", "));return r}function Sc(t,e,n,r){if(!("object"===e?Dc(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Pc(r);throw new Xr(Yr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Dc(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Pc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Sr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Rc(t,e,n){if(void 0===n)throw new Xr(Yr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Cc(e)+" argument, but it was undefined.")}function Oc(n,t,r){qr(t,function(t,e){if(r.indexOf(t)<0)throw new Xr(Yr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function kc(t,e,n,r){var i=Pc(r);return new Xr(Yr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Cc(n)+" argument to be a "+e+", but it was: "+i)}function Lc(t,e,n){if(n<=0)throw new Xr(Yr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Cc(e)+" argument to be a positive number, but it was: "+n+".")}function Cc(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Vc(t,e){return t+" "+e+(1===t?"":"s")}function Uc(){if("undefined"==typeof Uint8Array)throw new Xr(Yr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function jc(){if("undefined"==typeof atob)throw new Xr(Yr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Mc,Fc,qc=(Kc.fromBase64String=function(t){wc("Blob.fromBase64String",arguments,1),Ec("Blob.fromBase64String","string",1,t),jc();try{return new Kc(mi.fromBase64String(t))}catch(t){throw new Xr(Yr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Kc.fromUint8Array=function(t){if(wc("Blob.fromUint8Array",arguments,1),Uc(),!(t instanceof Uint8Array))throw kc("Blob.fromUint8Array","Uint8Array",1,t);return new Kc(mi.fromUint8Array(t))},Kc.prototype.toBase64=function(){return wc("Blob.toBase64",arguments,0),jc(),this._a.toBase64()},Kc.prototype.toUint8Array=function(){return wc("Blob.toUint8Array",arguments,0),Uc(),this._a.toUint8Array()},Kc.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Kc.prototype.isEqual=function(t){return this._a.isEqual(t._a)},Kc),Bc=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Xr(Yr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Ec("FieldPath","string",e,t[e]),0===t[e].length)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.fa=new ti(t)},Gc=(n(Xc,Fc=Bc),Xc.documentId=function(){return new Xc(ti.L().N())},Xc.prototype.isEqual=function(t){if(!(t instanceof Xc))throw kc("isEqual","FieldPath",1,t);return this.fa.isEqual(t.fa)},Xc),zc=new RegExp("[~\\*/\\[\\]]"),Hc=function(){this.da=this},Wc=(n(Yc,Mc=Hc),Yc.prototype.Ta=function(t){if(2!==t.Ea)throw 1===t.Ea?t.Ia(this.wa+"() can only appear at the top level of your update data"):t.Ia(this.wa+"() cannot be used with set() unless you pass {merge:true}");return t.Le.push(t.path),null},Yc.prototype.isEqual=function(t){return t instanceof Yc},Yc);function Yc(t){var e=this;return(e=Mc.call(this)||this).wa=t,e}function Xc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Fc.call(this,t)||this}function Kc(t){jc(),this._a=t}function Qc(t,e,n){return new Af({Ea:3,ma:e.settings.ma,methodName:t.wa,Aa:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var Jc,$c,Zc,tf,ef,nf,rf=(n(gf,nf=Hc),gf.prototype.Ta=function(t){return new Ts(t.path,new hs)},gf.prototype.isEqual=function(t){return t instanceof gf},gf),of=(n(vf,ef=Hc),vf.prototype.Ta=function(t){var e=Qc(this,t,!0),n=this.Ra.map(function(t){return Lf(t,e)}),r=new cs(n);return new Ts(t.path,r)},vf.prototype.isEqual=function(t){return this===t},vf),sf=(n(yf,tf=Hc),yf.prototype.Ta=function(t){var e=Qc(this,t,!0),n=this.Ra.map(function(t){return Lf(t,e)}),r=new ys(n);return new Ts(t.path,r)},yf.prototype.isEqual=function(t){return this===t},yf),uf=(n(df,Zc=Hc),df.prototype.Ta=function(t){var e=new ws(t.serializer,Uo(t.serializer,this.Pa));return new Ts(t.path,e)},df.prototype.isEqual=function(t){return this===t},df),af=(n(pf,$c=Hc),pf.delete=function(){return mc("FieldValue.delete",arguments),new hf(new Wc("FieldValue.delete"))},pf.serverTimestamp=function(){return mc("FieldValue.serverTimestamp",arguments),new hf(new rf("FieldValue.serverTimestamp"))},pf.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return bc("FieldValue.arrayUnion",arguments,1),new hf(new of("FieldValue.arrayUnion",t))},pf.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return bc("FieldValue.arrayRemove",arguments,1),new hf(new sf("FieldValue.arrayRemove",t))},pf.increment=function(t){return Ec("FieldValue.increment","number",1,t),wc("FieldValue.increment",arguments,1),new hf(new uf("FieldValue.increment",t))},pf),hf=(n(lf,Jc=af),lf.prototype.Ta=function(t){return this.da.Ta(t)},lf.prototype.isEqual=function(t){return t instanceof lf&&this.da.isEqual(t.da)},lf),cf=(Object.defineProperty(ff.prototype,"latitude",{get:function(){return this.Va},enumerable:!1,configurable:!0}),Object.defineProperty(ff.prototype,"longitude",{get:function(){return this.ga},enumerable:!1,configurable:!0}),ff.prototype.isEqual=function(t){return this.Va===t.Va&&this.ga===t.ga},ff.prototype.T=function(t){return Lr(this.Va,t.Va)||Lr(this.ga,t.ga)},ff);function ff(t,e){if(wc("GeoPoint",arguments,2),Ec("GeoPoint","number",1,t),Ec("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Xr(Yr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Xr(Yr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Va=t,this.ga=e}function lf(t){var e=this;return(e=Jc.call(this)||this).da=t,e.wa=t.wa,e}function pf(){return $c.call(this)||this}function df(t,e){var n=this;return(n=Zc.call(this)||this).wa=t,n.Pa=e,n}function yf(t,e){var n=this;return(n=tf.call(this)||this).wa=t,n.Ra=e,n}function vf(t,e){var n=this;return(n=ef.call(this)||this).wa=t,n.Ra=e,n}function gf(t){var e=this;return(e=nf.call(this)||this).wa=t,e}function mf(t){return new Lo(t,!0)}var wf=/^__.*__$/,bf=function(t,e,n){this.ya=t,this.pa=e,this.ba=n},If=(Tf.prototype.va=function(t,e){var n=[];return null!==this.Le?n.push(new js(t,this.data,this.Le,e)):n.push(new Us(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Gs(t,this.fieldTransforms)),n},Tf),Ef=(_f.prototype.va=function(t,e){var n=[new js(t,this.data,this.Le,e)];return 0<this.fieldTransforms.length&&n.push(new Gs(t,this.fieldTransforms)),n},_f);function _f(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function Tf(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function Nf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Sr()}}var Af=(Object.defineProperty(Df.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Df.prototype,"Ea",{get:function(){return this.settings.Ea},enumerable:!1,configurable:!0}),Df.prototype.Da=function(t){return new Df(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Le)},Df.prototype.Ca=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Da({path:n,Aa:!1});return r.Fa(t),r},Df.prototype.Na=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Da({path:n,Aa:!1});return r.Sa(),r},Df.prototype.$a=function(t){return this.Da({path:void 0,Aa:!0})},Df.prototype.Ia=function(t){return Ff(t,this.settings.methodName,this.settings.ka||!1,this.path,this.settings.ma)},Df.prototype.contains=function(e){return void 0!==this.Le.find(function(t){return e.D(t)})||void 0!==this.fieldTransforms.find(function(t){return e.D(t.field)})},Df.prototype.Sa=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Fa(this.path.get(t))},Df.prototype.Fa=function(t){if(0===t.length)throw this.Ia("Document fields must not be empty");if(Nf(this.Ea)&&wf.test(t))throw this.Ia('Document fields cannot begin and end with "__"')},Df),xf=(Sf.prototype.xa=function(t,e,n,r){return void 0===r&&(r=!1),new Af({Ea:t,methodName:e,ma:n,path:ti.k(),Aa:!1,ka:r},this.s,this.serializer,this.ignoreUndefinedProperties)},Sf);function Sf(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||mf(t)}function Df(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Sa(),this.fieldTransforms=i||[],this.Le=o||[]}function Pf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.xa(o.merge||o.mergeFields?2:0,e,n,i);Uf("Data must be an object, but it was:",s,r);var u,a,h=Cf(r,s);if(o.merge)u=new _s(s.Le),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof Bc)d=p.fa;else{if("string"!=typeof p)throw Sr();d=Mf(e,p,n)}if(!s.contains(d))throw new Xr(Yr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");qf(c,d)||c.push(d)}u=new _s(c),a=s.fieldTransforms.filter(function(t){return u.Ke(t.field)})}else u=null,a=s.fieldTransforms;return new If(new Js(h),u,a)}function Rf(t,o,s,e){var u=t.xa(1,o,s);Uf("Data must be an object, but it was:",u,e);var a=[],h=new $s;qr(e,function(t,e){var n=Mf(o,t,s),r=u.Na(n);if(e instanceof Hc&&e.da instanceof Wc)a.push(n);else{var i=Lf(e,r);null!=i&&(a.push(n),h.set(n,i))}});var n=new _s(a);return new Ef(h.ze(),n,u.fieldTransforms)}function Of(t,e,n,r,i,o){var s=t.xa(1,e,n),u=[jf(e,r,n)],a=[i];if(o.length%2!=0)throw new Xr(Yr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(jf(e,o[h])),a.push(o[h+1]);for(var c=[],f=new $s,l=u.length-1;0<=l;--l)if(!qf(c,u[l])){var p=u[l],d=a[l],y=s.Na(p);if(d instanceof Hc&&d.da instanceof Wc)c.push(p);else{var v=Lf(d,y);null!=v&&(c.push(p),f.set(p,v))}}var g=new _s(c);return new Ef(f.ze(),g,s.fieldTransforms)}function kf(t,e,n,r){return void 0===r&&(r=!1),Lf(n,t.xa(r?4:3,e))}function Lf(s,t){if(Vf(s))return Uf("Unsupported field value:",t,s),Cf(s,t);if(s instanceof Hc)return function(t,e){if(!Nf(e.Ea))throw e.Ia(t.wa+"() can only be used with update() and set()");if(!e.path)throw e.Ia(t.wa+"() is not currently supported inside arrays");var n=t.Ta(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Le.push(t.path),s instanceof Array){if(t.settings.Aa&&4!==t.Ea)throw t.Ia("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Lf(i[r],t.$a(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Uo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Kr.fromDate(t);return{timestampValue:jo(e.serializer,n)}}if(t instanceof Kr){var r=new Kr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:jo(e.serializer,r)}}if(t instanceof cf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof qc)return{bytesValue:Mo(e.serializer,t)};if(t instanceof bf){var i=e.s,o=t.ya;if(!o.isEqual(i))throw e.Ia("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:qo(t.ya||e.s,t.pa.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Ia("Unsupported field value: "+Pc(t))}(s,t)}function Cf(t,r){var i={};return Br(t)?r.path&&0<r.path.length&&r.Le.push(r.path):qr(t,function(t,e){var n=Lf(e,r.Ca(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Vf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Kr||t instanceof cf||t instanceof qc||t instanceof bf||t instanceof Hc)}function Uf(t,e,n){if(!Vf(n)||!Dc(n)){var r=Pc(n);throw"an object"===r?e.Ia(t+" a custom object"):e.Ia(t+" "+r)}}function jf(t,e,n){if(e instanceof Bc)return e.fa;if("string"==typeof e)return Mf(t,e);throw Ff("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Mf(t,e,n){try{return function(e){if(0<=e.search(zc))throw new Xr(Yr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Gc.bind.apply(Gc,d([void 0],e.split("."))))}catch(t){throw new Xr(Yr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).fa}catch(e){throw Ff(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Ff(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Xr(Yr.INVALID_ARGUMENT,(u+=". ")+t+a)}function qf(t,e){return t.some(function(t){return t.isEqual(e)})}var Bf=(Gf.prototype.Yr=function(){return null!=this.uid},Gf.prototype.Ma=function(){return this.Yr()?"uid:"+this.uid:"anonymous-user"},Gf.prototype.isEqual=function(t){return t.uid===this.uid},Gf);function Gf(t){this.uid=t}Bf.UNAUTHENTICATED=new Bf(null),Bf.Oa=new Bf("google-credentials-uid"),Bf.La=new Bf("first-party-uid");function zf(t,e){this.user=e,this.type="OAuth",this.Ba={},this.Ba.Authorization="Bearer "+t}var Hf,Wf,Yf,Xf=(yl.prototype.getToken=function(){return Promise.resolve(null)},yl.prototype.Ua=function(){},yl.prototype.Qa=function(t){(this.qa=t)(Bf.UNAUTHENTICATED)},yl.prototype.Wa=function(){this.qa=null},yl),Kf=(dl.prototype.getToken=function(){var e=this,n=this.Ga,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Ga!==n?(Nr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Dr("string"==typeof t.accessToken),new zf(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},dl.prototype.Ua=function(){this.forceRefresh=!0},dl.prototype.Qa=function(t){this.qa=t,this.Ka&&t(this.currentUser)},dl.prototype.Wa=function(){this.auth&&this.auth.removeAuthTokenListener(this.ja),this.ja=null,this.qa=null},dl.prototype.za=function(){var t=this.auth&&this.auth.getUid();return Dr(null===t||"string"==typeof t),new Bf(t)},dl),Qf=(Object.defineProperty(pl.prototype,"Ba",{get:function(){var t={"X-Goog-AuthUser":this.Ya},e=this.Ha.auth.Ja([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),pl),Jf=(ll.prototype.getToken=function(){return Promise.resolve(new Qf(this.Ha,this.Ya))},ll.prototype.Qa=function(t){t(Bf.La)},ll.prototype.Wa=function(){},ll.prototype.Ua=function(){},ll),$f=(fl.prototype.su=function(){return 1===this.state||2===this.state||4===this.state},fl.prototype.iu=function(){return 2===this.state},fl.prototype.start=function(){3!==this.state?this.auth():this.ru()},fl.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.su()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},fl.prototype.ou=function(){this.state=0,this.xo.reset()},fl.prototype.hu=function(){var t=this;this.iu()&&null===this.nu&&(this.nu=this.bs.Os(this.Xa,6e4,function(){return t.au()}))},fl.prototype.uu=function(t){this.cu(),this.stream.send(t)},fl.prototype.au=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.iu()?[2,this.close(0)]:[2]})})},fl.prototype.cu=function(){this.nu&&(this.nu.cancel(),this.nu=null)},fl.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.cu(),this.xo.cancel(),this.eu++,3!==e?this.xo.reset():n&&n.code===Yr.RESOURCE_EXHAUSTED?(Ar(n.toString()),Ar("Using maximum backoff delay to prevent overloading the backend."),this.xo.ks()):n&&n.code===Yr.UNAUTHENTICATED&&this.tu.Ua(),null!==this.stream&&(this.lu(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener._u(n)];case 1:return t.sent(),[2]}})})},fl.prototype.lu=function(){},fl.prototype.auth=function(){var n=this;this.state=1;var t=this.fu(this.eu),e=this.eu;this.tu.getToken().then(function(t){n.eu===e&&n.du(t)},function(e){t(function(){var t=new Xr(Yr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.wu(t)})})},fl.prototype.du=function(t){var e=this,n=this.fu(this.eu);this.stream=this.Tu(t),this.stream.Eu(function(){n(function(){return e.state=2,e.listener.Eu()})}),this.stream._u(function(t){n(function(){return e.wu(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},fl.prototype.ru=function(){var t=this;this.state=4,this.xo.xs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},fl.prototype.wu=function(t){return Nr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},fl.prototype.fu=function(e){var n=this;return function(t){n.bs.lr(function(){return n.eu===e?t():(Nr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},fl),Zf=(n(cl,Yf=$f),cl.prototype.Tu=function(t){return this.Za.Iu("Listen",t)},cl.prototype.onMessage=function(t){this.xo.reset();var e=function(t,e){var n,r,i,o,s,u;if("targetChange"in e){e.targetChange;var a="NO_CHANGE"===(u=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===u?1:"REMOVE"===u?2:"CURRENT"===u?3:"RESET"===u?4:Sr(),h=e.targetChange.targetIds||[],c=(o=t,s=e.targetChange.resumeToken,o.Oe?(Dr(void 0===s||"string"==typeof s),mi.fromBase64String(s||"")):(Dr(void 0===s||s instanceof Uint8Array),mi.fromUint8Array(s||new Uint8Array))),f=e.targetChange.cause,l=f&&(i=void 0===(r=f).code?Yr.UNKNOWN:Ai(r.code),new Xr(i,r.message||""));n=new Qi(a,h,c,l||null)}else if("documentChange"in e){e.documentChange;var p=e.documentChange;p.document,p.document.name,p.document.updateTime;var d=zo(t,p.document.name),y=Fo(p.document.updateTime),v=new Js({mapValue:{fields:p.document.fields}}),g=new au(d,y,v,{}),m=p.targetIds||[],w=p.removedTargetIds||[];n=new Xi(m,w,g.key,g)}else if("documentDelete"in e){e.documentDelete;var b=e.documentDelete;b.document;var I=zo(t,b.document),E=b.readTime?Fo(b.readTime):Qr.min(),_=new hu(I,E),T=b.removedTargetIds||[];n=new Xi([],T,_.key,_)}else if("documentRemove"in e){e.documentRemove;var N=e.documentRemove;N.document;var A=zo(t,N.document),x=N.removedTargetIds||[];n=new Xi([],x,A,null)}else{if(!("filter"in e))return Sr();e.filter;var S=e.filter;S.targetId;var D=S.count||0,P=new bi(D),R=S.targetId;n=new Ki(R,P)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Qr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Qr.min():Fo(e.readTime)}(t);return this.listener.mu(e,n)},cl.prototype.Au=function(t){var e,n,r,i,o={};o.database=Yo(this.serializer),o.addTarget=(e=this.serializer,i=(n=t).target,(r=gi(i)?{documents:$o(e,i)}:{query:Zo(e,i)}).targetId=n.targetId,0<n.resumeToken.H()&&(r.resumeToken=Mo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.J){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Sr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.uu(o)},cl.prototype.Ru=function(t){var e={};e.database=Yo(this.serializer),e.removeTarget=t,this.uu(e)},cl),tl=(n(hl,Wf=$f),Object.defineProperty(hl.prototype,"Vu",{get:function(){return this.Pu},enumerable:!1,configurable:!0}),hl.prototype.start=function(){this.Pu=!1,this.lastStreamToken=void 0,Wf.prototype.start.call(this)},hl.prototype.lu=function(){this.Pu&&this.gu([])},hl.prototype.Tu=function(t){return this.Za.Iu("Write",t)},hl.prototype.onMessage=function(t){if(Dr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Pu){this.xo.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Dr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?Fo(t.updateTime):Fo(e);n.isEqual(Qr.min())&&(n=Fo(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new As(n,r)}(t,i)})):[]),n=Fo(t.commitTime);return this.listener.yu(n,e)}var r,i;return Dr(!t.writeResults||0===t.writeResults.length),this.Pu=!0,this.listener.pu()},hl.prototype.bu=function(){var t={};t.database=Yo(this.serializer),this.uu(t)},hl.prototype.gu=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Qo(e.serializer,t)})};this.uu(n)},hl),el=(n(al,Hf=function(){this.je=void 0}),al.prototype.Su=function(){if(this.vu)throw new Xr(Yr.FAILED_PRECONDITION,"The client has already been terminated.")},al.prototype.Du=function(e,n){var r=this;return this.Su(),this.credentials.getToken().then(function(t){return r.Za.Du(e,n,t)}).catch(function(t){throw t.code===Yr.UNAUTHENTICATED&&r.credentials.Ua(),t})},al.prototype.Cu=function(e,n){var r=this;return this.Su(),this.credentials.getToken().then(function(t){return r.Za.Cu(e,n,t)}).catch(function(t){throw t.code===Yr.UNAUTHENTICATED&&r.credentials.Ua(),t})},al),nl=(ul.prototype.Mu=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Ou(),0<this.mutations.length)throw new Xr(Yr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var i,e,n,o,r;return v(this,function(t){switch(t.label){case 0:return i=Pr(s),e={database:Yo(i.serializer),documents:u.map(function(t){return Go(i.serializer,t)})},[4,i.Cu("BatchGetDocuments",e)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Dr(!!e.found),e.found.name,e.found.updateTime;var n=zo(t,e.found.name),r=Fo(e.found.updateTime),i=new Js({mapValue:{fields:e.found.fields}});return new au(n,r,i,{})}(e,n):"missing"in n?function(t,e){Dr(!!e.missing),Dr(!!e.readTime);var n=zo(t,e.missing),r=Fo(e.readTime);return new hu(n,r)}(e,n):Sr());o.set(r.key.toString(),r)}),r=[],[2,(u.forEach(function(t){var e=o.get(t.toString());Dr(!!e),r.push(e)}),r)]}})})}(this.Fu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof hu||t instanceof au?n.Lu(t):Sr()}),e)]}})})},ul.prototype.set=function(t,e){this.write(e.va(t,this.Ue(t))),this.xu.add(t)},ul.prototype.update=function(t,e){try{this.write(e.va(t,this.Bu(t)))}catch(t){this.ku=t}this.xu.add(t)},ul.prototype.delete=function(t){this.write([new Ks(t,this.Ue(t))]),this.xu.add(t)},ul.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,r=this;return v(this,function(t){switch(t.label){case 0:if(this.Ou(),this.ku)throw this.ku;return e=this.Nu,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new ei($r.$(e));r.mutations.push(new Qs(n,r.Ue(n)))}),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=Pr(r),n={database:Yo(e.serializer),writes:i.map(function(t){return Qo(e.serializer,t)})},[4,e.Du("Commit",n)];case 1:return t.sent(),[2]}})})}(this.Fu,this.mutations)];case 1:return t.sent(),this.$u=!0,[2]}})})},ul.prototype.Lu=function(t){var e;if(t instanceof au)e=t.version;else{if(!(t instanceof hu))throw Sr();e=Qr.min()}var n=this.Nu.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Xr(Yr.ABORTED,"Document version changed between two reads.")}else this.Nu.set(t.key.toString(),e)},ul.prototype.Ue=function(t){var e=this.Nu.get(t.toString());return!this.xu.has(t)&&e?xs.updateTime(e):xs.Qe()},ul.prototype.Bu=function(t){var e=this.Nu.get(t.toString());if(this.xu.has(t)||!e)return xs.exists(!0);if(e.isEqual(Qr.min()))throw new Xr(Yr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return xs.updateTime(e)},ul.prototype.write=function(t){this.Ou(),this.mutations=this.mutations.concat(t)},ul.prototype.Ou=function(){},ul),rl=(sl.prototype.ju=function(){var t=this;0===this.Uu&&(this.Ku("Unknown"),this.Qu=this.Ro.Os("online_state_timeout",1e4,function(){return t.Qu=null,t.Gu("Backend didn't respond within 10 seconds."),t.Ku("Offline"),Promise.resolve()}))},sl.prototype.zu=function(t){"Online"===this.state?this.Ku("Unknown"):(this.Uu++,1<=this.Uu&&(this.Hu(),this.Gu("Connection failed 1 times. Most recent error: "+t.toString()),this.Ku("Offline")))},sl.prototype.set=function(t){this.Hu(),this.Uu=0,"Online"===t&&(this.Wu=!1),this.Ku(t)},sl.prototype.Ku=function(t){t!==this.state&&(this.state=t,this.qu(t))},sl.prototype.Gu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Wu?(Ar(e),this.Wu=!1):Nr("OnlineStateTracker",e)},sl.prototype.Hu=function(){null!==this.Qu&&(this.Qu.cancel(),this.Qu=null)},sl),il=(ol.prototype.start=function(){return this.enableNetwork()},ol.prototype.enableNetwork=function(){return this.tc.delete(0),this.dc()},ol.prototype.dc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.sc()?(this.wc()?this.Tc():this.rc.set("Unknown"),[4,this.Ec()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},ol.prototype.disableNetwork=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.tc.add(0),[4,this.Ic()];case 1:return t.sent(),this.rc.set("Offline"),[2]}})})},ol.prototype.Ic=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.cc.stop()];case 1:return t.sent(),[4,this.oc.stop()];case 2:return t.sent(),0<this.Ju.length&&(Nr("RemoteStore","Stopping write stream with "+this.Ju.length+" pending writes"),this.Ju=[]),this.mc(),[2]}})})},ol.prototype.yr=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Nr("RemoteStore","RemoteStore shutting down."),this.tc.add(5),[4,this.Ic()];case 1:return t.sent(),this.ec.yr(),this.rc.set("Unknown"),[2]}})})},ol.prototype.listen=function(t){this.Xu.has(t.targetId)||(this.Xu.set(t.targetId,t),this.wc()?this.Tc():this.oc.iu()&&this.Ac(t))},ol.prototype.Rc=function(t){this.Xu.delete(t),this.oc.iu()&&this.Pc(t),0===this.Xu.size&&(this.oc.iu()?this.oc.hu():this.sc()&&this.rc.set("Unknown"))},ol.prototype.Me=function(t){return this.Xu.get(t)||null},ol.prototype.xe=function(t){return this.Vc.xe(t)},ol.prototype.Ac=function(t){this.Zu.de(t.targetId),this.oc.Au(t)},ol.prototype.Pc=function(t){this.Zu.de(t),this.oc.Ru(t)},ol.prototype.Tc=function(){this.Zu=new ro(this),this.oc.start(),this.rc.ju()},ol.prototype.wc=function(){return this.sc()&&!this.oc.su()&&0<this.Xu.size},ol.prototype.sc=function(){return 0===this.tc.size},ol.prototype.mc=function(){this.Zu=null},ol.prototype.hc=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){return this.Xu.forEach(function(t,e){n.Ac(t)}),[2]})})},ol.prototype.ac=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return this.mc(),this.wc()?(this.rc.zu(e),this.Tc()):this.rc.set("Unknown"),[2]})})},ol.prototype.uc=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:if(this.rc.set("Online"),!(i instanceof Qi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.gc(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Nr("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.yc(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Xi?this.Zu.Pe(i):i instanceof Ki?this.Zu.De(i):this.Zu.ye(i),o.isEqual(Qr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.Yu.mi()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.pc(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Nr("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.yc(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},ol.prototype.yc=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!jh(n))throw n;return this.tc.add(1),[4,this.Ic()];case 1:return t.sent(),this.rc.set("Offline"),r=r||function(){return e.Yu.mi()},this.Ro.dr(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Nr("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.tc.delete(1),[4,this.dc()];case 2:return t.sent(),[2]}})})}),[2]}})})},ol.prototype.bc=function(e){var n=this;return e().catch(function(t){return n.yc(t,e)})},ol.prototype.pc=function(r){var i=this,t=this.Zu.Ne(r);return t.Qt.forEach(function(t,e){if(0<t.resumeToken.H()){var n=i.Xu.get(e);n&&i.Xu.set(e,n.tt(t.resumeToken,r))}}),t.Wt.forEach(function(t){var e=i.Xu.get(t);if(e){i.Xu.set(t,e.tt(mi.Y,e.X)),i.Pc(t);var n=new _i(e.target,t,1,e.sequenceNumber);i.Ac(n)}}),this.Vc.qh(t)},ol.prototype.gc=function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.Xu.has(i)?[4,this.Vc.vc(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.Xu.delete(i),this.Zu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},ol.prototype.Ec=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=0<this.Ju.length?this.Ju[this.Ju.length-1].batchId:-1,t.label=1;case 1:if(!this.Sc())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.Yu.jh(e)];case 3:return null===(n=t.sent())?(0===this.Ju.length&&this.cc.hu(),[3,7]):(e=n.batchId,this.Dc(n),[3,6]);case 4:return r=t.sent(),[4,this.yc(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Cc()&&this.Fc(),[2]}})})},ol.prototype.Sc=function(){return this.sc()&&this.Ju.length<10},ol.prototype.Nc=function(){return this.Ju.length},ol.prototype.Dc=function(t){this.Ju.push(t),this.cc.iu()&&this.cc.Vu&&this.cc.gu(t.mutations)},ol.prototype.Cc=function(){return this.sc()&&!this.cc.su()&&0<this.Ju.length},ol.prototype.Fc=function(){this.cc.start()},ol.prototype.lc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.cc.bu(),[2]})})},ol.prototype.fc=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){for(e=0,n=this.Ju;e<n.length;e++)r=n[e],this.cc.gu(r.mutations);return[2]})})},ol.prototype.yu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return e=this.Ju.shift(),n=Wu.from(e,i,o),[4,this.bc(function(){return r.Vc.$c(n)})];case 1:return t.sent(),[4,this.Ec()];case 2:return t.sent(),[2]}})})},ol.prototype._c=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e&&this.cc.Vu?[4,this.kc(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Cc()&&this.Fc(),[2]}})})},ol.prototype.kc=function(i){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return Ni(n=i.code)&&n!==Yr.ABORTED?(e=this.Ju.shift(),this.cc.ou(),[4,this.bc(function(){return r.Vc.xc(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.Ec()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},ol.prototype.Mc=function(){return new nl(this.Fu)},ol.prototype.ic=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.tc.add(4),[4,this.Ic()];case 1:return t.sent(),this.rc.set("Unknown"),this.tc.delete(4),[4,this.dc()];case 2:return t.sent(),[2]}})})},ol.prototype.Oc=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ro.Ko(),Nr("RemoteStore","RemoteStore received new credentials"),this.tc.add(3),[4,this.Ic()];case 1:return t.sent(),this.rc.set("Unknown"),[4,this.Vc.Oc(e)];case 2:return t.sent(),this.tc.delete(3),[4,this.dc()];case 3:return t.sent(),[2]}})})},ol.prototype.Lc=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(this.tc.delete(2),[4,this.dc()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.tc.add(2),[4,this.Ic()]);case 3:t.sent(),this.rc.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},ol);function ol(t,e,n,r,i){var o,s,u,a,h,c,f,l,p=this;this.Yu=t,this.Fu=e,this.Ro=n,this.Ju=[],this.Xu=new Map,this.Zu=null,this.tc=new Set,this.ec=i,this.ec.nc(function(t){n.lr(function(){return y(p,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.sc()?(Nr("RemoteStore","Restarting streams for network reachability change."),[4,this.ic()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.rc=new rl(n,r),this.oc=(h=this.Fu,c=n,f={Eu:this.hc.bind(this),_u:this.ac.bind(this),mu:this.uc.bind(this)},l=Pr(h),new Zf(c,l.Za,l.credentials,l.serializer,f)),this.cc=(o=this.Fu,s=n,u={Eu:this.lc.bind(this),_u:this._c.bind(this),pu:this.fc.bind(this),yu:this.yu.bind(this)},a=Pr(o),new tl(s,a.Za,a.credentials,a.serializer,u))}function sl(t,e){this.Ro=t,this.qu=e,this.state="Unknown",this.Uu=0,this.Qu=null,this.Wu=!0}function ul(t){this.Fu=t,this.Nu=new Map,this.mutations=[],this.$u=!1,this.ku=null,this.xu=new Set}function al(t,e,n){var r=this;return(r=Hf.call(this)||this).Za=t,r.credentials=e,r.serializer=n,r.vu=!1,r}function hl(t,e,n,r,i){var o=this;return(o=Wf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Pu=!1,o}function cl(t,e,n,r,i){var o=this;return(o=Yf.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function fl(t,e,n,r,i,o){this.bs=t,this.Xa=n,this.Za=r,this.tu=i,this.listener=o,this.state=0,this.eu=0,this.nu=null,this.stream=null,this.xo=new ha(t,e)}function ll(t,e){this.Ha=t,this.Ya=e}function pl(t,e){this.Ha=t,this.Ya=e,this.type="FirstParty",this.user=Bf.La}function dl(t){var e=this;this.ja=null,this.currentUser=Bf.UNAUTHENTICATED,this.Ka=!1,this.Ga=0,this.qa=null,this.forceRefresh=!1,this.ja=function(){e.Ga++,e.currentUser=e.za(),e.Ka=!0,e.qa&&e.qa(e.currentUser)},this.Ga=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.ja):(this.ja(null),t.get().then(function(t){e.auth=t,e.ja&&e.auth.addAuthTokenListener(e.ja)},function(){}))}function yl(){this.qa=null}function vl(t,e){return"firestore_clients_"+t+"_"+e}function gl(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Yr()&&(r+="_"+e.uid),r}function ml(t,e){return"firestore_targets_"+t+"_"+e}function wl(t){this.key=t}function bl(t){this.key=t}function Il(t,e,n){this.query=t,this.targetId=e,this.view=n}function El(t){this.key=t,this.t_=!1}function _l(){this.O_=void 0,this.listeners=[]}var Tl,Nl,Al=(rp.Bc=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Xr(r.error.code,r.error.message)),i?new rp(t,e,r.state,o):(Ar("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},rp.prototype.qc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},rp),xl=(np.Bc=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Xr(n.error.code,n.error.message)),r?new np(t,n.state,i):(Ar("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},np.prototype.qc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},np),Sl=(ep.Bc=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Yi(),o=0;r&&o<n.activeTargetIds.length;++o)r=li(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new ep(t,i):(Ar("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},ep),Dl=(tp.Bc=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new tp(e.clientId,e.onlineState):(Ar("SharedClientState","Failed to parse online state: "+t),null)},tp),Pl=(Zl.prototype.Uc=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Zl.prototype.Qc=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Zl.prototype.qc=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},Zl),Rl=($l.Hi=function(t){return!(!t||!t.localStorage)},$l.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l=this;return v(this,function(t){switch(t.label){case 0:return[4,this.Vc.Dr()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.Wc&&(o=this.getItem(vl(this.persistenceKey,i)))&&(s=Sl.Bc(i,o))&&(this.Gc=this.Gc.nt(s.clientId,s));for(this.el(),(u=this.storage.getItem(this.tl))&&(a=this.nl(u))&&this.sl(a),h=0,c=this.zc;h<c.length;h++)f=c[h],this.Kc(f);return this.zc=[],this.window.addEventListener("unload",function(){return l.yr()}),this.hr=!0,[2]}})})},$l.prototype.ys=function(t){this.setItem(this.Yc,JSON.stringify(t))},$l.prototype.il=function(){return this.rl(this.Gc)},$l.prototype.ol=function(n){var r=!1;return this.Gc.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},$l.prototype.hl=function(t){this.al(t,"pending")},$l.prototype.ul=function(t,e,n){this.al(t,e,n),this.cl(t)},$l.prototype.ll=function(t){var e="not-current";if(this.ol(t)){var n=this.storage.getItem(ml(this.persistenceKey,t));if(n){var r=xl.Bc(t,n);r&&(e=r.state)}}return this._l.Uc(t),this.el(),e},$l.prototype.fl=function(t){this._l.Qc(t),this.el()},$l.prototype.dl=function(t){return this._l.activeTargetIds.has(t)},$l.prototype.wl=function(t){this.removeItem(ml(this.persistenceKey,t))},$l.prototype.Tl=function(t,e,n){this.El(t,e,n)},$l.prototype.Nh=function(t,e,n){var r=this;e.forEach(function(t){r.cl(t)}),this.currentUser=t,n.forEach(function(t){r.hl(t)})},$l.prototype.Il=function(t){this.ml(t)},$l.prototype.yr=function(){this.hr&&(this.window.removeEventListener("storage",this.jc),this.removeItem(this.Hc),this.hr=!1)},$l.prototype.getItem=function(t){var e=this.storage.getItem(t);return Nr("SharedClientState","READ",t,e),e},$l.prototype.setItem=function(t,e){Nr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},$l.prototype.removeItem=function(t){Nr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},$l.prototype.Kc=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(Nr("SharedClientState","EVENT",u.key,u.newValue),u.key===this.Hc)return void Ar("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.bs.dr(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){if(this.hr){if(null!==u.key)if(this.Jc.test(u.key)){if(null==u.newValue)return e=this.Al(u.key),[2,this.Rl(e,null)];if(n=this.Pl(u.key,u.newValue))return[2,this.Rl(n.clientId,n)]}else if(this.Xc.test(u.key)){if(null!==u.newValue&&(r=this.Vl(u.key,u.newValue)))return[2,this.gl(r)]}else if(this.Zc.test(u.key)){if(null!==u.newValue&&(i=this.yl(u.key,u.newValue)))return[2,this.pl(i)]}else if(u.key===this.tl){if(null!==u.newValue&&(o=this.nl(u.newValue)))return[2,this.sl(o)]}else u.key===this.Yc&&(s=function(t){var e=Zu.ps;if(null!=t)try{var n=JSON.parse(t);Dr("number"==typeof n),e=n}catch(t){Ar("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==Zu.ps&&this.Ps(s)}else this.zc.push(u);return[2]})})})}},Object.defineProperty($l.prototype,"_l",{get:function(){return this.Gc.get(this.Wc)},enumerable:!1,configurable:!0}),$l.prototype.el=function(){this.setItem(this.Hc,this._l.qc())},$l.prototype.al=function(t,e,n){var r=new Al(this.currentUser,t,e,n),i=gl(this.persistenceKey,this.currentUser,t);this.setItem(i,r.qc())},$l.prototype.cl=function(t){var e=gl(this.persistenceKey,this.currentUser,t);this.removeItem(e)},$l.prototype.ml=function(t){var e={clientId:this.Wc,onlineState:t};this.storage.setItem(this.tl,JSON.stringify(e))},$l.prototype.El=function(t,e,n){var r=ml(this.persistenceKey,t),i=new xl(t,e,n);this.setItem(r,i.qc())},$l.prototype.Al=function(t){var e=this.Jc.exec(t);return e?e[1]:null},$l.prototype.Pl=function(t,e){var n=this.Al(t);return Sl.Bc(n,e)},$l.prototype.Vl=function(t,e){var n=this.Xc.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Al.Bc(new Bf(i),r,e)},$l.prototype.yl=function(t,e){var n=this.Zc.exec(t),r=Number(n[1]);return xl.Bc(r,e)},$l.prototype.nl=function(t){return Dl.Bc(t)},$l.prototype.gl=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.Vc.bl(e.batchId,e.state,e.error)]:(Nr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},$l.prototype.pl=function(t){return this.Vc.vl(t.targetId,t.state,t.error)},$l.prototype.Rl=function(t,e){var n=this,r=e?this.Gc.nt(t,e):this.Gc.remove(t),i=this.rl(this.Gc),o=this.rl(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.Vc.Sl(s,u).then(function(){n.Gc=r})},$l.prototype.sl=function(t){this.Gc.get(t.clientId)&&this.qu(t.onlineState)},$l.prototype.rl=function(t){var n=Yi();return t.forEach(function(t,e){n=n.Ct(e.activeTargetIds)}),n},$l),Ol=(Jl.prototype.hl=function(t){},Jl.prototype.ul=function(t,e,n){},Jl.prototype.ll=function(t){return this.Dl.Uc(t),this.Cl[t]||"not-current"},Jl.prototype.Tl=function(t,e,n){this.Cl[t]=e},Jl.prototype.fl=function(t){this.Dl.Qc(t)},Jl.prototype.dl=function(t){return this.Dl.activeTargetIds.has(t)},Jl.prototype.wl=function(t){delete this.Cl[t]},Jl.prototype.il=function(){return this.Dl.activeTargetIds},Jl.prototype.ol=function(t){return this.Dl.activeTargetIds.has(t)},Jl.prototype.start=function(){return this.Dl=new Pl,Promise.resolve()},Jl.prototype.Nh=function(t,e,n){},Jl.prototype.Il=function(t){},Jl.prototype.yr=function(){},Jl.prototype.ys=function(t){},Jl),kl=(Object.defineProperty(Ql.prototype,"Ml",{get:function(){return this.Fl},enumerable:!1,configurable:!0}),Ql.prototype.Ol=function(t,e){var u=this,a=e?e.Ll:new $i,h=e?e.xl:this.xl,c=e?e.Lt:this.Lt,f=h,l=!1,p=this.query.In()&&h.size===this.query.limit?h.last():null,d=this.query.mn()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),r=e instanceof au?e:null;r=r&&(wu(u.query,r)?r:null);var i=!!n&&u.Lt.has(n.key),o=!!r&&(r.Ge||u.Lt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.Bl(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.kl(r,p)||d&&u.kl(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=r?(f=f.add(r),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.In()||this.query.mn())for(;f.size>this.query.limit;){var n=this.query.In()?f.last():f.first();f=f.delete(n.key),c=c.delete(n.key),a.track({type:1,doc:n})}return{xl:f,Ll:a,ql:l,Lt:c}},Ql.prototype.Bl=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},Ql.prototype.Jn=function(t,e,n){var o=this,r=this.xl;this.xl=t.xl,this.Lt=t.Lt;var i=t.Ll.Mt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.kl(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Sr()}}var r,i}),this.Ul(n);var s=e?this.Ql():[],u=0===this.$l.size&&this.Ht?1:0,a=u!==this.Nl;return this.Nl=u,0!==i.length||a?{snapshot:new Zi(this.query,t.xl,r,i,t.Lt,0==u,a,!1),Wl:s}:{Wl:s}},Ql.prototype.jl=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.Jn({xl:this.xl,Ll:new $i,Lt:this.Lt,ql:!1},!1)):{Wl:[]}},Ql.prototype.Kl=function(t){return!this.Fl.has(t)&&!!this.xl.has(t)&&!this.xl.get(t).Ge},Ql.prototype.Ul=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.Fl=e.Fl.add(t)}),t.Jt.forEach(function(t){}),t.Xt.forEach(function(t){return e.Fl=e.Fl.delete(t)}),this.Ht=t.Ht)},Ql.prototype.Ql=function(){var e=this;if(!this.Ht)return[];var n=this.$l;this.$l=Hi(),this.xl.forEach(function(t){e.Kl(t.key)&&(e.$l=e.$l.add(t.key))});var r=[];return n.forEach(function(t){e.$l.has(t)||r.push(new bl(t))}),this.$l.forEach(function(t){n.has(t)||r.push(new wl(t))}),r},Ql.prototype.Gl=function(t){this.Fl=t.Yh,this.$l=Hi();var e=this.Ol(t.documents);return this.Jn(e,!0)},Ql.prototype.zl=function(){return Zi.Ut(this.query,this.xl,this.Lt,0===this.Nl)},Ql),Ll=(Kl.prototype.run=function(){this.Yl()},Kl.prototype.Yl=function(){var t=this;this.xo.xs(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new nl(this.Fu),(n=this.Jl(e))&&n.then(function(t){r.Ro.lr(function(){return e.commit().then(function(){r.yo.resolve(t)}).catch(function(t){r.Xl(t)})})}).catch(function(t){r.Xl(t)}),[2]})})})},Kl.prototype.Jl=function(t){try{var e=this.updateFunction(t);return!ci(e)&&e.catch&&e.then?e:(this.yo.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.yo.reject(t),null}},Kl.prototype.Xl=function(t){var e=this;0<this.Hl&&this.Zl(t)?(--this.Hl,this.Ro.lr(function(){return e.Yl(),Promise.resolve()})):this.yo.reject(t)},Kl.prototype.Zl=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ni(e)},Kl),Cl=(Object.defineProperty(Xl.prototype,"d_",{get:function(){return!0},enumerable:!1,configurable:!0}),Xl.prototype.subscribe=function(t){this.i_=t},Xl.prototype.listen=function(s){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return this.w_("listen()"),(r=this.r_.get(s))?(e=r.targetId,this.n_.ll(e),n=r.view.zl(),[3,4]):[3,1];case 1:return[4,this.Yu.Gh(s.We())];case 2:return i=t.sent(),o=this.n_.ll(i.targetId),e=i.targetId,[4,this.T_(s,e,"current"===o)];case 3:n=t.sent(),this.d_&&this.e_.listen(i),t.label=4;case 4:return[2,n]}})})},Xl.prototype.T_=function(u,a,h){return y(this,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return[4,this.Yu.Hh(u,!0)];case 1:return e=t.sent(),n=new kl(u,e.Yh),r=n.Ol(e.documents),i=eo.zt(a,h&&"Offline"!==this.onlineState),o=n.Jn(r,this.d_,i),this.E_(a,o.Wl),s=new Il(u,a,n),[2,(this.r_.set(u,s),this.o_.has(a)?this.o_.get(a).push(u):this.o_.set(a,[u]),o.snapshot)]}})})},Xl.prototype.Rc=function(i){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return this.w_("unlisten()"),e=this.r_.get(i),1<(n=this.o_.get(e.targetId)).length?[2,(this.o_.set(e.targetId,n.filter(function(t){return!vu(t,i)})),void this.r_.delete(i))]:this.d_?(this.n_.fl(e.targetId),this.n_.ol(e.targetId)?[3,2]:[4,this.Yu.zh(e.targetId,!1).then(function(){r.n_.wl(e.targetId),r.e_.Rc(e.targetId),r.I_(e.targetId)}).catch(pc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.I_(e.targetId),[4,this.Yu.zh(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Xl.prototype.write=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:this.w_("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.Yu.Mh(i)];case 2:return e=t.sent(),this.n_.hl(e.batchId),this.m_(e.batchId,o),[4,this.A_(e.Un)];case 3:return t.sent(),[4,this.e_.Ec()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=Jh(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},Xl.prototype.runTransaction=function(t,e,n){new Ll(t,this.Fu,e,n).run()},Xl.prototype.qh=function(n){return y(this,void 0,void 0,function(){var e,r=this;return v(this,function(t){switch(t.label){case 0:this.w_("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Yu.qh(n)];case 2:return e=t.sent(),n.Qt.forEach(function(t,e){var n=r.u_.get(e);n&&(Dr(t.Yt.size+t.Jt.size+t.Xt.size<=1),0<t.Yt.size?n.t_=!0:0<t.Jt.size?Dr(n.t_):0<t.Xt.size&&(Dr(n.t_),n.t_=!1))}),[4,this.A_(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,pc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Xl.prototype.jl=function(r,t){this.w_("applyOnlineStateChange()");var i=[];this.r_.forEach(function(t,e){var n=e.view.jl(r);n.snapshot&&i.push(n.snapshot)}),this.i_.R_(r),this.i_.mu(i),this.onlineState=r},Xl.prototype.vc=function(u,a){return y(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return v(this,function(t){switch(t.label){case 0:return this.w_("rejectListens()"),this.n_.Tl(u,"rejected",a),e=this.u_.get(u),(n=e&&e.key)?(r=(r=new xi(ei.P)).nt(n,new hu(n,Qr.min())),i=Hi().add(n),o=new to(Qr.min(),new Map,new Li(Lr),r,i),[4,this.qh(o)]):[3,2];case 1:return t.sent(),this.a_=this.a_.remove(n),this.u_.delete(u),this.P_(),[3,4];case 2:return[4,this.Yu.zh(u,!1).then(function(){return s.I_(u,a)}).catch(pc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},Xl.prototype.$c=function(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:this.w_("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Yu.Oh(r)];case 2:return n=t.sent(),this.V_(e,null),this.g_(e),this.n_.ul(e,"acknowledged"),[4,this.A_(n)];case 3:return t.sent(),[3,6];case 4:return[4,pc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Xl.prototype.xc=function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.w_("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Yu.Bh(n)];case 2:return e=t.sent(),this.V_(n,r),this.g_(n),this.n_.ul(n,"rejected",r),[4,this.A_(e)];case 3:return t.sent(),[3,6];case 4:return[4,pc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Xl.prototype.y_=function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:this.e_.sc()||Nr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Yu.no()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.__.get(e)||[]).push(o),this.__.set(e,n),[3,4]);case 3:return r=t.sent(),i=Jh(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},Xl.prototype.g_=function(t){(this.__.get(t)||[]).forEach(function(t){t.resolve()}),this.__.delete(t)},Xl.prototype.p_=function(e){this.__.forEach(function(t){t.forEach(function(t){t.reject(new Xr(Yr.CANCELLED,e))})}),this.__.clear()},Xl.prototype.m_=function(t,e){var n=this.l_[this.currentUser.Ma()];n=(n=n||new xi(Lr)).nt(t,e),this.l_[this.currentUser.Ma()]=n},Xl.prototype.V_=function(t,e){var n=this.l_[this.currentUser.Ma()];if(n){var r=n.get(t);r&&(e?r.reject(e):r.resolve(),n=n.remove(t)),this.l_[this.currentUser.Ma()]=n}},Xl.prototype.I_=function(t,e){var n=this;void 0===e&&(e=null),this.n_.fl(t);for(var r=0,i=this.o_.get(t);r<i.length;r++){var o=i[r];this.r_.delete(o),e&&this.i_.b_(o,e)}this.o_.delete(t),this.d_&&this.c_.aa(t).forEach(function(t){n.c_.Mi(t)||n.v_(t)})},Xl.prototype.v_=function(t){var e=this.a_.get(t);null!==e&&(this.e_.Rc(e),this.a_=this.a_.remove(t),this.u_.delete(e),this.P_())},Xl.prototype.E_=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof wl?(this.c_.Fi(i.key,t),this.S_(i)):i instanceof bl?(Nr("SyncEngine","Document no longer in limbo: "+i.key),this.c_.$i(i.key,t),this.c_.Mi(i.key)||this.v_(i.key)):Sr()}},Xl.prototype.S_=function(t){var e=t.key;this.a_.get(e)||(Nr("SyncEngine","New document in limbo: "+e),this.h_.push(e),this.P_())},Xl.prototype.P_=function(){for(;0<this.h_.length&&this.a_.size<this.s_;){var t=this.h_.shift(),e=this.f_.next();this.u_.set(e,new El(t)),this.a_=this.a_.nt(t,e),this.e_.listen(new _i(fu.hn(t.path).We(),e,2,Zu.ps))}},Xl.prototype.D_=function(){return this.a_},Xl.prototype.C_=function(){return this.h_},Xl.prototype.A_=function(r,a){return y(this,void 0,void 0,function(){var o,s,e,u=this;return v(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.r_.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.Ol(r);return n.ql?u.Yu.Hh(i.query,!1).then(function(t){var e=t.documents;return i.view.Ol(e,n)}):n}).then(function(t){var e=a&&a.Qt.get(i.targetId),n=i.view.Jn(t,u.d_,e);if(u.E_(i.targetId,n.Wl),n.snapshot){u.d_&&u.n_.Tl(i.targetId,n.snapshot.fromCache?"not-current":"current"),o.push(n.snapshot);var r=$u.Rs(i.targetId,n.snapshot);s.push(r)}}))}),[4,Promise.all(e)];case 1:return t.sent(),this.i_.mu(o),[4,this.Yu.Wh(s)];case 2:return t.sent(),[2]}})})},Xl.prototype.w_=function(t){},Xl.prototype.Oc=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Nr("SyncEngine","User change. New user:",n.Ma()),[4,this.Yu.Nh(n)]);case 1:return e=t.sent(),this.currentUser=n,this.p_("'waitForPendingWrites' promise is rejected due to a user change."),this.n_.Nh(n,e.kh,e.xh),[4,this.A_(e.$h)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Xl.prototype.enableNetwork=function(){return this.e_.enableNetwork()},Xl.prototype.disableNetwork=function(){return this.e_.disableNetwork()},Xl.prototype.xe=function(t){var e=this.u_.get(t);if(e&&e.t_)return Hi().add(e.key);var n=Hi(),r=this.o_.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++){var s=o[i],u=this.r_.get(s);n=n.Ct(u.view.Ml)}return n},Xl),Vl=(n(Yl,Tl=Cl),Object.defineProperty(Yl.prototype,"d_",{get:function(){return!0===this.F_},enumerable:!1,configurable:!0}),Yl.prototype.enableNetwork=function(){return this.Yu.cr(!0),Tl.prototype.enableNetwork.call(this)},Yl.prototype.disableNetwork=function(){return this.Yu.cr(!1),Tl.prototype.disableNetwork.call(this)},Yl.prototype.N_=function(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.Yu.Hh(r.query,!0)];case 1:return e=t.sent(),n=r.view.Gl(e),[2,(this.F_&&this.E_(r.targetId,n.Wl),n)]}})})},Yl.prototype.jl=function(t,e){this.d_&&0===e&&(Tl.prototype.jl.call(this,t,e),this.n_.Il(t)),this.d_||1!==e||Tl.prototype.jl.call(this,t,e)},Yl.prototype.bl=function(n,r,i){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.w_("applyBatchState()"),[4,this.Yu.Xh(n)];case 1:return null===(e=t.sent())?[3,6]:"pending"!==r?[3,3]:[4,this.e_.Ec()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===r||"rejected"===r?(this.V_(n,i||null),this.Yu.Zh(n)):Sr(),t.label=4;case 4:return[4,this.A_(e)];case 5:return t.sent(),[3,7];case 6:Nr("SyncEngine","Cannot apply mutation batch with id: "+n),t.label=7;case 7:return[2]}})})},Yl.prototype.Lc=function(h){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a=this;return v(this,function(t){switch(t.label){case 0:return!0!==h||!0===this.F_?[3,3]:(e=this.n_.il(),[4,this.k_(e.F(),!0)]);case 1:return n=t.sent(),this.F_=!0,[4,this.e_.Lc(!0)];case 2:for(t.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.e_.listen(o);return[3,7];case 3:return!1!==h||!1===this.F_?[3,7]:(s=[],u=Promise.resolve(),this.o_.forEach(function(t,e){a.n_.dl(e)?s.push(e):u=u.then(function(){return a.I_(e),a.Yu.zh(e,!0)}),a.e_.Rc(e)}),[4,u]);case 4:return t.sent(),[4,this.k_(s,!1)];case 5:return t.sent(),this.x_(),this.F_=!1,[4,this.e_.Lc(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}})})},Yl.prototype.x_=function(){var n=this;this.u_.forEach(function(t,e){n.e_.Rc(e)}),this.c_.ua(),this.u_=new Map,this.a_=new xi(ei.P)},Yl.prototype.k_=function(d,t){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l,p;return v(this,function(t){switch(t.label){case 0:e=[],n=[],r=0,i=d,t.label=1;case 1:return r<i.length?(o=i[r],s=void 0,(u=this.o_.get(o))&&0!==u.length?[4,this.Yu.Gh(u[0].We())]:[3,7]):[3,13];case 2:s=t.sent(),a=0,h=u,t.label=3;case 3:return a<h.length?(c=h[a],f=this.r_.get(c),[4,this.N_(f)]):[3,6];case 4:(l=t.sent()).snapshot&&n.push(l.snapshot),t.label=5;case 5:return a++,[3,3];case 6:return[3,11];case 7:return[4,this.Yu.ta(o)];case 8:return p=t.sent(),[4,this.Yu.Gh(p)];case 9:return s=t.sent(),[4,this.T_(this.M_(p),o,!1)];case 10:t.sent(),t.label=11;case 11:e.push(s),t.label=12;case 12:return r++,[3,1];case 13:return[2,(this.i_.mu(n),e)]}})})},Yl.prototype.M_=function(t){return new fu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},Yl.prototype.Dr=function(){return this.Yu.Dr()},Yl.prototype.vl=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.F_?(Nr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!this.o_.has(r))return[3,8];switch(i){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,this.Yu.si()];case 3:return e=t.sent(),n=to.Gt(r,"current"===i),[4,this.A_(e,n)];case 4:return t.sent(),[3,8];case 5:return[4,this.Yu.zh(r,!0)];case 6:return t.sent(),this.I_(r,o),[3,8];case 7:Sr(),t.label=8;case 8:return[2]}})})},Yl.prototype.Sl=function(l,p){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f=this;return v(this,function(t){switch(t.label){case 0:if(!this.F_)return[3,10];e=0,n=l,t.label=1;case 1:return e<n.length?(r=n[e],this.o_.has(r)?(Nr("SyncEngine","Adding an already active target "+r),[3,5]):[4,this.Yu.ta(r)]):[3,6];case 2:return i=t.sent(),[4,this.Yu.Gh(i)];case 3:return o=t.sent(),[4,this.T_(this.M_(i),o.targetId,!1)];case 4:t.sent(),this.e_.listen(o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return u.o_.has(e)?[4,u.Yu.zh(e,!1).then(function(){f.e_.Rc(e),f.I_(e)}).catch(pc)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=this,a=0,h=p,t.label=7;case 7:return a<h.length?(c=h[a],[5,s(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})},Yl),Ul=(Wl.prototype.listen=function(u){return y(this,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.L_.get(e))||(n=!0,r=new _l),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.Vc.listen(e)];case 2:return i.O_=t.sent(),[3,4];case 3:return o=t.sent(),s=Jh(o,"Initialization of query '"+mu(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.L_.set(e,r),r.listeners.push(u),u.jl(this.onlineState),r.O_&&u.q_(r.O_)&&this.U_(),[2]}})})},Wl.prototype.Rc=function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){return e=o.query,n=!1,(r=this.L_.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.L_.delete(e),this.Vc.Rc(e))]:[2]})})},Wl.prototype.mu=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.L_.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].q_(i)&&(e=!0);s.O_=i}}e&&this.U_()},Wl.prototype.b_=function(t,e){var n=this.L_.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.L_.delete(t)},Wl.prototype.R_=function(i){this.onlineState=i;var o=!1;this.L_.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].jl(i)&&(o=!0)}),o&&this.U_()},Wl.prototype.Q_=function(t){this.B_.add(t),t.next()},Wl.prototype.W_=function(t){this.B_.delete(t)},Wl.prototype.U_=function(){this.B_.forEach(function(t){t.next()})},Wl),jl=(Hl.prototype.q_=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Zi(t.query,t.docs,t.Ot,e,t.Lt,t.fromCache,t.Bt,!0)}var o=!1;return this.K_?this.z_(t)&&(this.j_.next(t),o=!0):this.H_(t,this.onlineState)&&(this.Y_(t),o=!0),this.G_=t,o},Hl.prototype.onError=function(t){this.j_.error(t)},Hl.prototype.jl=function(t){this.onlineState=t;var e=!1;return this.G_&&!this.K_&&this.H_(this.G_,t)&&(this.Y_(this.G_),e=!0),e},Hl.prototype.H_=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.J_&&n||t.docs._()&&"Offline"!==e)},Hl.prototype.z_=function(t){if(0<t.docChanges.length)return!0;var e=this.G_&&this.G_.hasPendingWrites!==t.hasPendingWrites;return!(!t.Bt&&!e)&&!0===this.options.includeMetadataChanges},Hl.prototype.Y_=function(t){t=Zi.Ut(t.query,t.docs,t.Lt,t.fromCache),this.K_=!0,this.j_.next(t)},Hl),Ml=(zl.prototype.Fh=function(t){this.X_=t},zl.prototype._s=function(e,r,i,o){var s=this;return r.En()||i.isEqual(Qr.min())?this.Z_(e,r):this.X_.us(e,o).next(function(t){var n=s.tf(r,t);return(r.In()||r.mn())&&s.ql(r.nn,n,o,i)?s.Z_(e,r):(Tr()<=p.DEBUG&&Nr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),mu(r)),s.X_._s(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},zl.prototype.tf=function(n,t){var r=new Li(bu(n));return t.forEach(function(t,e){e instanceof au&&wu(n,e)&&(r=r.add(e))}),r},zl.prototype.ql=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},zl.prototype.Z_=function(t,e){return Tr()<=p.DEBUG&&Nr("IndexFreeQueryEngine","Using full collection scan to execute query:",mu(e)),this.X_._s(t,e,Qr.min())},zl),Fl=(Gl.prototype.Jr=function(t){return Yu.resolve(0===this.ns.length)},Gl.prototype.Xr=function(t,e,n,r){var i=this.ef;this.ef++,0<this.ns.length&&this.ns[this.ns.length-1];var o=new Hu(i,e,n,r);this.ns.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.nf=this.nf.add(new yc(a.key,i)),this.ss.Us(t,a.key.path.p())}return Yu.resolve(o)},Gl.prototype.Zr=function(t,e){return Yu.resolve(this.sf(e))},Gl.prototype.eo=function(t,e){var n=e+1,r=this.if(n),i=r<0?0:r;return Yu.resolve(this.ns.length>i?this.ns[i]:null)},Gl.prototype.no=function(){return Yu.resolve(0===this.ns.length?-1:this.ef-1)},Gl.prototype.so=function(t){return Yu.resolve(this.ns.slice())},Gl.prototype.os=function(t,e){var n=this,r=new yc(e,0),i=new yc(e,Number.POSITIVE_INFINITY),o=[];return this.nf.vt([r,i],function(t){var e=n.sf(t.la);o.push(e)}),Yu.resolve(o)},Gl.prototype.ls=function(t,e){var r=this,i=new Li(Lr);return e.forEach(function(t){var e=new yc(t,0),n=new yc(t,Number.POSITIVE_INFINITY);r.nf.vt([e,n],function(t){i=i.add(t.la)})}),Yu.resolve(this.rf(i))},Gl.prototype.Es=function(t,e){var n=e.path,r=n.length+1,i=n;ei.W(i)||(i=i.child(""));var o=new yc(new ei(i),0),s=new Li(Lr);return this.nf.St(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.la)),!0)},o),Yu.resolve(this.rf(s))},Gl.prototype.rf=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.sf(t);null!==e&&r.push(e)}),r},Gl.prototype.ro=function(n,r){var i=this;Dr(0===this.hf(r.batchId,"removed")),this.ns.shift();var o=this.nf;return Yu.forEach(r.mutations,function(t){var e=new yc(t.key,r.batchId);return o=o.delete(e),i.wi.Qr(n,t.key)}).next(function(){i.nf=o})},Gl.prototype.oo=function(t){},Gl.prototype.Mi=function(t,e){var n=new yc(e,0),r=this.nf.Dt(n);return Yu.resolve(e.isEqual(r&&r.key))},Gl.prototype.ho=function(t){return this.ns.length,Yu.resolve()},Gl.prototype.hf=function(t,e){return this.if(t)},Gl.prototype.if=function(t){return 0===this.ns.length?0:t-this.ns[0].batchId},Gl.prototype.sf=function(t){var e=this.if(t);return e<0||e>=this.ns.length?null:this.ns[e]},Gl),ql=(Bl.prototype.jn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.af(e);return this.docs=this.docs.nt(r,{Ys:e,size:s,readTime:n}),this.size+=s-o,this.ss.Us(t,r.path.p())},Bl.prototype.Gn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Bl.prototype.zn=function(t,e){var n=this.docs.get(e);return Yu.resolve(n?n.Ys:null)},Bl.prototype.getEntries=function(t,e){var n=this,r=Fi();return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.Ys:null)}),Yu.resolve(r)},Bl.prototype._s=function(t,e,n){for(var r=Bi(),i=new ei(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),u=s.key,a=s.value,h=a.Ys,c=a.readTime;if(!e.path.D(u.path))break;c.o(n)<=0||h instanceof au&&wu(e,h)&&(r=r.nt(h.key,h))}return Yu.resolve(r)},Bl.prototype.uf=function(t,e){return Yu.forEach(this.docs,function(t){return e(t)})},Bl.prototype.oi=function(t){return new Bl.hi(this)},Bl.prototype.ui=function(t){return Yu.resolve(this.size)},Bl);function Bl(t,e){this.ss=t,this.af=e,this.docs=new xi(ei.P),this.size=0}function Gl(t,e){this.ss=t,this.wi=e,this.ns=[],this.ef=1,this.nf=new Li(yc.na)}function zl(){}function Hl(t,e,n){this.query=t,this.j_=e,this.K_=!1,this.G_=null,this.onlineState="Unknown",this.options=n||{}}function Wl(t){this.Vc=t,this.L_=new Wr(function(t){return gu(t)},vu),this.onlineState="Unknown",this.B_=new Set,this.Vc.subscribe(this)}function Yl(t,e,n,r,i,o){var s=this;return(s=Tl.call(this,t,e,n,r,i,o)||this).Yu=t,s.F_=void 0,s}function Xl(t,e,n,r,i,o){this.Yu=t,this.e_=e,this.Fu=n,this.n_=r,this.currentUser=i,this.s_=o,this.i_=null,this.r_=new Wr(function(t){return gu(t)},vu),this.o_=new Map,this.h_=[],this.a_=new xi(ei.P),this.u_=new Map,this.c_=new dc,this.l_={},this.__=new Map,this.f_=Fa.di(),this.onlineState="Unknown"}function Kl(t,e,n,r){this.Ro=t,this.Fu=e,this.updateFunction=n,this.yo=r,this.Hl=5,this.xo=new ha(this.Ro,"transaction_retry")}function Ql(t,e){this.query=t,this.Fl=e,this.Nl=null,this.Ht=!1,this.$l=Hi(),this.Lt=Hi(),this.kl=bu(t),this.xl=new Ji(this.kl)}function Jl(){this.Dl=new Pl,this.Cl={},this.Vc=null,this.qu=null,this.Ps=null}function $l(t,e,n,r,i){this.window=t,this.bs=e,this.persistenceKey=n,this.Wc=r,this.Vc=null,this.qu=null,this.Ps=null,this.jc=this.Kc.bind(this),this.Gc=new xi(Lr),this.hr=!1,this.zc=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Hc=vl(this.persistenceKey,this.Wc),this.Yc="firestore_sequence_number_"+this.persistenceKey,this.Gc=this.Gc.nt(this.Wc,new Pl),this.Jc=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Xc=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Zc=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.tl="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.jc)}function Zl(){this.activeTargetIds=Yi()}function tp(t,e){this.clientId=t,this.onlineState=e}function ep(t,e){this.clientId=t,this.activeTargetIds=e}function np(t,e,n){this.targetId=t,this.state=e,this.error=n}function rp(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function ip(t){var e=this;return(e=Nl.call(this)||this).ci=t,e}ql.hi=(n(ip,Nl=Xu),ip.prototype.Jn=function(n){var r=this,i=[];return this.Un.forEach(function(t,e){e?i.push(r.ci.jn(n,e,r.readTime)):r.ci.Gn(t)}),Yu.Bn(i)},ip.prototype.Hn=function(t,e){return this.ci.zn(t,e)},ip.prototype.Yn=function(t,e){return this.ci.getEntries(t,e)},ip);var op,sp,up=(kp.prototype.pe=function(t,n){return this.cf.forEach(function(t,e){return n(e)}),Yu.resolve()},kp.prototype.mi=function(t){return Yu.resolve(this.lastRemoteSnapshotVersion)},kp.prototype.Ai=function(t){return Yu.resolve(this.lf)},kp.prototype.Ti=function(t){return this.highestTargetId=this.ff.next(),Yu.resolve(this.highestTargetId)},kp.prototype.Ri=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.lf&&(this.lf=e),Yu.resolve()},kp.prototype.Vi=function(t){this.cf.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ff=new Fa(e),this.highestTargetId=e),t.sequenceNumber>this.lf&&(this.lf=t.sequenceNumber)},kp.prototype.Pi=function(t,e){return this.Vi(e),this.targetCount+=1,Yu.resolve()},kp.prototype.yi=function(t,e){return this.Vi(e),Yu.resolve()},kp.prototype.pi=function(t,e){return this.cf.delete(e.target),this._f.aa(e.targetId),--this.targetCount,Yu.resolve()},kp.prototype.vi=function(n,r,i){var o=this,s=0,u=[];return this.cf.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.cf.delete(t),u.push(o.bi(n,e.targetId)),s++)}),Yu.Bn(u).next(function(){return s})},kp.prototype.Si=function(t){return Yu.resolve(this.targetCount)},kp.prototype.Di=function(t,e){var n=this.cf.get(e)||null;return Yu.resolve(n)},kp.prototype.Ci=function(t,e,n){return this._f.ra(e,n),Yu.resolve()},kp.prototype.Ni=function(e,t,n){this._f.ha(t,n);var r=this.persistence.wi,i=[];return r&&t.forEach(function(t){i.push(r.Qr(e,t))}),Yu.Bn(i)},kp.prototype.bi=function(t,e){return this._f.aa(e),Yu.resolve()},kp.prototype.ki=function(t,e){var n=this._f.ca(e);return Yu.resolve(n)},kp.prototype.Mi=function(t,e){return Yu.resolve(this._f.Mi(e))},kp),ap=(Op.prototype.start=function(){return Promise.resolve()},Op.prototype.yr=function(){return this.Qi=!1,Promise.resolve()},Object.defineProperty(Op.prototype,"hr",{get:function(){return this.Qi},enumerable:!1,configurable:!0}),Op.prototype.ar=function(){},Op.prototype.kr=function(){return this.ss},Op.prototype.Cr=function(t){var e=this.df[t.Ma()];return e||(e=new Fl(this.ss,this.wi),this.df[t.Ma()]=e),e},Op.prototype.Nr=function(){return this.Xi},Op.prototype.$r=function(){return this.es},Op.prototype.runTransaction=function(t,e,n){var r=this;Nr("MemoryPersistence","Starting transaction:",t);var i=new hp(this.Ui.next());return this.wi.Tf(),n(i).next(function(t){return r.wi.Ef(i).next(function(){return t})}).On().then(function(t){return i.ts(),t})},Op.prototype.If=function(e,n){return Yu.qn(Object.values(this.df).map(function(t){return function(){return t.Mi(e,n)}}))},Op),hp=(n(Rp,sp=Qu),Rp),cp=(Pp.Rf=function(t){return new Pp(t)},Object.defineProperty(Pp.prototype,"Pf",{get:function(){if(this.Af)return this.Af;throw Sr()},enumerable:!1,configurable:!0}),Pp.prototype.Fi=function(t,e,n){return this.mf.Fi(n,e),this.Pf.delete(n),Yu.resolve()},Pp.prototype.$i=function(t,e,n){return this.mf.$i(n,e),this.Pf.add(n),Yu.resolve()},Pp.prototype.Qr=function(t,e){return this.Pf.add(e),Yu.resolve()},Pp.prototype.removeTarget=function(t,e){var n=this;this.mf.aa(e.targetId).forEach(function(t){return n.Pf.add(t)});var r=this.persistence.Nr();return r.ki(t,e.targetId).next(function(t){t.forEach(function(t){return n.Pf.add(t)})}).next(function(){return r.pi(t,e)})},Pp.prototype.Tf=function(){this.Af=new Set},Pp.prototype.Ef=function(t){var n=this,r=this.persistence.$r().oi();return Yu.forEach(this.Pf,function(e){return n.Vf(t,e).next(function(t){t||r.Gn(e)})}).next(function(){return n.Af=null,r.apply(t)})},Pp.prototype.Gr=function(t,e){var n=this;return this.Vf(t,e).next(function(t){t?n.Pf.delete(e):n.Pf.add(e)})},Pp.prototype.wf=function(t){return 0},Pp.prototype.Vf=function(t,e){var n=this;return Yu.qn([function(){return Yu.resolve(n.mf.Mi(e))},function(){return n.persistence.Nr().Mi(t,e)},function(){return n.persistence.If(t,e)}])},Pp),fp=(Dp.prototype.Eu=function(t){this.pf=t},Dp.prototype._u=function(t){this.bf=t},Dp.prototype.onMessage=function(t){this.vf=t},Dp.prototype.close=function(){this.yf()},Dp.prototype.send=function(t){this.gf(t)},Dp.prototype.Sf=function(){this.pf()},Dp.prototype.Df=function(t){this.bf(t)},Dp.prototype.Cf=function(t){this.vf(t)},Dp),lp={BatchGetDocuments:"batchGet",Commit:"commit"},pp="gl-js/ fire/"+Er,dp=(Sp.prototype.Nf=function(t,e){if(e)for(var n in e.Ba)e.Ba.hasOwnProperty(n)&&(t[n]=e.Ba[n]);t["X-Goog-Api-Client"]=pp},Sp.prototype.Du=function(a,r,i){var h=this,c=this.$f(a);return new Promise(function(o,s){var u=new wr;u.listenOnce(gr.COMPLETE,function(){try{switch(u.getLastErrorCode()){case vr.NO_ERROR:var t=u.getResponseJson();Nr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case vr.TIMEOUT:Nr("Connection",'RPC "'+a+'" timed out'),s(new Xr(Yr.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var e=u.getStatus();if(Nr("Connection",'RPC "'+a+'" failed with status:',e,"response text:",u.getResponseText()),0<e){var n=u.getResponseJson().error;if(n&&n.status&&n.message){var r=(i=n.status.toLowerCase().replace("_","-"),0<=Object.values(Yr).indexOf(i)?i:Yr.UNKNOWN);s(new Xr(r,n.message))}else s(new Xr(Yr.UNKNOWN,"Server responded with status "+u.getStatus()))}else Nr("Connection",'RPC "'+a+'" failed'),s(new Xr(Yr.UNAVAILABLE,"Connection failed."));break;default:Sr()}}finally{Nr("Connection",'RPC "'+a+'" completed.')}var i});var t=Object.assign({},r);delete t.database;var e=JSON.stringify(t);Nr("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.Nf(n,i),u.send(c,"POST",e,n,15)})},Sp.prototype.Cu=function(t,e,n){return this.Du(t,e,n)},Sp.prototype.Iu=function(t,e){var n,r,i=[this.Ff,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=yr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Nf(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=g().indexOf("Electron/")||0<=(r=g()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=g().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Nr("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new fp({gf:function(t){f?Nr("Connection","Not sending because WebChannel is closed:",t):(c||(Nr("Connection","Opening WebChannel transport."),h.open(),c=!0),Nr("Connection","WebChannel sending:",t),h.send(t))},yf:function(){return h.close()}});return a(mr.EventType.OPEN,function(){f||Nr("Connection","WebChannel transport opened.")}),a(mr.EventType.CLOSE,function(){f||(f=!0,Nr("Connection","WebChannel transport closed"),l.Df())}),a(mr.EventType.ERROR,function(t){f||(f=!0,function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(_r.logLevel<=p.WARN){var r=e.map(xr);_r.warn.apply(_r,d(["Firestore ("+Er+"): Connection"],r))}}("Connection","WebChannel transport errored:",t),l.Df(new Xr(Yr.UNAVAILABLE,"The operation could not be completed")))}),a(mr.EventType.MESSAGE,function(t){var e;if(!f){var n=t.data[0];Dr(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Nr("Connection","WebChannel received error:",r);var i=r.status,o=function(){var t=Ii[i];if(void 0!==t)return Ai(t)}(),s=r.message;void 0===o&&(o=Yr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.Df(new Xr(o,s)),h.close()}else Nr("Connection","WebChannel received:",n),l.Cf(n)}}),setTimeout(function(){l.Sf()},0),l},Sp.prototype.$f=function(t){var e=lp[t];return this.Ff+"/v1/projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents:"+e},Sp),yp=(xp.prototype.nc=function(t){this.Lf.push(t)},xp.prototype.yr=function(){window.removeEventListener("online",this.kf),window.removeEventListener("offline",this.Mf)},xp.prototype.Bf=function(){window.addEventListener("online",this.kf),window.addEventListener("offline",this.Mf)},xp.prototype.xf=function(){Nr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Lf;t<e.length;t++)(0,e[t])(0)},xp.prototype.Of=function(){Nr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Lf;t<e.length;t++)(0,e[t])(1)},xp.Hi=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},xp),vp=(Ap.prototype.nc=function(t){},Ap.prototype.yr=function(){},Ap),gp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",mp=(Np.prototype.initialize=function(n){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.n_=this.qf(n),this.persistence=this.Uf(n),[4,this.persistence.start()];case 1:return t.sent(),this.Qf=this.Wf(n),this.Yu=this.jf(n),this.e_=this.Kf(n),this.Vc=this.Gf(n),this.zf=this.Hf(n),this.n_.qu=function(t){return e.Vc.jl(t,1)},this.e_.Vc=this.Vc,[4,this.Yu.start()];case 2:return t.sent(),[4,this.n_.start()];case 3:return t.sent(),[4,this.e_.start()];case 4:return t.sent(),[4,this.e_.Lc(this.Vc.d_)];case 5:return t.sent(),[2]}})})},Np.prototype.Hf=function(t){return new Ul(this.Vc)},Np.prototype.Wf=function(t){return null},Np.prototype.jf=function(t){return e=this.persistence,n=new Ml,r=t.Yf,new sc(e,n,r);var e,n,r},Np.prototype.Uf=function(t){if(t.Xf.Jf)throw new Xr(Yr.FAILED_PRECONDITION,gp);return new ap(cp.Rf)},Np.prototype.Kf=function(t){var e=this;return new il(this.Yu,t.Fu,t.Ro,function(t){return e.Vc.jl(t,0)},new(yp.Hi()?yp:vp))},Np.prototype.qf=function(t){return new Ol},Np.prototype.Gf=function(t){return e=this.Yu,n=this.e_,r=t.Fu,i=this.n_,o=t.Yf,s=t.s_,new Cl(e,n,r,i,o,s);var e,n,r,i,o,s},Np.prototype.clearPersistence=function(t){throw new Xr(Yr.FAILED_PRECONDITION,gp)},Np),wp=(n(Tp,op=mp),Tp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return[4,op.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,this.persistence.or(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.Vc.Lc(e)];case 1:return t.sent(),this.Qf&&(e&&!this.Qf.hr?this.Qf.start(this.Yu):e||this.Qf.stop()),[2]}})})})];case 2:return t.sent(),[2]}})})},Tp.prototype.jf=function(t){return e=this.persistence,n=new Ml,r=t.Yf,new fc(e,n,r);var e,n,r},Tp.prototype.Gf=function(t){var e,n,r,i,o,s,u=(e=this.Yu,n=this.e_,r=t.Fu,i=this.n_,o=t.Yf,s=t.s_,new Vl(e,n,r,i,o,s));return this.n_ instanceof Rl&&(this.n_.Vc=u),u},Tp.prototype.Wf=function(t){var e=this.persistence.wi.Or;return new ic(e,t.Ro)},Tp.prototype.Uf=function(t){var e=Qa.Mr(t.Zf),n=mf(t.Zf.s);return new Qa(t.Xf.synchronizeTabs,e,t.clientId,ec.ah(t.Xf.cacheSizeBytes),t.Ro,Wh(),"undefined"!=typeof document?document:null,n,this.n_,t.Xf.qi)},Tp.prototype.qf=function(t){if(t.Xf.Jf&&t.Xf.synchronizeTabs){var e=Wh();if(!Rl.Hi(e))throw new Xr(Yr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Qa.Mr(t.Zf);return new Rl(e,t.Ro,n,t.clientId,t.Yf)}return new Ol},Tp.prototype.clearPersistence=function(t){var e=Qa.Mr(t);return Qa.clearPersistence(e)},Tp),bp=(_p.prototype.start=function(t,e,n){var r=this;this.Su(),this.Zf=t;var i=new aa,o=new aa,s=!1;return this.credentials.Qa(function(t){if(!s)return s=!0,Nr("FirestoreClient","Initializing. user=",t.uid),r.td(e,n,t,o).then(i.resolve,i.reject);r.Ro.dr(function(){return r.e_.Oc(t)})}),this.Ro.lr(function(){return i.promise}),o.promise},_p.prototype.enableNetwork=function(){var t=this;return this.Su(),this.Ro.enqueue(function(){return t.Vc.enableNetwork()})},_p.prototype.td=function(h,c,f,l){return y(this,void 0,void 0,function(){var r,i,o,s,u,a=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,(u=this.Zf,Promise.resolve(new dp(u)))];case 1:return r=t.sent(),i=mf(this.Zf.s),e=r,n=this.credentials,o=new el(e,n,i),[4,h.initialize({Ro:this.Ro,Zf:this.Zf,Fu:o,clientId:this.clientId,Yf:f,s_:100,Xf:c})];case 2:return t.sent(),this.persistence=h.persistence,this.n_=h.n_,this.Yu=h.Yu,this.e_=h.e_,this.Vc=h.Vc,this.Qf=h.Qf,this.ed=h.zf,this.persistence.ar(function(){return y(a,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),l.resolve(),[3,4];case 3:if(s=t.sent(),l.reject(s),!this.nd(s))throw s;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+s),this.td(new mp,{Jf:!1},f,l))];case 4:return[2]}var e,n})})},_p.prototype.nd=function(t){return"FirebaseError"===t.name?t.code===Yr.FAILED_PRECONDITION||t.code===Yr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},_p.prototype.Su=function(){if(this.Ro.Oo)throw new Xr(Yr.FAILED_PRECONDITION,"The client has already been terminated.")},_p.prototype.disableNetwork=function(){var t=this;return this.Su(),this.Ro.enqueue(function(){return t.Vc.disableNetwork()})},_p.prototype.terminate=function(){var t=this;return this.Ro.Qo(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Qf&&this.Qf.stop(),[4,this.e_.yr()];case 1:return t.sent(),[4,this.n_.yr()];case 2:return t.sent(),[4,this.persistence.yr()];case 3:return t.sent(),this.credentials.Wa(),[2]}})})})},_p.prototype.waitForPendingWrites=function(){var t=this;this.Su();var e=new aa;return this.Ro.lr(function(){return t.Vc.y_(e)}),e.promise},_p.prototype.listen=function(t,e,n){var r=this;this.Su();var i=new jl(t,e,n);return this.Ro.lr(function(){return r.ed.listen(i)}),i},_p.prototype.Rc=function(t){var e=this;this.sd||this.Ro.lr(function(){return e.ed.Rc(t)})},_p.prototype.rd=function(o){return y(this,void 0,void 0,function(){var i,e=this;return v(this,function(t){switch(t.label){case 0:return this.Su(),i=new aa,[4,this.Ro.enqueue(function(){return y(e,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Yu.Kh(o)];case 1:return(e=t.sent())instanceof au?i.resolve(e):e instanceof hu?i.resolve(null):i.reject(new Xr(Yr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=Jh(n,"Failed to get document '"+o+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})},_p.prototype.od=function(a){return y(this,void 0,void 0,function(){var u,e=this;return v(this,function(t){switch(t.label){case 0:return this.Su(),u=new aa,[4,this.Ro.enqueue(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Yu.Hh(a,!0)];case 1:return e=t.sent(),n=new kl(a,e.Yh),r=n.Ol(e.documents),i=n.Jn(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Jh(o,"Failed to execute query '"+a+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})},_p.prototype.write=function(t){var e=this;this.Su();var n=new aa;return this.Ro.lr(function(){return e.Vc.write(t,n)}),n.promise},_p.prototype.s=function(){return this.Zf.s},_p.prototype.Q_=function(t){var e=this;this.Su(),this.Ro.lr(function(){return e.ed.Q_(t),Promise.resolve()})},_p.prototype.W_=function(t){var e=this;this.sd||this.Ro.lr(function(){return e.ed.W_(t),Promise.resolve()})},Object.defineProperty(_p.prototype,"sd",{get:function(){return this.Ro.Oo},enumerable:!1,configurable:!0}),_p.prototype.transaction=function(t){var e=this;this.Su();var n=new aa;return this.Ro.lr(function(){return e.Vc.runTransaction(e.Ro,t,n),Promise.resolve()}),n.promise},_p),Ip=(Ep.prototype.next=function(t){this.hd(this.observer.next,t)},Ep.prototype.error=function(t){this.hd(this.observer.error,t)},Ep.prototype.ad=function(){this.muted=!0},Ep.prototype.hd=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Ep);function Ep(t){this.observer=t,this.muted=!1}function _p(t,e){this.credentials=t,this.Ro=e,this.clientId=Or.t()}function Tp(){return null!==op&&op.apply(this,arguments)||this}function Np(){}function Ap(){}function xp(){var t=this;this.kf=function(){return t.xf()},this.Mf=function(){return t.Of()},this.Lf=[],this.Bf()}function Sp(t){this.s=t.s;var e=t.ssl?"https":"http";this.Ff=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function Dp(t){this.gf=t.gf,this.yf=t.yf}function Pp(t){this.persistence=t,this.mf=new dc,this.Af=null}function Rp(t){var e=this;return(e=sp.call(this)||this).Li=t,e}function Op(t){var e=this;this.df={},this.Ui=new Zu(0),this.Qi=!1,this.Qi=!0,this.wi=t(this),this.Xi=new up(this),this.ss=new ya,this.es=new ql(this.ss,function(t){return e.wi.wf(t)})}function kp(t){this.persistence=t,this.cf=new Wr(function(t){return yi(t)},vi),this.lastRemoteSnapshotVersion=Qr.min(),this.highestTargetId=0,this.lf=0,this._f=new dc,this.targetCount=0,this.ff=Fa.fi()}function Lp(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Cp=(qp.prototype._d=function(t){switch(go(t)){case 0:return null;case 1:return t.booleanValue;case 2:return To(t.integerValue||t.doubleValue);case 3:return this.fd(t.timestampValue);case 4:return this.dd(t);case 5:return t.stringValue;case 6:return new qc(No(t.bytesValue));case 7:return this.wd(t.referenceValue);case 8:return this.Td(t.geoPointValue);case 9:return this.Ed(t.arrayValue);case 10:return this.Id(t.mapValue);default:throw Sr()}},qp.prototype.Id=function(t){var n=this,r={};return qr(t.fields||{},function(t,e){r[t]=n._d(e)}),r},qp.prototype.Td=function(t){return new cf(To(t.latitude),To(t.longitude))},qp.prototype.Ed=function(t){var e=this;return(t.values||[]).map(function(t){return e._d(t)})},qp.prototype.dd=function(t){switch(this.ud){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return po(n)?t(n):n}(t);return null==e?null:this._d(e);case"estimate":return this.fd(yo(t));default:return null}},qp.prototype.fd=function(t){var e=_o(t),n=new Kr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},qp.prototype.wd=function(t){var e=$r.$(t);Dr(is(e));var n=new jr(e.get(1),e.get(3)),r=new ei(e.g(5));return n.isEqual(this.s)||Ar("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.ld(r)},qp),Vp=ec._h,Up=(Fp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Fp),jp=(Object.defineProperty(Mp.prototype,"vd",{get:function(){return this.Sd||(this.Sd=new xf(this.ya,this.bd.ignoreUndefinedProperties)),this.Sd},enumerable:!1,configurable:!0}),Mp.prototype.settings=function(t){wc("Firestore.settings",arguments,1),Ec("Firestore.settings","object",1,t);var e=new Up(t);if(this.Pd&&!this.bd.isEqual(e))throw new Xr(Yr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.bd=e).credentials&&(this.yd=function(t){if(!t)return new Xf;switch(t.type){case"gapi":var e=t.Dd;return Dr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Jf(e,t.Ya||"0");case"provider":return t.Dd;default:throw new Xr(Yr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Mp.prototype.enableNetwork=function(){return this.Rd(),this.Pd.enableNetwork()},Mp.prototype.disableNetwork=function(){return this.Rd(),this.Pd.disableNetwork()},Mp.prototype.enablePersistence=function(t){var e,n;if(this.Pd)throw new Xr(Yr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Ar("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Xr(Yr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Cd(this.pd,{Jf:!0,cacheSizeBytes:this.bd.cacheSizeBytes,synchronizeTabs:r,qi:i})},Mp.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var r,e=this;return v(this,function(t){if(void 0!==this.Pd&&!this.Pd.sd)throw new Xr(Yr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return r=new aa,[2,(this.Ad.Lo(function(){return y(e,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.Fd(),[4,this.pd.clearPersistence(e)];case 1:return t.sent(),r.resolve(),[3,3];case 2:return n=t.sent(),r.reject(n),[3,3];case 3:return[2]}})})}),r.promise)]})})},Mp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Mp.prototype,"Nd",{get:function(){return this.Rd(),this.Pd.sd},enumerable:!1,configurable:!0}),Mp.prototype.waitForPendingWrites=function(){return this.Rd(),this.Pd.waitForPendingWrites()},Mp.prototype.onSnapshotsInSync=function(t){if(this.Rd(),Lp(t))return Bp(this.Pd,t);Ec("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return Bp(this.Pd,e)},Mp.prototype.Rd=function(){return this.Pd||this.Cd(new mp,{Jf:!1}),this.Pd},Mp.prototype.Fd=function(){return new Ur(this.ya,this.gd,this.bd.host,this.bd.ssl,this.bd.forceLongPolling)},Mp.prototype.Cd=function(t,e){var n=this.Fd();return this.Pd=new bp(this.yd,this.Ad),this.Pd.start(n,t,e)},Mp.Vd=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Xr(Yr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Xr(Yr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new jr(n)},Object.defineProperty(Mp.prototype,"app",{get:function(){if(!this.md)throw new Xr(Yr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),Mp.prototype.collection=function(t){return wc("Firestore.collection",arguments,1),Ec("Firestore.collection","non-empty string",1,t),this.Rd(),new ld($r.$(t),this,null)},Mp.prototype.doc=function(t){return wc("Firestore.doc",arguments,1),Ec("Firestore.doc","non-empty string",1,t),this.Rd(),Wp.$d($r.$(t),this,null)},Mp.prototype.collectionGroup=function(t){if(wc("Firestore.collectionGroup",arguments,1),Ec("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Xr(Yr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Rd(),new sd(new fu($r.k(),t),this,null)},Mp.prototype.runTransaction=function(e){var n=this;return wc("Firestore.runTransaction",arguments,1),Ec("Firestore.runTransaction","function",1,e),this.Rd().transaction(function(t){return e(new zp(n,t))})},Mp.prototype.batch=function(){return this.Rd(),new Hp(this)},Object.defineProperty(Mp,"logLevel",{get:function(){switch(Tr()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Mp.setLogLevel=function(t){wc("Firestore.setLogLevel",arguments,1),xc("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),_r.setLogLevel(t)},Mp.prototype.kd=function(){return this.bd.timestampsInSnapshots},Mp);function Mp(t,e,n){var r=this;if(void 0===n&&(n=new mp),this.md=null,this.Ad=new Xh,this.INTERNAL={delete:function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Rd(),[4,this.Pd.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var i=t;this.md=i,this.ya=Mp.Vd(i),this.gd=i.name,this.yd=new Kf(e)}else{var o=t;if(!o.projectId)throw new Xr(Yr.INVALID_ARGUMENT,"Must provide projectId");this.ya=new jr(o.projectId,o.database),this.gd="[DEFAULT]",this.yd=new Xf}this.pd=n,this.bd=new Up({})}function Fp(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Xr(Yr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Tc("settings","non-empty string","host",t.host),this.host=t.host,Nc("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Oc("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Nc("settings","object","credentials",t.credentials),this.credentials=t.credentials,Nc("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Nc("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Ar("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Ar("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Nc("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=ec.dh;else{if(t.cacheSizeBytes!==Vp&&t.cacheSizeBytes<ec.fh)throw new Xr(Yr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+ec.fh);this.cacheSizeBytes=t.cacheSizeBytes}Nc("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function qp(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.ud=n,this.ld=r}function Bp(t,e){var n=new Ip({next:function(){e.next&&e.next()},error:function(t){throw Sr()}});return t.Q_(n),function(){n.ad(),t.W_(n)}}var Gp,zp=(Kp.prototype.get=function(t){var n=this;wc("Transaction.get",arguments,1);var r=md("Transaction.get",t,this.xd);return this.Md.Mu([r.pa]).then(function(t){if(!t||1!==t.length)return Sr();var e=t[0];if(e instanceof hu)return new Zp(n.xd,r.pa,null,!1,!1,r.ba);if(e instanceof au)return new Zp(n.xd,r.pa,e,!1,!1,r.ba);throw Sr()})},Kp.prototype.set=function(t,e,n){Ic("Transaction.set",arguments,2,3);var r=md("Transaction.set",t,this.xd);n=yd("Transaction.set",n);var i=wd(r.ba,e,n),o=Pf(this.xd.vd,"Transaction.set",r.pa,i,null!==r.ba,n);return this.Md.set(r.pa,o),this},Kp.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Gc?(bc("Transaction.update",arguments,3),r=md("Transaction.update",t,this.xd),Of(this.xd.vd,"Transaction.update",r.pa,e,n,o)):(wc("Transaction.update",arguments,2),r=md("Transaction.update",t,this.xd),Rf(this.xd.vd,"Transaction.update",r.pa,e)),this.Md.update(r.pa,i),this},Kp.prototype.delete=function(t){wc("Transaction.delete",arguments,1);var e=md("Transaction.delete",t,this.xd);return this.Md.delete(e.pa),this},Kp),Hp=(Xp.prototype.set=function(t,e,n){Ic("WriteBatch.set",arguments,2,3),this.Bd();var r=md("WriteBatch.set",t,this.xd);n=yd("WriteBatch.set",n);var i=wd(r.ba,e,n),o=Pf(this.xd.vd,"WriteBatch.set",r.pa,i,null!==r.ba,n);return this.Od=this.Od.concat(o.va(r.pa,xs.Qe())),this},Xp.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Bd(),i="string"==typeof e||e instanceof Gc?(bc("WriteBatch.update",arguments,3),r=md("WriteBatch.update",t,this.xd),Of(this.xd.vd,"WriteBatch.update",r.pa,e,n,o)):(wc("WriteBatch.update",arguments,2),r=md("WriteBatch.update",t,this.xd),Rf(this.xd.vd,"WriteBatch.update",r.pa,e)),this.Od=this.Od.concat(i.va(r.pa,xs.exists(!0))),this},Xp.prototype.delete=function(t){wc("WriteBatch.delete",arguments,1),this.Bd();var e=md("WriteBatch.delete",t,this.xd);return this.Od=this.Od.concat(new Ks(e.pa,xs.Qe())),this},Xp.prototype.commit=function(){return this.Bd(),this.Ld=!0,0<this.Od.length?this.xd.Rd().write(this.Od):Promise.resolve()},Xp.prototype.Bd=function(){if(this.Ld)throw new Xr(Yr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Xp),Wp=(n(Yp,Gp=bf),Yp.$d=function(t,e,n){if(t.length%2!=0)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.N()+" has "+t.length);return new Yp(new ei(t),e,n)},Object.defineProperty(Yp.prototype,"id",{get:function(){return this.pa.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Yp.prototype,"parent",{get:function(){return new ld(this.pa.path.p(),this.firestore,this.ba)},enumerable:!1,configurable:!0}),Object.defineProperty(Yp.prototype,"path",{get:function(){return this.pa.path.N()},enumerable:!1,configurable:!0}),Yp.prototype.collection=function(t){if(wc("DocumentReference.collection",arguments,1),Ec("DocumentReference.collection","non-empty string",1,t),!t)throw new Xr(Yr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=$r.$(t);return new ld(this.pa.path.child(e),this.firestore,null)},Yp.prototype.isEqual=function(t){if(!(t instanceof Yp))throw kc("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.pa.isEqual(t.pa)&&this.ba===t.ba},Yp.prototype.set=function(t,e){Ic("DocumentReference.set",arguments,1,2),e=yd("DocumentReference.set",e);var n=wd(this.ba,t,e),r=Pf(this.firestore.vd,"DocumentReference.set",this.pa,n,null!==this.ba,e);return this.Pd.write(r.va(this.pa,xs.Qe()))},Yp.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Gc?(bc("DocumentReference.update",arguments,2),Of(this.firestore.vd,"DocumentReference.update",this.pa,t,e,r)):(wc("DocumentReference.update",arguments,1),Rf(this.firestore.vd,"DocumentReference.update",this.pa,t)),this.Pd.write(n.va(this.pa,xs.exists(!0)))},Yp.prototype.delete=function(){return wc("DocumentReference.delete",arguments,0),this.Pd.write([new Ks(this.pa,xs.Qe())])},Yp.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Ic("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Lp(i[u])||(Oc("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),Nc("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a={includeMetadataChanges:s.includeMetadataChanges};if(Lp(i[u])){var h=i[u];i[u]=null===(t=h.next)||void 0===t?void 0:t.bind(h),i[u+1]=null===(e=h.error)||void 0===e?void 0:e.bind(h),i[u+2]=null===(n=h.complete)||void 0===n?void 0:n.bind(h)}else Ec("DocumentReference.onSnapshot","function",u,i[u]),_c("DocumentReference.onSnapshot","function",u+1,i[u+1]),_c("DocumentReference.onSnapshot","function",u+2,i[u+2]);var c={next:function(t){i[u]&&i[u](r.qd(t))},error:i[u+1],complete:i[u+2]};return Qp(this.Pd,this.pa,a,c)},Yp.prototype.get=function(t){var e,n,r,i,o,s=this;return Ic("DocumentReference.get",arguments,0,1),gd("DocumentReference.get",t),t&&"cache"===t.source?this.firestore.Rd().rd(this.pa).then(function(t){return new Zp(s.firestore,s.pa,t,!0,t instanceof au&&t.Ge,s.ba)}):(e=this.Pd,n=this.pa,r=t,i=new aa,o=Qp(e,n,{includeMetadataChanges:!0,J_:!0},{next:function(t){o();var e=t.docs.has(n);!e&&t.fromCache?i.reject(new Xr(Yr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?i.reject(new Xr(Yr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),i.promise.then(function(t){return s.qd(t)}))},Yp.prototype.withConverter=function(t){return new Yp(this.pa,this.firestore,t)},Yp.prototype.qd=function(t){var e=t.docs.get(this.pa);return new Zp(this.firestore,this.pa,e,t.fromCache,t.hasPendingWrites,this.ba)},Yp);function Yp(t,e,n){var r=this;return(r=Gp.call(this,e.ya,t,n)||this).pa=t,r.firestore=e,r.ba=n,r.Pd=r.firestore.Rd(),r}function Xp(t){this.xd=t,this.Od=[],this.Ld=!1}function Kp(t,e){this.xd=t,this.Md=e}function Qp(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new Ip({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(fu.hn(e.path),o,n);return function(){o.ad(),t.Rc(s)}}var Jp,$p=(rd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},rd),Zp=(nd.prototype.data=function(t){var e=this;if(Ic("DocumentSnapshot.data",arguments,0,1),t=vd("DocumentSnapshot.data",t),this.Ud){if(this.ba){var n=new td(this.xd,this.pa,this.Ud,this.Qd,this.Wd,null);return this.ba.fromFirestore(n,t)}return new Cp(this.xd.ya,this.xd.kd(),t.serverTimestamps||"none",function(t){return new Wp(t,e.xd,null)})._d(this.Ud.tn())}},nd.prototype.get=function(t,e){var n=this;if(Ic("DocumentSnapshot.get",arguments,1,2),e=vd("DocumentSnapshot.get",e),this.Ud){var r=this.Ud.data().field(jf("DocumentSnapshot.get",t,this.pa));if(null!==r)return new Cp(this.xd.ya,this.xd.kd(),e.serverTimestamps||"none",function(t){return new Wp(t,n.xd,n.ba)})._d(r)}},Object.defineProperty(nd.prototype,"id",{get:function(){return this.pa.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"ref",{get:function(){return new Wp(this.pa,this.xd,this.ba)},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"exists",{get:function(){return null!==this.Ud},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"metadata",{get:function(){return new $p(this.Wd,this.Qd)},enumerable:!1,configurable:!0}),nd.prototype.isEqual=function(t){if(!(t instanceof nd))throw kc("isEqual","DocumentSnapshot",1,t);return this.xd===t.xd&&this.Qd===t.Qd&&this.pa.isEqual(t.pa)&&(null===this.Ud?null===t.Ud:this.Ud.isEqual(t.Ud))&&this.ba===t.ba},nd),td=(n(ed,Jp=Zp),ed.prototype.data=function(t){return Jp.prototype.data.call(this,t)},ed);function ed(){return null!==Jp&&Jp.apply(this,arguments)||this}function nd(t,e,n,r,i,o){this.xd=t,this.pa=e,this.Ud=n,this.Qd=r,this.Wd=i,this.ba=o}function rd(t,e){this.hasPendingWrites=t,this.fromCache=e}function id(t){if(t.mn()&&0===t.en.length)throw new Xr(Yr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var od,sd=(ad.prototype.Kd=function(t,e,n){var r;if(t.O()){if("array-contains"===e||"array-contains-any"===e)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+e+"' queries on FieldPath.documentId().");if("in"===e){this.Gd(n,e);for(var i=[],o=0,s=n;o<s.length;o++){var u=s[o];i.push(this.zd(u))}r={arrayValue:{values:i}}}else r=this.zd(n)}else"in"!==e&&"array-contains-any"!==e||this.Gd(n,e),r=kf(this.vd,"Query.where",n,"in"===e);var a=Eu.create(t,e,r);return this.Hd(a),a},ad.prototype.Yd=function(t,e){if(null!==this.jd.startAt)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.jd.endAt)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var n=new Gu(t,e);return this.Jd(n),n},ad.prototype.Xd=function(t,e,n){if(!e)throw new Xr(Yr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");for(var r=[],i=0,o=this.jd.orderBy;i<o.length;i++){var s=o[i];if(s.field.O())r.push(Ao(this.ya,e.key));else{var u=e.field(s.field);if(po(u))throw new Xr(Yr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var a=s.field.N();throw new Xr(Yr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+a+"' (used as the orderBy) does not exist.")}r.push(u)}}return new Lu(r,n)},ad.prototype.Zd=function(t,e,n){var r=this.jd.en;if(e.length>r.length)throw new Xr(Yr.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var s=e[o];if(r[o].field.O()){if("string"!=typeof s)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.jd.Vn()&&-1!==s.indexOf("/"))throw new Xr(Yr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.jd.path.child($r.$(s));if(!ei.W(u))throw new Xr(Yr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new ei(u);i.push(Ao(this.ya,a))}else{var h=kf(this.vd,t,s);i.push(h)}}return new Lu(i,n)},ad.prototype.zd=function(t){if("string"==typeof t){if(""===t)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.jd.Vn()&&-1!==t.indexOf("/"))throw new Xr(Yr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.jd.path.child($r.$(t));if(!ei.W(e))throw new Xr(Yr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Ao(this.ya,new ei(e))}if(t instanceof bf)return Ao(this.ya,t.pa);throw new Xr(Yr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Pc(t)+".")},ad.prototype.Gd=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Xr(Yr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},ad.prototype.Hd=function(t){if(t instanceof Eu){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],r=0<=e.indexOf(t.op),i=0<=n.indexOf(t.op);if(t.An()){var o=this.jd.an();if(null!==o&&!o.isEqual(t.field))throw new Xr(Yr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.jd.un();null!==s&&this.tw(t.field,s)}else if(i||r){var u=null;if(i&&(u=this.jd.Rn(n)),null===u&&r&&(u=this.jd.Rn(e)),null!==u)throw u===t.op?new Xr(Yr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Xr(Yr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},ad.prototype.Jd=function(t){if(null===this.jd.un()){var e=this.jd.an();null!==e&&this.tw(e,t.field)}},ad.prototype.tw=function(t,e){if(!e.isEqual(t))throw new Xr(Yr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},n(ud,od=ad),ud.prototype.where=function(t,e,n){wc("Query.where",arguments,3),Rc("Query.where",3,n);var r=xc("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),i=jf("Query.where",t),o=this.Kd(i,r,n);return new ud(this.jd.cn(o),this.firestore,this.ba)},ud.prototype.orderBy=function(t,e){var n;if(Ic("Query.orderBy",arguments,1,2),_c("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Xr(Yr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r=jf("Query.orderBy",t),i=this.Yd(r,n);return new ud(this.jd.ln(i),this.firestore,this.ba)},ud.prototype.limit=function(t){return wc("Query.limit",arguments,1),Ec("Query.limit","number",1,t),Lc("Query.limit",1,t),new ud(this.jd._n(t),this.firestore,this.ba)},ud.prototype.limitToLast=function(t){return wc("Query.limitToLast",arguments,1),Ec("Query.limitToLast","number",1,t),Lc("Query.limitToLast",1,t),new ud(this.jd.fn(t),this.firestore,this.ba)},ud.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];bc("Query.startAt",arguments,1);var r=this.ew("Query.startAt",t,e,!0);return new ud(this.jd.dn(r),this.firestore,this.ba)},ud.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];bc("Query.startAfter",arguments,1);var r=this.ew("Query.startAfter",t,e,!1);return new ud(this.jd.dn(r),this.firestore,this.ba)},ud.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];bc("Query.endBefore",arguments,1);var r=this.ew("Query.endBefore",t,e,!0);return new ud(this.jd.wn(r),this.firestore,this.ba)},ud.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];bc("Query.endAt",arguments,1);var r=this.ew("Query.endAt",t,e,!1);return new ud(this.jd.wn(r),this.firestore,this.ba)},ud.prototype.isEqual=function(t){if(!(t instanceof ud))throw kc("isEqual","Query",1,t);return this.firestore===t.firestore&&vu(this.jd,t.jd)&&this.ba===t.ba},ud.prototype.withConverter=function(t){return new ud(this.jd,this.firestore,t)},ud.prototype.ew=function(t,e,n,r){if(Rc(t,1,e),e instanceof Zp)return wc(t,d([e],n),1),this.Xd(t,e.Ud,r);var i=[e].concat(n);return this.Zd(t,i,r)},ud.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Ic("Query.onSnapshot",arguments,1,4);var s={},u=0;if("object"!=typeof i[u]||Lp(i[u])||(Oc("Query.onSnapshot",s=i[u],["includeMetadataChanges"]),Nc("Query.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++),Lp(i[u])){var a=i[u];i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)}else Ec("Query.onSnapshot","function",u,i[u]),_c("Query.onSnapshot","function",u+1,i[u+1]),_c("Query.onSnapshot","function",u+2,i[u+2]);var h={next:function(t){i[u]&&i[u](new fd(r.firestore,r.jd,t,r.ba))},error:i[u+1],complete:i[u+2]};return id(this.jd),hd(this.firestore.Rd(),this.jd,s,h)},ud.prototype.get=function(t){var e=this;Ic("Query.get",arguments,0,1),gd("Query.get",t),id(this.jd);var n,r,i,o,s,u=this.firestore.Rd();return(t&&"cache"===t.source?u.od(this.jd):(n=u,r=this.jd,i=t,o=new aa,s=hd(n,r,{includeMetadataChanges:!0,J_:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new Xr(Yr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)).then(function(t){return new fd(e.firestore,e.jd,t,e.ba)})},ud);function ud(t,e,n){var r=this;return(r=od.call(this,e.ya,e.vd,t)||this).jd=t,r.firestore=e,r.ba=n,r}function ad(t,e,n){this.ya=t,this.vd=e,this.jd=n}function hd(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new Ip({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(e,o,n);return function(){o.ad(),t.Rc(s)}}var cd,fd=(Object.defineProperty(dd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"empty",{get:function(){return this.sw.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"size",{get:function(){return this.sw.docs.size},enumerable:!1,configurable:!0}),dd.prototype.forEach=function(e,n){var r=this;Ic("QuerySnapshot.forEach",arguments,1,2),Ec("QuerySnapshot.forEach","function",1,e),this.sw.docs.forEach(function(t){e.call(n,r.ow(t,r.metadata.fromCache,r.sw.Lt.has(t.key)))})},Object.defineProperty(dd.prototype,"query",{get:function(){return new sd(this.nw,this.xd,this.ba)},enumerable:!1,configurable:!0}),dd.prototype.docChanges=function(t){t&&(Oc("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Nc("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.sw.qt)throw new Xr(Yr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.iw&&this.rw===e||(this.iw=function(i,e,o){if(i.Ot._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ot;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Sr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.sw,e,this.ow.bind(this)),this.rw=e),this.iw},dd.prototype.isEqual=function(t){if(!(t instanceof dd))throw kc("isEqual","QuerySnapshot",1,t);return this.xd===t.xd&&vu(this.nw,t.nw)&&this.sw.isEqual(t.sw)&&this.ba===t.ba},dd.prototype.ow=function(t,e,n){return new td(this.xd,t.key,t,e,n,this.ba)},dd),ld=(n(pd,cd=sd),Object.defineProperty(pd.prototype,"id",{get:function(){return this.jd.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"parent",{get:function(){var t=this.jd.path.p();return t._()?null:new Wp(new ei(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"path",{get:function(){return this.jd.path.N()},enumerable:!1,configurable:!0}),pd.prototype.doc=function(t){Ic("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Or.t()),Ec("CollectionReference.doc","non-empty string",1,t);var e=$r.$(t);return Wp.$d(this.jd.path.child(e),this.firestore,this.ba)},pd.prototype.add=function(t){wc("CollectionReference.add",arguments,1),Ec("CollectionReference.add","object",1,this.ba?this.ba.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},pd.prototype.withConverter=function(t){return new pd(this.hw,this.firestore,t)},pd);function pd(t,e,n){var r=this;if(((r=cd.call(this,fu.hn(t),e,n)||this).hw=t).length%2!=1)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.N()+" has "+t.length);return r}function dd(t,e,n,r){this.xd=t,this.nw=e,this.sw=n,this.ba=r,this.iw=null,this.rw=null,this.metadata=new $p(n.hasPendingWrites,n.fromCache)}function yd(t,e){if(void 0===e)return{merge:!1};if(Oc(t,e,["merge","mergeFields"]),Nc(t,"boolean","merge",e.merge),n=t,void 0!==(r=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new Xr(Yr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Pc(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new Xr(Yr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Pc(n[i]))}(n,"mergeFields",r,function(t){return"string"==typeof t||t instanceof Gc}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n,r;return e}function vd(t,e){return void 0===e?{}:(Oc(t,e,["serverTimestamps"]),Ac(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function gd(t,e){_c(t,"object",1,e),e&&(Oc(t,e,["source"]),Ac(t,0,"source",e.source,["default","server","cache"]))}function md(t,e,n){if(e instanceof bf){if(e.firestore!==n)throw new Xr(Yr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw kc(t,"DocumentReference",1,e)}function wd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var bd,Id={Firestore:jp,GeoPoint:cf,Timestamp:Kr,Blob:qc,Transaction:zp,WriteBatch:Hp,DocumentReference:Wp,DocumentSnapshot:Zp,Query:sd,QueryDocumentSnapshot:td,QuerySnapshot:fd,CollectionReference:ld,FieldPath:Gc,FieldValue:af,setLogLevel:jp.setLogLevel,CACHE_SIZE_UNLIMITED:Vp};(bd=Ed).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new jp(e,n,new wp);var e,n},"PUBLIC").setServiceProps(Object.assign({},Id))),bd.registerVersion("@firebase/firestore","1.16.0")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
